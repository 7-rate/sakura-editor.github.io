<!DOCTYPE html><html><head><meta charset='utf-8'><title>Wiki</title><link rel='stylesheet' href='../bbs.css' /><script src='../bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←Webトップへ</a><li><div class="list-title">
    <span class="no">291</span>
    <a class="title" href="291.html#291">Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">292</span>
    <a class="title" href="291.html#292">RE: Wiki</a></div>
    </li><li><div class="list-title">
    <span class="no">293</span>
    <a class="title" href="291.html#293">RE: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">294</span>
    <a class="title" href="291.html#294">RE2: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">295</span>
    <a class="title" href="291.html#295">RE3: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">296</span>
    <a class="title" href="291.html#296">RE4: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">297</span>
    <a class="title" href="291.html#297">RE5: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">298</span>
    <a class="title" href="291.html#298">RE6: Wiki</a></div>
    <ul><li><div class="list-title">
    <span class="no">299</span>
    <a class="title" href="291.html#299">RE7: Wiki</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=291>
    <span class="no">[291]</span>
    <a class="title" href="#291">Wiki</a>
    <span class="author">AC</span>
    <time datetime="2007-06-01T23:16:49">2007年06月01日 23:16</time></h1>
    <div class="body">Wiki仮説掲示板が文字化けしてるのは私だけ～？<br><br>・これ，きっと相当な作業量ですね．乙です．＞dskobaさん -- maru 2007-04-06 (金) 22:54:06<br><br>の次の行から<br><br>&lt;A href=http://fbkyfqydx.smtp.ru/197.html&gt;閠韲譛 粮褥跂迺/A&gt;<br><br>みたくなってますorz<br></div></section>
    <ul><li><section><h1 id=292>
    <span class="no">[292]</span>
    <a class="title" href="#292">RE: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-01T23:36:39">2007年06月01日 23:36</time></h1>
    <div class="body">&gt;Wiki仮説掲示板が文字化けしてるのは私だけ～？<br>それ、文字化けじゃなくてスパムですね（涙）<br>時間のあるときに対策します。<br></div></section>
    </li><li><section><h1 id=293>
    <span class="no">[293]</span>
    <a class="title" href="#293">RE: Wiki</a>
    <span class="author">げんた</span>
    <time datetime="2007-06-02T02:01:20">2007年06月02日 02:01</time></h1>
    <div class="body">&gt;の次の行から<br>&gt;<br>&gt;&lt;A href=http://fbkyfqydx.smtp.ru/197.html&gt;閠韲譛 粮褥跂迺/A&gt;<br>&gt;<br>&gt;みたくなってますorz<br>spamを見たら，消しておいてください．誰でも編集できますので．<br><br>しかし，何故相変わらずNGワード対策しないのか不思議なのですが...<br>最近のspamは間違いなく[url=]  [/url] で囲まれたリンク(XOOPS用)が入っているので，単純にこれが入っていたら投稿を拒否するだけで相当効果があると思いますけど．<br></div></section>
    <ul><li><section><h1 id=294>
    <span class="no">[294]</span>
    <a class="title" href="#294">RE2: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-02T12:37:02">2007年06月02日 12:37</time></h1>
    <div class="body">&gt;しかし，何故相変わらずNGワード対策しないのか不思議なのですが... <br>&gt;最近のspamは間違いなく[url=]  [/url] で囲まれたリンク(XOOPS用)が入っているので，単純にこれが入っていたら投稿を拒否するだけで相当効果があると思いますけど．<br><br>そんな単純じゃないです(^^;;<br>彼はとても対応が早くて、単純なブロックは数時間で回避してきます(涙)<br>「必ずまた来ます、がんばってね」みたいなメッセージで挑発してきて、正直付き合いきれません…。<br><br>これまでの攻防の歴史を説明すると<br>【攻】[url=][/url]の書き込みが頻発<br>【守】commentやtrackerにＮＧワードブロックを設置<br>【攻】editで書き込んできた<br>【守】editにもＮＧワード<br>【攻】[url=]を使わず書き込んできた<br>【守】ＮＧワード追加<br>【攻】いろいろな表現で書き込んできた<br>【守】いよいよ一般の書き込みと区別できなくなったので、refererとagentをチェックするようにした<br>【攻】refererもagentもいろいろ使って書き込んできた<br>【守】書き込み頻度とプロクシ兆候をチェックしながら拒否ＩＰのブラックリストを生成。edit/comment/article/trackerのspam対策モジュールをひとつに統合共有化。<br>　～各種攻防と調整の繰り返し。一般の書き込みにも支障が出たり。～<br>【守】日本語文字を含むときはブロック判定を緩和<br>【攻】一気に１０ｋバイトをＰＯＳＴすることで、preg_match関数をオーバーフローさせ、ＮＧワードと日本語判定を無効化させる攻撃<br>【守】ＰＯＳＴサイズを８ｋバイトに制限<br>【攻】日本語を含めて書き込みしてきた<br></div></section>
    <ul><li><section><h1 id=295>
    <span class="no">[295]</span>
    <a class="title" href="#295">RE3: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-02T17:12:59">2007年06月02日 17:12</time></h1>
    <div class="body">日本語判定だったものををひらがな判定に変えました。<br>ひらがなを含まないメッセージは、かなりブロックされやすくなってしまうので、ご承知置き願います。<br><br>書き込み頻度判定のインターバルを少し長くしたので、すばやく連続で書き込み系プラグインが呼ばれる操作を行うと、あっさり無視されます。<br>そのかわり書き込み頻度のＮＧについてはブラックリストに登録しないようにしたので、今までよりお手軽になりました。<br>副作用として、彼の対策サイクルも高速化してしまいますが…。<br><br>障害報告などあれば、こちらにお願いいたします。<br></div></section>
    <ul><li><section><h1 id=296>
    <span class="no">[296]</span>
    <a class="title" href="#296">RE4: Wiki</a>
    <span class="author">げんた</span>
    <time datetime="2007-06-02T21:29:28">2007年06月02日 21:29</time></h1>
    <div class="body">&gt;日本語判定だったものををひらがな判定に変えました。<br>ちなみに判定は新規追加部分のみ(って可能なの？)に対して行っているのでしょうか．<br>Trackerとか元々日本語が入っていますし，他のページ(または同一ページ)からのコピペ＋link攻撃をされたら防ぐのはかなり難しいのかなと．かといって，差分だけチェックされると書き間違いをちょっと直した場合とかに困りますし．<br><br>chaptchaは最後の手段かもしれませんが...メッセージを残すなど人間が対応すると最終的には無理ですしね．結局悪意のある人間の書き込みは防げないわけで．リンクにはnofollowが入っているので検索エンジン的には評価されないわけで，それでも書き込んでくるのは単なる愉快犯でしょうか．<br><br>---<br>ところで判定に引っかかるとどうなるんでしょう？ツールで大量自動書き込みする人にとっては，書き込みを拒絶したことに気付かれなければ執拗に追ってきたりしないと思うのですが．<br>一旦書き込めたように見えて，3分後に元に戻っているとか．(難しそう...cronが動けばできるかなぁ)<br></div></section>
    <ul><li><section><h1 id=297>
    <span class="no">[297]</span>
    <a class="title" href="#297">RE5: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-03T00:44:31">2007年06月03日 00:44</time></h1>
    <div class="body">&gt;&gt;日本語判定だったものををひらがな判定に変えました。<br>&gt;ちなみに判定は新規追加部分のみ(って可能なの？)に対して行っているのでしょうか．<br>それぞれのプラグインからPostされた値のうち、メッセージ本体と思われる部分に対してチェックしています。投稿者とかサマリとかは無視しています。<br>Editプラグインで既存のページを編集する場合とかは無防備になります。<br><br>&gt;他のページ(または同一ページ)からのコピペ＋link攻撃をされたら防ぐのはかなり難しいのかなと．<br>これも、そのうち来るのかなと思っています。<br><br>&gt;それでも書き込んでくるのは単なる愉快犯でしょうか．<br>必ずしもリンクを貼ることが目的ではないようで、愉快犯だろうと思います。<br><br>&gt;ところで判定に引っかかるとどうなるんでしょう？<br>元ページにリダイレクトされる、いつものあの状態です。<br><br>&gt;一旦書き込めたように見えて，3分後に元に戻っているとか．(難しそう...cronが動けばできるかなぁ)<br>それ、すごく効果ありそう。対象の書き込みだけをバックステージするのはどうやったらいいのだろう。<br><br>国内IP範囲かどうかチェックして、.htaccessとかでダミーの入り口へ誘導できないかなぁ。<br></div></section>
    <ul><li><section><h1 id=298>
    <span class="no">[298]</span>
    <a class="title" href="#298">RE6: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-03T03:28:08">2007年06月03日 03:28</time></h1>
    <div class="body">予告なしの突然ですいません。<br>書込み禁止しているのがバレバレの方法ですが.htaccessによる制限をテストさせてください。<br>国内IP範囲で制限して、範囲外からのアクセスなら書き込み禁止モードのindexページを表示します。<br>ただしパフォーマンスを考慮して、IP範囲は最上位の8bitしか見ていません。<br><br>IP範囲はhttp://ftp.apnic.net/stats/apnic/の割り当てリストから取得しましたので、APNICの管轄外なアドレスは誤爆してしまいます。<br>これもIPアドレスを偽ってアクセスして来れば、無駄な抵抗ですが…。<br></div></section>
    <ul><li><section><h1 id=299>
    <span class="no">[299]</span>
    <a class="title" href="#299">RE7: Wiki</a>
    <span class="author">maru</span>
    <time datetime="2007-06-03T17:49:03">2007年06月03日 17:49</time></h1>
    <div class="body">APNICが管理している国内IP範囲以外からのアクセスすると、書き込みの際にBasic認証ダイアログが表示されます。<br>期待通りの動作をすれば、国内からのアクセスでは認証ダイアログは表示されません。(つまり、従来どおり)<br>海外からのアクセスでは、会員制サイトに見せかけて、攻撃意欲をつぶすのが目的です。<br><br>具体的には<br>国内IP：index2.phpが表示され、従来の動作をします。<br>海外IP：index.phpが表示され、書き込みにはBasic認証が必要です。<br>よって、http://sakura.qp.land.to/index.phpのフルパスでアクセスすると、国内からでも認証モードになります。<br>もしブックマークなどでフルパスのものがあればhttp://sakura.qp.land.to/に変更が必要になります。<br><br>国内IPの判定はあまり厳密でなく、上位8bitだけしか見ていないので、ある程度はすり抜けてきます。<br>また、APNIC管轄外のアドレスは誤爆してしまいますが、認証部分以外は機能的な違いはありませんので、緊急避難的にBasic認証のユーザー／パスワードを公開することにします。<br>ユーザー名は、いぬ「i**」、パスワードは鳴き声「w**」です。<br><br>なお先回説明した、ひらがな判定その他の機能は、そのまま続投します。<br><br>ご意見ご指摘・障害報告など、ご協力お願いします。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>