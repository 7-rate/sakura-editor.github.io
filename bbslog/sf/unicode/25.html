<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="/favicon.ico">
  <title>インクルードガード | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀Unicode版開発トップへ</a>
        <li><div class="list-title">
    <span class="no">25</span>
    <a class="thread-title" href="25.html#25">インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">35</span>
    <a class="thread-title" href="25.html#35">Re:インクルードガード</a></div>
    </li><li><div class="list-title">
    <span class="no">36</span>
    <a class="thread-title" href="25.html#36">Re:インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">43</span>
    <a class="thread-title" href="25.html#43">Re2:インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">44</span>
    <a class="thread-title" href="25.html#44">Re3:インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">45</span>
    <a class="thread-title" href="25.html#45">Re4:インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">50</span>
    <a class="thread-title" href="25.html#50">Re5:インクルードガード</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">52</span>
    <a class="thread-title" href="25.html#52">Re4:インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">55</span>
    <a class="thread-title" href="25.html#55">Re5:インクルードガード</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">46</span>
    <a class="thread-title" href="25.html#46">Re3:インクルードガード</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">54</span>
    <a class="thread-title" href="25.html#54">Re2:インクルードガード</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">48</span>
    <a class="thread-title" href="25.html#48">とりあえず安定(trunk統合)するまでの方針</a></div>
    <ul><li><div class="list-title">
    <span class="no">49</span>
    <a class="thread-title" href="25.html#49">RE: とりあえず安定(trunk統合)するまでの方針</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">69</span>
    <a class="thread-title" href="25.html#69">RE: インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">72</span>
    <a class="thread-title" href="25.html#72">Re2: インクルードガード</a></div>
    <ul><li><div class="list-title">
    <span class="no">73</span>
    <a class="thread-title" href="25.html#73">Re3: インクルードガード</a></div>
    </li><li><div class="list-title">
    <span class="no">74</span>
    <a class="thread-title" href="25.html#74">Re3: インクルードガード</a></div>
    </li><li><div class="list-title">
    <span class="no">75</span>
    <a class="thread-title" href="25.html#75">ファイル終端の/*[EOF]*/</a></div>
    </li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=25>
    <span class="no">[25]</span>
    <a class="thread-title" href="#25">インクルードガード</a>
    <span class="author">dskoba</span>
    <time datetime="2007-11-17T22:12:27">2007年11月17日 22:12</time></h1>
    <div class="body">#pragma once はどうしますか。<br>今までは StdAfx.h にしか無かったと思いますが，Unicode版には数多くのファイルで使われています。<br><br>#ifndef の方のシンボル名が "_" で始まるのは，これはこれで良くないようですが。<br></div></section>
    <ul><li><section><h1 id=35>
    <span class="no">[35]</span>
    <a class="thread-title" href="#35">Re:インクルードガード</a>
    <span class="author">ラスティブ</span>
    <time datetime="2007-11-18T15:18:19">2007年11月18日 15:18</time></h1>
    <div class="body">▼ dskobaさん<br>&gt; #pragma once はどうしますか。<br>打つ手間で比べるなら #pragma once のほうが。</div></section>
    </li><li><section><h1 id=36>
    <span class="no">[36]</span>
    <a class="thread-title" href="#36">Re:インクルードガード</a>
    <span class="author">kobake</span>
    <time datetime="2007-11-18T17:07:47">2007年11月18日 17:07</time></h1>
    <div class="body">以下の理由により、自分も #pragma once を推します。<br><br>・打つ手間が楽<br>・意味が明白<br>・ミスが起こらない (#ifndefと#defineの間の定数名スペルミス、#endif抜け、等)<br>・ネーム空間を圧迫しない<br><br>＃互換性は気にせず「あるものは使う」という富豪スタイルです。<br>　必要に迫られれば逆にプリプロセッサ側を自作します。</div></section>
    <ul><li><section><h1 id=43>
    <span class="no">[43]</span>
    <a class="thread-title" href="#43">Re2:インクルードガード</a>
    <span class="author">もか</span>
    <time datetime="2007-11-19T17:59:53">2007年11月19日 17:59</time></h1>
    <div class="body">BCCで使えないようですが、BCCも捨てでしょうか。<br></div></section>
    <ul><li><section><h1 id=44>
    <span class="no">[44]</span>
    <a class="thread-title" href="#44">Re3:インクルードガード</a>
    <span class="author">kobake</span>
    <time datetime="2007-11-19T19:34:18">2007年11月19日 19:34</time></h1>
    <div class="body">▼ もかさん<br>&gt; BCCで使えないようですが、BCCも捨てでしょうか。<br><br>おっとそんな身近なコンパイラも #pragma once 非対応なんですねぇ。。<br>視野に入れたほうが良いとは思うのですが、「個人的には」BCC捨て派です。<br>フリーで Visual Studio 2005 Express Edition が手に入る時代になりましたし。<br><br>#pragma once の対処くらいなら、何をすれば良いかがハッキリしていて良いですが、<br>それ以外のコンパイラ間の差 (仕様、性能など) を埋めるのに<br>どれだけの手間がかかるのか、自分は知りません。<br>たとえば深めの template などをちゃんと解釈してコンパイルしてくれるか不安です。<br>けっこう template ゴリゴリ使ってるので。(規格に合うようには気をつけているつもりですが)<br><br>＃BCCの実際の性能は知りません。<br>　ちょっと試してみようと思ったんですけど、サーバエラーで入手できずorz</div></section>
    <ul><li><section><h1 id=45>
    <span class="no">[45]</span>
    <a class="thread-title" href="#45">Re4:インクルードガード</a>
    <span class="author">AC</span>
    <time datetime="2007-11-19T21:29:24">2007年11月19日 21:29</time></h1>
    <div class="body">BCCは文字列系の挙動が違う<br>そして、ボーランド派は意外と多い<br></div></section>
    <ul><li><section><h1 id=50>
    <span class="no">[50]</span>
    <a class="thread-title" href="#50">Re5:インクルードガード</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-19T23:28:23">2007年11月19日 23:28</time></h1>
    <div class="body">&gt;BCCは文字列系の挙動が違う<br>私も普段使用していないのですが，かすかな記憶をたどると，localeが"C"でないと文字列関数の挙動が変わるので強制的にlocaleを競ってするコードが入っているはずです．<br></div></section>
    </li></ul></li><li><section><h1 id=52>
    <span class="no">[52]</span>
    <a class="thread-title" href="#52">Re4:インクルードガード</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-19T23:28:53">2007年11月19日 23:28</time></h1>
    <div class="body">&gt;おっとそんな身近なコンパイラも #pragma once 非対応なんですねぇ。。<br>というか，#pragma と書いてある時点で特定コンパイラにしか通用しないと考えるのが自然では？<br><br>かといって，#ifdefでVC2005以降なら#pragma onceとやるのは本末転倒(^^)<br></div></section>
    <ul><li><section><h1 id=55>
    <span class="no">[55]</span>
    <a class="thread-title" href="#55">Re5:インクルードガード</a>
    <span class="author">kobake</span>
    <time datetime="2007-11-20T00:04:07">2007年11月20日 00:04</time></h1>
    <div class="body">▼ げんたさん<br>&gt; &gt;おっとそんな身近なコンパイラも #pragma once 非対応なんですねぇ。。<br>&gt; というか，#pragma と書いてある時点で特定コンパイラにしか通用しないと考えるのが自然では？<br><br>自分が使ったことあるコンパイラ (VisualStudio, CodeWarrior, gcc) では全て使えてたので、<br>割とメジャーな部類の方言、かと思ってました。</div></section>
    </li></ul></li></ul></li><li><section><h1 id=46>
    <span class="no">[46]</span>
    <a class="thread-title" href="#46">Re3:インクルードガード</a>
    <span class="author">ラスティブ＠ボーランド派</span>
    <time datetime="2007-11-19T22:04:08">2007年11月19日 22:04</time></h1>
    <div class="body">インクルードガードを従来の形式に変更するとともに、<br>my_tchar.h my_icmp.h 系を util/string_ex.h に統合する<br>パッチをアップしました。<br><br>PatchUnicode #1834523 「保守パッチ」<br><br>エンバグさせてしまっている可能性が。<br></div></section>
    </li></ul></li><li><section><h1 id=54>
    <span class="no">[54]</span>
    <a class="thread-title" href="#54">Re2:インクルードガード</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-19T23:42:00">2007年11月19日 23:42</time></h1>
    <div class="body">&gt;・意味が明白<br>Visual C専用だから，(Windows以外の開発者も含めて考えれば)かえって意味がわかりにくいと思います．<br>#ifdef-#defineは完全にイディオムと言ってもよいレベルだと思いますし，十分明白だと思いますけど．<br><br>&gt;・ネーム空間を圧迫しない<br>定数はenumかconstを使うべきですし，マクロもインライン関数で用が足りるので，マクロ定数を使うのはかなり限られた部分だけだと思います(と書いて，F_xxxがすべてdefineだったことを思い出したりして)<br>まあ，PrefixかPostfixを決めておけば(つまりコーディングルールを決める)これが問題になることは無いのではないでしょうか．<br><br>&gt;富豪スタイル<br>本当の富豪は，もはやC++なんぞ使っていなかったりして...(^^)<br>JavaScriptでもエディタできちゃう時代ですし..<br><br>---<br>とかいう議論はできた後で．<br></div></section>
    </li></ul></li><li><section><h1 id=48>
    <span class="no">[48]</span>
    <a class="thread-title" href="#48">とりあえず安定(trunk統合)するまでの方針</a>
    <span class="author">kobake</span>
    <time datetime="2007-11-19T22:42:18">2007年11月19日 22:42</time></h1>
    <div class="body">▼ ACさん<br>&gt; BCCは文字列系の挙動が違う<br>&gt; そして、ボーランド派は意外と多い<br><br>なるほど、情報ありがとうございます。<br><br><br>＞皆様<br>UNICODE仕様wikiにBCCの項を作りました。<br>自分はまったく情報を持ってないので中身からっぽです。<br><a href=http://mofmof.nsf.tc/soft/sakura_unicode/index.php?BCC%E5%AF%BE%E5%BF%9C target=_top><nobr>http://<wbr>mofmof.<wbr>nsf.<wbr>tc/<wbr>soft/<wbr>sakura_u<wbr>nicode/<wbr>index.<wbr>php?<wbr>BCC%<wbr>E5%<wbr>AF%<wbr>BE%<wbr>E5%<wbr>BF%<wbr>9C</nobr></a><br>識者のご加筆をお待ちしています。<br><br><br>さきほどの「BCC捨て」は個人的希望ですが、<br>UNICODE化代表者 (になったらしい) 的見解としては、<br>「trunkに統合されるまではVisualStudioのみ対応」で進めることを提案します。<br>目的 (UNICODE版安定) への道のりはできるだけ短くシンプルに抑えたいです。<br><br>trunk統合後のBCC対応はおいといて、<br>とりあえずtrunk統合までの方針として上の案を挙げましたが、<br>それに関してご意見ありますでしょうか。</div></section>
    <ul><li><section><h1 id=49>
    <span class="no">[49]</span>
    <a class="thread-title" href="#49">RE: とりあえず安定(trunk統合)するまでの方針</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-19T23:27:58">2007年11月19日 23:27</time></h1>
    <div class="body">&gt;UNICODE化代表者 (になったらしい) 的見解としては、<br>&gt;「trunkに統合されるまではVisualStudioのみ対応」で進めることを提案します。<br>＃ソース見ないで発言します<br><br>#defineの可変引数が使われていてVS2003でもコンパイル通らない訳なんですが，とりあえずVS 2005のみで進めてもらってもいいんじゃないでしょうか．<br><br>VS2003やBCC対応はラッパー関数とか置換で後からなんとかなるような気がします．<br><br>他にも起動が遅いとかバイナリがでかいとか気になるところはありますが，その辺も動いてからで．<br></div></section>
    </li></ul></li><li><section><h1 id=69>
    <span class="no">[69]</span>
    <a class="thread-title" href="#69">RE: インクルードガード</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-28T19:49:21">2007年11月28日 19:49</time></h1>
    <div class="body">手で入力すると間違える，他のファイルと衝突するという問題を解決するために，ガード挿入マクロをつくりました．<br>http://sakura.qp.land.to/?Macro%2F%C5%EA%B9%C6%2F184<br>アンダーバーで始まるマクロは予約済みのようなので，SAKURA_ファイル名_GUID_H_ のようなガードを生成するようにしてみました．二回実行すると二つ入ってしまう点はご容赦ください．<br><br>#pragma onceについて，gccのマニュアルではobsolete featureになっているので，世の中の流れとしては縮小傾向なのかなと．<br>http://gcc.gnu.org/onlinedocs/gcc-4.0.3/cpp/Obsolete-once_002donly-headers.html<br>ファイルのパスだけで同一性が判断されるのでsymbolic linkを使った場合に問題が出るみたいです．(ここでは関係ないですが)<br></div></section>
    <ul><li><section><h1 id=72>
    <span class="no">[72]</span>
    <a class="thread-title" href="#72">Re2: インクルードガード</a>
    <span class="author">kobake</span>
    <time datetime="2007-11-29T22:58:41">2007年11月29日 22:58</time></h1>
    <div class="body">▼ げんたさん<br>&gt; 手で入力すると間違える，他のファイルと衝突するという問題を解決するために，ガード挿入マクロをつくりました．<br>&gt; http://sakura.qp.land.to/?Macro%2F%C5%EA%B9%C6%2F184<br>&gt; アンダーバーで始まるマクロは予約済みのようなので，SAKURA_ファイル名_GUID_H_ のようなガードを生成するようにしてみました．二回実行すると二つ入ってしまう点はご容赦ください．<br><br>おぉ！ありがとうございます。ライセンス文も挿入してくれるのが良いですね。<br><br>ところで前々から気になっていたのですが、<br>ファイル終端の「/*[EOF]*/」にはどういった意図があるのでしょうか。<br>本筋の話とは関係無いですが。<br><br><br>&gt; #pragma onceについて，gccのマニュアルではobsolete featureになっているので，世の中の流れとしては縮小傾向なのかなと．<br>&gt; http://gcc.gnu.org/onlinedocs/gcc-4.0.3/cpp/Obsolete-once_002donly-headers.html<br>&gt; ファイルのパスだけで同一性が判断されるのでsymbolic linkを使った場合に問題が出るみたいです．(ここでは関係ないですが)<br><br>なるほど、個人的に残念です。<br>時代を汲むならば#ifndef式に則るほうが良いんですかね。<br><br>＃余談ですが「#pragma once(任意識別子)」のような構文があれば最強だと思います。<br></div></section>
    <ul><li><section><h1 id=73>
    <span class="no">[73]</span>
    <a class="thread-title" href="#73">Re3: インクルードガード</a>
    <span class="author">げんた</span>
    <time datetime="2007-11-30T00:01:21">2007年11月30日 00:01</time></h1>
    <div class="body">&gt;ファイル終端の「/*[EOF]*/」にはどういった意図があるのでしょうか。<br>いやー，なんか最初からそうなっていたので私にもわかりません．無視していたら追加ファイルの末尾に親切に追加してくださる方が現れたりして，かといって禁止したり削除したりするほどの物でもないし，なんとなくそのままになってます．<br><br>EOFでgrepするとファイルの行数が一覧できるとおっしゃった方がいましたが，ソースコード行数は専用のソフトで数えられるし...<br><br>きっと後世の人が想像力のトレーニングをするようにと先祖が残した贈り物なんですよ．(大嘘)<br></div></section>
    </li><li><section><h1 id=74>
    <span class="no">[74]</span>
    <a class="thread-title" href="#74">Re3: インクルードガード</a>
    <span class="author">ラスティブ</span>
    <time datetime="2007-11-30T00:55:08">2007年11月30日 00:55</time></h1>
    <div class="body">げんたさんのマクロをラッキーと叫びつつ使わせていただき、<br>全てのヘッダファイルに以下のようなガードを挿入したものを、<br>保守パッチとは別に新しく作成しています。インクルードガードの<br>変更と bregexp.h の削除だけなので、そのままコミット出来るん<br>ですが・・・kobakeさんに任せちゃってもよろしいでしょうか。<br><br>#ifndef SAKURA_CAUTOSAVE_H__99022BB5_D7EC_492C_9CA2_3B247965BB45__INCLUDED_<br>#define SAKURA_CAUTOSAVE_H__99022BB5_D7EC_492C_9CA2_3B247965BB45__INCLUDED_<br><br>// ...<br><br>#endif /* SAKURA_CAUTOSAVE_H__99022BB5_D7EC_492C_9CA2_3B247965BB45__INCLUDED_ */<br>/*[EOF]*/<br><br>どうでもいい事ですが、こちらでは stdafx.h で使われている<br>インクルードガードを模しています。<br><br>▼ げんたさん(&gt;&gt;73)<br>&gt; きっと後世の人が想像力のトレーニングをするようにと<br>&gt; 先祖が残した贈り物なんですよ．(大嘘)<br><br>(大嘘)← ココ重要ですよね・・・。</div></section>
    </li><li><section><h1 id=75>
    <span class="no">[75]</span>
    <a class="thread-title" href="#75">ファイル終端の/*[EOF]*/</a>
    <span class="author">ryoji</span>
    <time datetime="2007-11-30T01:42:52">2007年11月30日 01:42</time></h1>
    <div class="body">▼ kobakeさん<br>&gt; ところで前々から気になっていたのですが、<br>&gt; ファイル終端の「/*[EOF]*/」にはどういった意図があるのでしょうか。<br>&gt; 本筋の話とは関係無いですが。<br>元はどんな経緯でそうなっているのかはわかりませんが、最終行が空行（改行のみの行）になっていると、TortoizeSVNの"Apply Patch"で勝手に空行が追加される問題があります(&gt;&gt;dev:4637 で記述した「別の話」の件)。<br>Ver1.4.5（current version）でもそうです。次期バージョンのNightly Buildsでは修正されていますが。<br>TortoizeSVNのバージョンによっては気をつけていないと末端にどんどん空行が追加されていくことになるので、そのガードとしては意味があるんじゃないかと...</div></section>
    </li></ul></li></ul></li></ul></li></ul></body></html>