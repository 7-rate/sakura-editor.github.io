<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css">
  <link rel="shortcut icon" href="favicon.ico">
  <title>ver2 の msi形式インストーラ(私家版) を作成してみました。 | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀Unicode版開発トップへ</a>
        <li><div class="list-title">
    <span class="no">1726</span>
    <a class="thread-title" href="1726.html#1726">ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1727</span>
    <a class="thread-title" href="1726.html#1727">Re:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    </li><li><div class="list-title">
    <span class="no">1728</span>
    <a class="thread-title" href="1726.html#1728">Re:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1729</span>
    <a class="thread-title" href="1726.html#1729">Re2:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1730</span>
    <a class="thread-title" href="1726.html#1730">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    </li><li><div class="list-title">
    <span class="no">1731</span>
    <a class="thread-title" href="1726.html#1731">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1750</span>
    <a class="thread-title" href="1726.html#1750">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">1732</span>
    <a class="thread-title" href="1726.html#1732">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1741</span>
    <a class="thread-title" href="1726.html#1741">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1743</span>
    <a class="thread-title" href="1726.html#1743">Re5:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1744</span>
    <a class="thread-title" href="1726.html#1744">Re6:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1745</span>
    <a class="thread-title" href="1726.html#1745">Re7:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    </li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">1740</span>
    <a class="thread-title" href="1726.html#1740">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1746</span>
    <a class="thread-title" href="1726.html#1746">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1747</span>
    <a class="thread-title" href="1726.html#1747">Re5:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    <ul><li><div class="list-title">
    <span class="no">1748</span>
    <a class="thread-title" href="1726.html#1748">Re6:ver2 の msi形式インストーラ(私家版) を作成してみました。</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=1726>
    <span class="no">[1726]</span>
    <a class="thread-title" href="#1726">ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">tohosaku</span>
    <time datetime="2012-01-15T23:36:17">2012年01月15日 23:36</time></h1>
    <div class="body">複数PCに導入したかったため、msi形式のファイルを作成してみました。<br>作成には、Wix を使用しています。<br><br><a href=http://loda.jp/sakura_editor/?id=32 target=_top><nobr>http://<wbr>loda.<wbr>jp/<wbr>sakura_e<wbr>ditor/?<wbr>id=<wbr>32</nobr></a><br><br>インストーラのソースは、こちらです。<br><br><a href=https://github.com/tohosaku/SakuraEditorMsiInstaller target=_top><nobr>https://<wbr>github.<wbr>com/<wbr>tohosaku<wbr>/<wbr>SakuraEd<wbr>itorMsiI<wbr>nstaller<wbr></nobr></a></div></section>
    <ul><li><section><h1 id=1727>
    <span class="no">[1727]</span>
    <a class="thread-title" href="#1727">Re:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">syat</span>
    <time datetime="2012-01-18T07:12:11">2012年01月18日 07:12</time></h1>
    <div class="body">▼ tohosakuさん<br>こんにちは。<br>動かしてみた感触ですが、なかなか良さげでした。<br><br>インストーラを作るにはVS Professionalが必要なのかと思いこんでいましたが、<br>Wixというフリーのツールがあったのですね。<br>手順もあるので試してみます（時間のあるときに。。）<br><br>気付いた点として、<br>・インストールするとマルチユーザモードになるので、<br>　共通で使っていた人は注意です。<br>　落ち着いてsakura.exe.iniを直せばよいのですが、<br>　事前にバックアップしたほうがよいでしょう。<br>・タイプ別設定の同梱いいですね。<br>　これらも行く行くはSVNに登録したらよいと思いました<br>　（キーワードなども一緒に）<br></div></section>
    </li><li><section><h1 id=1728>
    <span class="no">[1728]</span>
    <a class="thread-title" href="#1728">Re:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">Coward</span>
    <time datetime="2012-01-18T21:17:14">2012年01月18日 21:17</time></h1>
    <div class="body">&gt; インストーラのソースは、こちらです。<br>&gt; <br>&gt; <a href=https://github.com/tohosaku/SakuraEditorMsiInstaller target=_top><nobr>https://<wbr>github.<wbr>com/<wbr>tohosaku<wbr>/<wbr>SakuraEd<wbr>itorMsiI<wbr>nstaller<wbr></nobr></a><br><br>↑のページにも書かれてるみたいですが、<br>従来のANSI版で使われている本家インストーラのソースは、<br><a href=http://sourceforge.net/apps/trac/sakura-editor/wiki/Installer target=_top><nobr>http://<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>apps/<wbr>trac/<wbr>sakura-<wbr>editor/<wbr>wiki/<wbr>Installe<wbr>r</nobr></a><br>のほうですよね？</div></section>
    <ul><li><section><h1 id=1729>
    <span class="no">[1729]</span>
    <a class="thread-title" href="#1729">Re2:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">syat</span>
    <time datetime="2012-01-21T10:34:15">2012年01月21日 10:34</time></h1>
    <div class="body">▼ Cowardさん<br>&gt; 従来のANSI版で使われている本家インストーラのソースは、<br>&gt; <a href=http://sourceforge.net/apps/trac/sakura-editor/wiki/Installer target=_top><nobr>http://<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>apps/<wbr>trac/<wbr>sakura-<wbr>editor/<wbr>wiki/<wbr>Installe<wbr>r</nobr></a><br>&gt; のほうですよね？<br><br>あ、本家も手順とかあったんですね。見落としてました。<br><br>ちょっと本家版で作ってみました。<br><a href=http://loda.jp/sakura_editor/?id=33 target=_top><nobr>http://<wbr>loda.<wbr>jp/<wbr>sakura_e<wbr>ditor/?<wbr>id=<wbr>33</nobr></a><br><br>XPで動作確認済みです。既存のスクリプトを使っているので<br>多分問題無いと思いますが、Vista,7で確認された方は教えて<br>いただけるとありがたいです。<br><br>また、sakura.exe.manifestがXP版とVista版があるようなのですが、<br>元ファイルが見つからないため同じファイルを指定しています。<br>この辺に詳しい方、ご教授ください。<br><br></div></section>
    <ul><li><section><h1 id=1730>
    <span class="no">[1730]</span>
    <a class="thread-title" href="#1730">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-21T12:37:04">2012年01月21日 12:37</time></h1>
    <div class="body">▼ syatさん<br>たぶん、従来使われていたマニフェストはそれぞれ下記ページに例示されているものと同じです。<br><br>XP 以前用: <a href=http://sakura-editor.sourceforge.net/htmlhelp2/HLP000079.html target=_top><nobr>http://<wbr>sakura-<wbr>editor.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>htmlhelp<wbr>2/<wbr>HLP00007<wbr>9.<wbr>html</nobr></a><br>Vista 以後用: <a href=http://sakura-editor.sourceforge.net/htmlhelp2/HLP000080.html target=_top><nobr>http://<wbr>sakura-<wbr>editor.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>htmlhelp<wbr>2/<wbr>HLP00008<wbr>0.<wbr>html</nobr></a><br><br>Unicode版の場合、XP 以前用には上記のマニフェストを、Vista 以後用には単体リリースに同梱のマニフェストを使ってもらえばいいと思います。<br>Unicode版では rev1664,1665 あたりで DPI 対応（DPI Aware）もやっているので、同梱のマニフェストでは、従来の Vista 以後用の設定に加えて DPI 仮想化を無効にするよう、追加指定してあります。<br>※ 現状の DPI 対応では、DPI に応じた画面レイアウトの調整はしていますが DPI ごとにアイコンを切り替えるところまではしていません<br><br>DPI 対応に関する参考サイト:<br><a href=http://preview.library.microsoft.com/ja-jp/windows/dd630126 target=_top><nobr>http://<wbr>preview.<wbr>library.<wbr>microsof<wbr>t.<wbr>com/<wbr>ja-<wbr>jp/<wbr>windows/<wbr>dd630126<wbr></nobr></a><br><br>syat さんのほうでマニフェスト切り替えに対応したインストーラを作成していただけるようでしたら、自分も Vista/7 あたりで動作確認をしてみようかな？と思います。</div></section>
    </li><li><section><h1 id=1731>
    <span class="no">[1731]</span>
    <a class="thread-title" href="#1731">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-21T13:17:14">2012年01月21日 13:17</time></h1>
    <div class="body">▼ syatさん<br>&gt; あ、本家も手順とかあったんですね。見落としてました。<br><br>インストーラのソースもリポジトリに追加したほうが良さそうですね。<br>従来構成に倣い、次のような感じでしょうか。<br><br><a href=https://sakura-editor.svn.sourceforge.net/svnroot/sakura-editor/ target=_top><nobr>https://<wbr>sakura-<wbr>editor.<wbr>svn.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>svnroot/<wbr>sakura-<wbr>editor/<wbr></nobr></a><br>  ┃<br>  ┣━ help<br>  ┃<br>  ┣━ sakura<br>  ┃<br>  ┗━ installer<br>         ┃ <br>         ┗━ trunk2<br></div></section>
    <ul><li><section><h1 id=1750>
    <span class="no">[1750]</span>
    <a class="thread-title" href="#1750">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-02-06T02:26:03">2012年02月06日 02:26</time></h1>
    <div class="body">自己レスです。<br> <br>&gt; <a href=https://sakura-editor.svn.sourceforge.net/svnroot/sakura-editor/ target=_top><nobr>https://<wbr>sakura-<wbr>editor.<wbr>svn.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>svnroot/<wbr>sakura-<wbr>editor/<wbr></nobr></a><br>&gt;   ┃<br>&gt;   ┣━ help<br>&gt;   ┃<br>&gt;   ┣━ sakura<br>&gt;   ┃<br>&gt;   ┗━ installer<br>&gt;          ┃ <br>&gt;          ┗━ trunk2<br><br>とりあえず、この構成で V2 用を作ってみました。<br>まだテストしてませんけど。</div></section>
    </li></ul></li><li><section><h1 id=1732>
    <span class="no">[1732]</span>
    <a class="thread-title" href="#1732">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">tohosaku</span>
    <time datetime="2012-01-21T13:30:52">2012年01月21日 13:30</time></h1>
    <div class="body">▼ Cowardさん<br>&gt; 従来のANSI版で使われている本家インストーラのソースは、<br>&gt; http://sourceforge.net/apps/trac/sakura-editor/wiki/Installer<br>&gt; のほうですよね？<br><br>おっしゃる通りです。まぎらわしくてすいません。<br><br>▼ syatさん<br>&gt; ちょっと本家版で作ってみました。<br>&gt; http://loda.jp/sakura_editor/?id=33<br>&gt; <br>&gt; XPで動作確認済みです。既存のスクリプトを使っているので<br>&gt; 多分問題無いと思いますが、Vista,7で確認された方は教えて<br>&gt; いただけるとありがたいです。<br>Inno Setup がよく分からずにあまり触れてなかったんですが、ver2 でも<br>使えるんですね。<br>やっぱり本家の方が、いろいろ配慮されていると思います。(これで、.msi が作れりゃなあ……)<br><br>Win7 64bit で試してみましたが、スタートメニューのトップに「サクラエディタ」以外に「アンインストール」も一緒に表示されてしまうみたいです。</div></section>
    <ul><li><section><h1 id=1741>
    <span class="no">[1741]</span>
    <a class="thread-title" href="#1741">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-22T16:07:06">2012年01月22日 16:07</time></h1>
    <div class="body">▼ tohosakuさん<br>&gt; Win7 64bit で試してみましたが、スタートメニューのトップに「サクラエディタ」以外に「アンインストール」も一緒に表示されてしまうみたいです。<br><br>自分もWin7 64bitで動かしてみました。<br>ここでいう「スタートメニューのトップ」というのは、<br>[すべてのプログラム]-[サクラエディタ]フォルダのことで、<br>その下に[サクラエディタ]と[アンインストール]のショートカットが並んで表示される、ということでしょうか？<br>でしたら、それは Ver1.6.6.0 を XP にインストールしたときでも同様で、従来からそういう仕様になっているみたいです。<br><br>[すべてのプログラム]の直下に[アクセサリ]フォルダなどと並んで[アンインストール]ショートカットが表示される、ということであれば、そういう現象は自分のところでは再現しませんでした。</div></section>
    <ul><li><section><h1 id=1743>
    <span class="no">[1743]</span>
    <a class="thread-title" href="#1743">Re5:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">tohosaku</span>
    <time datetime="2012-01-22T21:54:44">2012年01月22日 21:54</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; ▼ tohosakuさん<br>&gt; &gt; Win7 64bit で試してみましたが、スタートメニューのトップに「サクラエデ<br>&gt; &gt;ィタ」以外に「アンインストール」も一緒に表示されてしまうみたいです。<br>&gt; <br>&gt; 自分もWin7 64bitで動かしてみました。<br>&gt; ここでいう「スタートメニューのトップ」というのは、<br>&gt; [すべてのプログラム]-[サクラエディタ]フォルダのことで、<br>&gt; その下に[サクラエディタ]と[アンインストール]のショートカットが並んで表<br>&gt; 示される、ということでしょうか？<br>&gt; でしたら、それは Ver1.6.6.0 を XP にインストールしたときでも同様で、従<br>&gt; 来からそういう仕様になっているみたいです。<br>&gt; <br><br><a href=http://sakura.qp.land.to/?plugin=attach&pcmd=open&file=%A5%B9%A5%BF%A1%BC%A5%C8%A5%E1%A5%CB%A5%E5%A1%BC.png&refer=Junk%2F41 target=_top><nobr>http://<wbr>sakura.<wbr>qp.<wbr>land.<wbr>to/?<wbr>plugin=<wbr>attach&amp;<wbr>pcmd=<wbr>open&amp;<wbr>file=%<wbr>A5%<wbr>B9%<wbr>A5%<wbr>BF%<wbr>A1%<wbr>BC%<wbr>A5%<wbr>C8%<wbr>A5%<wbr>E1%<wbr>A5%<wbr>CB%<wbr>A5%<wbr>E5%<wbr>A1%<wbr>BC.<wbr>png&amp;<wbr>refer=<wbr>Junk%<wbr>2F41</nobr></a><br><br>　最近開いたプログラムを[スタート]メニューに保存し表示する」にチェック<br>が入っていると、上のリンクの画像のような感じで「アンインストール」まで<br>表示されてしまうようです。<br><br>　右クリックして、「この一覧から削除」を選択すればそれまでなんですが。</div></section>
    <ul><li><section><h1 id=1744>
    <span class="no">[1744]</span>
    <a class="thread-title" href="#1744">Re6:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-22T23:13:01">2012年01月22日 23:13</time></h1>
    <div class="body">あ、「最近開いたプログラム」のほうでしたか。それは見落としてました。<br>最初、そっちにも「サクラエディタ」しかないなぁ？と思ったのですが、<br>よく見ると離れた位置にひっそりと「アンインストール」が追加されてました。<br>（自分は「最近開いたプログラム」を小さいアイコンで20個も表示してるので．．．）<br><br>インストール直後の「最近開いたプログラム」への「サクラエディタ」と「アンインストール」の追加状況は OS によって微妙に変化するみたいです。<br>手元の環境では次のようになりました。<br>・64bit Win7 だと両方追加される（Ver1.6.6.0 のインストーラでも）<br>・XPだとどっちも追加されない<br>・32bit Win7だと「サクラエディタ」は追加され「アンインストール」は追加されない<br>OS側の「最近開いたプログラム」の検出方法の差異でしょうかね？<br>それだとインストーラスクリプトの書き方くらいでは回避できないかも。</div></section>
    <ul><li><section><h1 id=1745>
    <span class="no">[1745]</span>
    <a class="thread-title" href="#1745">Re7:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-23T21:10:44">2012年01月23日 21:10</time></h1>
    <div class="body">VM を使ってクリーンな状態の 64bit Win7 で追試してみたところ、カラクリが見えてきました。<br>どうやら、一度アンインストールを実施した後で再インストールすると、先に実行したアンインストールの履歴が使われて「最近開いたプログラム」に「アンインストール」が登場するみたいです。<br><br>１．初回インストール実施<br> → 「最近開いたプログラム」には「サクラエディタ」だけが表示される<br>２．[すべてのプログラム]-[サクラエディタ]-[アンインストール]を実行<br> → 「最近開いたプログラム」から「サクラエディタ」が消える<br>３．再インストール実施<br> → 「最近開いたプログラム」に「サクラエディタ」と「アンインストール」が表示される<br><br>２の時点で実行された「アンインストール」が履歴に登録されるけれど、アンインストーラ自体がディスク上から削除されるので、その時点では表示されない。<br>３でアンインストーラがディスク上に復活すると、履歴に残っていた「アンインストール」が表示される。<br>何か、そんな感じみたいです。<br><br>他アプリでもアンインストーラが exe で提供されているものは皆こうなりそうです。あまり気にしなくていいんじゃないかと。</div></section>
    </li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=1740>
    <span class="no">[1740]</span>
    <a class="thread-title" href="#1740">Re3:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-22T15:34:06">2012年01月22日 15:34</time></h1>
    <div class="body">&gt; また、sakura.exe.manifestがXP版とVista版があるようなのですが、<br>&gt; 元ファイルが見つからないため同じファイルを指定しています。<br><br>Ver1.6.6.0のインストーラから抜き出したマニフェストを本家版ページに追加添付しておきました。<br><a href=https://sourceforge.net/apps/trac/sakura-editor/wiki/Installer target=_top><nobr>https://<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>apps/<wbr>trac/<wbr>sakura-<wbr>editor/<wbr>wiki/<wbr>Installe<wbr>r</nobr></a></div></section>
    <ul><li><section><h1 id=1746>
    <span class="no">[1746]</span>
    <a class="thread-title" href="#1746">Re4:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">syat</span>
    <time datetime="2012-01-24T02:34:47">2012年01月24日 02:34</time></h1>
    <div class="body">▼ tohosakuさん、ryojiさん<br>動作確認ありがとうございます。<br><br>&gt; Ver1.6.6.0のインストーラから抜き出したマニフェストを本家版ページに追加添付しておきました。<br>&gt; <a href=https://sourceforge.net/apps/trac/sakura-editor/wiki/Installer target=_top><nobr>https://<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>apps/<wbr>trac/<wbr>sakura-<wbr>editor/<wbr>wiki/<wbr>Installe<wbr>r</nobr></a><br>すみませんありがとうございます。<br>ちょっと思ったのですが、私はまだXPを使い続けていますが、manifestはzip同梱のものを使用して特に不都合は感じません。<br>対応していない機能の記述は無視されると思うので、OSによらず最新のmanifestでも良いのでは？<br><br></div></section>
    <ul><li><section><h1 id=1747>
    <span class="no">[1747]</span>
    <a class="thread-title" href="#1747">Re5:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">ryoji</span>
    <time datetime="2012-01-24T18:56:54">2012年01月24日 18:56</time></h1>
    <div class="body">▼ syatさん<br>&gt; OSによらず最新のmanifestでも良いのでは？<br><br>現行インストーラは、XP用／Vista用どっちのマニフェストをインストールするかを、ターゲット OS で決めてるんじゃなくて、マルチユーザを選択したかどうかで決めてるみたいです。シングルユーザなら XP用で、マルチユーザなら Vista用。そういう意味では現行の呼称がおかしいのですが、とりあえずここでは XP用／Vista用と表記します。<br><br>確かに、XP にインストールして XP で使い続ける（OS アップグレードはしない）分にはどっちのマニフェストを使ってても問題ないです。マニフェストを使い分ける必要があるのは、むしろ Vista/7 にインストールしたり、OS を XP から Vista/7 にアップグレードする場合です。<br><br>具体的には、Vista/7 で Program Files 下に sakura.exe が置かれた場合、<br>・マルチユーザ指定なら Vista用マニフェストが設置されているのが最善（ベスト）<br>・シングルユーザ指定で Vista用マニフェストが設置されていると最悪（ワースト）<br>という状況になります。<br><br>後者の状況になると Program Files\sakura\sakura.ini が上書き保存されなくなります。UAC がどういうものかを知らないユーザの場合、これを自力で解決するのはなかなか難しいと思います。<br>シングルユーザ指定の場合に Vista用ではなく XP用マニフェストが設置されていれば、sakura.ini の保存先は Virtual Store にはなりますが、正常に保存されて普通に使えます。なので、現行インストーラでは XP用を設置するようにしているのだと思います。<br><br>なお、XP ではシングルユーザ、Vista/7 ではマルチユーザがインストール時のデフォルト値になっていて、インストーラ実行時に「よくわからない場合は変更しないでください」と表示されるようになってます。<br><br>【追記】<br>最新マニフェストに追加した "DPI Aware" の部分については、両方のマニフェストに入ってても問題ないと思います。</div></section>
    <ul><li><section><h1 id=1748>
    <span class="no">[1748]</span>
    <a class="thread-title" href="#1748">Re6:ver2 の msi形式インストーラ(私家版) を作成してみました。</a>
    <span class="author">tohosaku</span>
    <time datetime="2012-01-24T23:33:55">2012年01月24日 23:33</time></h1>
    <div class="body">▼ ryojiさん<br><br>　VirtualStore って、どちらかというと経過措置という意味合いの機能だと思います。個人的にはこれから配布するものは、マルチユーザのmanifestを実行ファイルに埋めこんで、XPのみ外部ファイルの manifestでシングルユーザに対応、というのが妥当かな、と思っているんですが、確かに既存のユーザーは混乱するかもしれないですね。<br><br>　インストール時に警告を出す以上の解決策が思いつかないです。(インストール時に、VirtualStoreのフォルダを検索して、ファイルサイズや更新時刻を示すとか、根性があればできるかもしれませんが。)</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>