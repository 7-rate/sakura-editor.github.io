<!DOCTYPE html><html><head><meta charset='utf-8'><title>plugin機能について</title><link rel='stylesheet' href='bbs.css' /><script src='bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←unicodeトップへ</a><li><div class="list-title">
    <span class="no">1127</span>
    <a class="title" href="1127.html#1127">plugin機能について</a></div>
    <ul><li><div class="list-title">
    <span class="no">1128</span>
    <a class="title" href="1127.html#1128">Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1129</span>
    <a class="title" href="1127.html#1129">Re:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1130</span>
    <a class="title" href="1127.html#1130">Re2:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1133</span>
    <a class="title" href="1127.html#1133">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1136</span>
    <a class="title" href="1127.html#1136">Re4:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1137</span>
    <a class="title" href="1127.html#1137">Re5:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    </li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">1131</span>
    <a class="title" href="1127.html#1131">Re2:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    <ul><li><div class="list-title">
    <span class="no">1134</span>
    <a class="title" href="1127.html#1134">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    </li><li><div class="list-title">
    <span class="no">1135</span>
    <a class="title" href="1127.html#1135">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=1127>
    <span class="no">[1127]</span>
    <a class="title" href="#1127">plugin機能について</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-19T06:59:17">2010年03月19日 06:59</time></h1>
    <div class="body">syatさんのプラグイン機能をMocaさんのsolXmlで使用させていただきました。<br><br>そこで気づいた点と要望をいくつか上げさせてもらいます。<br><br>不具合から<br>１. ツールバーの設定でプラグインのコマンドと「折返」が衝突を起こしています。<br><br>以下は要望です（個人的優先度順）。<br>２. sakuraW.iniの設定で szOutlineRuleFilename の設定を相対パスで指定してほしい。<br>    （sakuraw.exeをUSBメモリに入れて、複数マシンで使用しているので絶対パスで指定されるとちょっとつらいものがあります）<br>    .iniファイルの直接書き換えで相対パスにすれば動作することは確認しています。<br>３. 「新規プラグインの追加」、「削除」を実行した後、再起動せずに有効となるようにしてほしい。<br>４. プラグインの「オプションファイル」の設定を行うダイアログがほしい。<br>    RubyIndent.ini の SpaceIndent の設定などです。<br>５. プラグインの中のファイルをZIP等で固めて、そのZIPファイルごとプラグインとして使用できるようにしてほしい。<br>    （XP以降限定になるかな？）<br><br>(sakuraW_pluginU7.2.zip、sakuraw_plugin_solXml0.1.zip、RubyOutline0.1.zip、RubyIndent0.1.zipで確認しています)<br></div></section>
    <ul><li><section><h1 id=1128>
    <span class="no">[1128]</span>
    <a class="title" href="#1128">Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">syat</span>
    <time datetime="2010-03-21T09:10:06">2010年03月21日 09:10</time></h1>
    <div class="body">▼ Uchiさん<br>&gt; １. ツールバーの設定でプラグインのコマンドと「折返」が衝突を起こしています。<br>ご指摘ありがとうございます。リビジョン1721で修正しました。<br><br>&gt; ２. sakuraW.iniの設定で szOutlineRuleFilename の設定を相対パスで指定してほしい。<br>&gt;     （sakuraw.exeをUSBメモリに入れて、複数マシンで使用しているので絶対パスで指定されるとちょっとつらいものがあります）<br>&gt;     .iniファイルの直接書き換えで相対パスにすれば動作することは確認しています。<br>テキストボックスの内容を手で書き換えてください。というところですが<br>改造するとすればダイアログで指定したファイルがiniと同じフォルダかそれ以下の階層にあれば相対パスで指定する、のようになるでしょうか。<br>マクロフォルダの指定も同じく。<br><br>&gt; ３. 「新規プラグインの追加」、「削除」を実行した後、再起動せずに有効となるようにしてほしい。<br>どうするか迷っています。今のレベルのプラグインであれば即時有効でも良いのですが、プロセスとプラグインの寿命が合っていた方がシンプルで良いのではないかと思って今の動きにしています。Firefoxのアドオン追加でも再起動を要求しますし、わりと一般的な動きかな、と。<br>削除の方は、あるプロセスで即時削除しても別のプロセスで実行中かもしれないので完全な削除はできません。全プロセスに通知してアンロードさせるのも面倒くさい。。。<br><br>&gt; ４. プラグインの「オプションファイル」の設定を行うダイアログがほしい。<br>ほしいです。共通設定・タイプ別設定を拡張する形になるのか、プラグインごとの設定という形になるのかはわかりませんが、Firefoxでいうabout:configのような感じになるのでは？（Firefoxばかりですみません）<br><br>&gt; ５. プラグインの中のファイルをZIP等で固めて、そのZIPファイルごとプラグインとして使用できるようにしてほしい。<br>&gt;     （XP以降限定になるかな？）<br>ファイル選択ダイアログでzipを指定すると、pluginsに解凍してインストールするところまでやってくれると便利ですね。<br>第一段階としてzip置いておくと勝手に解凍する機能がほしいです。zipfldr.dllを使うのでしょうか。よく知りません。<br></div></section>
    <ul><li><section><h1 id=1129>
    <span class="no">[1129]</span>
    <a class="title" href="#1129">Re:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-21T20:59:30">2010年03月21日 20:59</time></h1>
    <div class="body">syatさん,<br>ご返事ありがとうございます。<br><br>▼ syatさん<br>&gt; ▼ Uchiさん<br>&gt; &gt; １. ツールバーの設定でプラグインのコマンドと「折返」が衝突を起こしています。<br>&gt; ご指摘ありがとうございます。リビジョン1721で修正しました。<br>CMenuDrawer.cpp<br>..\sakura_core\CMenuDrawer.cpp(538) : error C2065: 'F_TOOLBARWRAP' : 定義されていない識別子です。<br>のエラーが出て、コンパイルできませんでした。<br>&gt; <br>&gt; &gt; ２. sakuraW.iniの設定で szOutlineRuleFilename の設定を相対パスで指定してほしい。<br>&gt; &gt;     （sakuraw.exeをUSBメモリに入れて、複数マシンで使用しているので絶対パスで指定されるとちょっとつらいものがあります）<br>&gt; &gt;     .iniファイルの直接書き換えで相対パスにすれば動作することは確認しています。<br>&gt; テキストボックスの内容を手で書き換えてください。というところですが<br>&gt; 改造するとすればダイアログで指定したファイルがiniと同じフォルダかそれ以下の階層にあれば相対パスで指定する、のようになるでしょうか。<br>&gt; マクロフォルダの指定も同じく。<br>すみませんでした。私の勘違いです。忘れてください。<br>&gt; <br>&gt; &gt; ３. 「新規プラグインの追加」、「削除」を実行した後、再起動せずに有効となるようにしてほしい。<br>&gt; どうするか迷っています。今のレベルのプラグインであれば即時有効でも良いのですが、プロセスとプラグインの寿命が合っていた方がシンプルで良いのではないかと思って今の動きにしています。Firefoxのアドオン追加でも再起動を要求しますし、わりと一般的な動きかな、と。<br>&gt; 削除の方は、あるプロセスで即時削除しても別のプロセスで実行中かもしれないので完全な削除はできません。全プロセスに通知してアンロードさせるのも面倒くさい。。。<br>この要望を出した理由は、<br>「追加」の後に、「タイプ別設定」で「アウトライン解析方法」「インデント」を設定するわけですが、そこまで一連で作業が行いたい。<br>ということです。<br>Firefoxでもアドオン追加 直後でも設定は出来るので、出来ればなと思います。<br>&gt; <br>&gt; &gt; ４. プラグインの「オプションファイル」の設定を行うダイアログがほしい。<br>&gt; ほしいです。共通設定・タイプ別設定を拡張する形になるのか、プラグインごとの設定という形になるのかはわかりませんが、Firefoxでいうabout:configのような感じになるのでは？（Firefoxばかりですみません）<br>たとえば、「共通設定」の「プラグイン」タグの「削除」の隣当たりに「プラグイン設定」のボタンがあり、それを押すと、設定ダイアログが表示され、たとえばRubyIndent.ini の内容を設定する、という様なイメージです。<br>何を設定するかは、plugin.defに設定することになるでしょうね。<br>&gt; <br>&gt; &gt; ５. プラグインの中のファイルをZIP等で固めて、そのZIPファイルごとプラグインとして使用できるようにしてほしい。<br>&gt; &gt;     （XP以降限定になるかな？）<br>&gt; ファイル選択ダイアログでzipを指定すると、pluginsに解凍してインストールするところまでやってくれると便利ですね。<br>&gt; 第一段階としてzip置いておくと勝手に解凍する機能がほしいです。zipfldr.dllを使うのでしょうか。よく知りません。<br>わたしは、解凍せずにそのままの形でプラグインとして機能することを考えていました。<br>インストールでも良いのですけれども。<br></div></section>
    <ul><li><section><h1 id=1130>
    <span class="no">[1130]</span>
    <a class="title" href="#1130">Re2:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">もか</span>
    <time datetime="2010-03-21T23:40:50">2010年03月21日 23:40</time></h1>
    <div class="body">&gt;&gt; &gt; ５. プラグインの中のファイルをZIP等で固めて、そのZIPファイルごとプラグインとして使用できるようにしてほしい。<br>&gt;わたしは、解凍せずにそのままの形でプラグインとして機能することを考えていました。<br>&gt;インストールでも良いのですけれども。<br>unzip32.dllというファイル名は鬼門で、最近は減りましたが海外のソフトが 統合アーカイバ仕様でない<br>unzip32.dllをWindowsフォルダに放置したりするため、エラーの原因になります。<br>CAB形式なら Windows の SetupIterateCabinet() とかもあります。<br>圧縮したままというのは、1ファイル、1プロセスのサクラでやるのはおかしいです。<br>シングルプロセス版にするなら別ですが。<br><br>Firefoxの拡張はたぶんだけど、JavaScriptがGCで動いているのもあって開放するタイミングが分からないのと、<br>元もとのchrome.js等のJavaScriptのコードを拡張が書き換えて(!)動かしていたりするので、途中で削除すると大変なことになるからだとおもいます。<br>xpiはzip圧縮形式だけど、実は圧縮しないでまとめてあるだけのほうが多い気がします。<br><br>narとかwarとかjarは良く知りません。<br></div></section>
    <ul><li><section><h1 id=1133>
    <span class="no">[1133]</span>
    <a class="title" href="#1133">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-22T01:12:41">2010年03月22日 01:12</time></h1>
    <div class="body">▼ もかさん<br>&gt; 圧縮したままというのは、1ファイル、1プロセスのサクラでやるのはおかしいです。<br>&gt; シングルプロセス版にするなら別ですが。<br>「解凍せずにそのままの形でプラグイン」ということにこだわっているわけではありませんが、<br>上記の判断の理由がわからないので、後学のために、教えていただけたらと思います。<br>よろしくお願いします。</div></section>
    <ul><li><section><h1 id=1136>
    <span class="no">[1136]</span>
    <a class="title" href="#1136">Re4:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">もか</span>
    <time datetime="2010-03-22T02:57:16">2010年03月22日 02:57</time></h1>
    <div class="body">&gt;タイトル: Re4:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突<br>&gt;発言者: Uchi<br>&gt;▼ もかさん<br>&gt;&gt; 圧縮したままというのは、1ファイル、1プロセスのサクラでやるのはおかしいです。<br>&gt;&gt; シングルプロセス版にするなら別ですが。<br>&gt;「解凍せずにそのままの形でプラグイン」ということにこだわっているわけではありませんが、<br>&gt;上記の判断の理由がわからないので、後学のために、教えていただけたらと思います。<br>&gt;よろしくお願いします。<br>プロセスごとにプラグイン設定の実体を持っているので、<br>ウィンドウを開くたびに設定している全プラグインをメモリー上で解凍する処理が必要になります。<br>plugin.defだけ解凍すればいいのかもしれないけど、19個全部読み込んだら重そうです。<br>そのうち50個にしてほしいとか言われて、もっと重くなることが容易に想像できます。<br>と思ってたのですが、やってみないとわからないですね。<br>新規作成したいだけなのに、非常にのっそり起動するサクラを想像して感情的になってました。すみません。<br>共通設定(sakura.ini)のほうを工夫すれば、関係ないときは解凍しないようにできそうですが、プラグインがバージョンアップしたときなどに矛盾しそうで怖いです。<br>#今もsakura.iniとplugin.defでplugin.defを書き換えるとID(番号でないほう)が矛盾するきがする<br><br>ちなみに私も本当はデメリットがなければ 3. 4. 5. 全部ほしいです。<br>サクラに設定ファイルzip(のようなもの)を適用(ドロップかインポートみたいなアクションか何か)させたら、タイプ別設定・強調キーワード・マクロ設定・プラグイン設定・などなどがユーザの許可が下りれば自動でできるのが理想です。<br><br>心配なのはzipfldr.dllを使った場合、<br>IE6に依存したクリップボードマクロに似た互換性問題のようなものを感じます。<br>zipの中身をエクスプローラで検索されると重いので、zipfldr.dllのCOM登録を解除することがよくあるのですが、それでも解凍できるのでしょうか？<br>もうひとつは Windows XP Gold/SP2/SP3/Vista/7 次のOSとx86でない場合でも同じ方法で使えるのかどうかです。<br>だたの想像ですけど、次のOSからエクスプローラは64bitだけになって32bit版zipfldr.dllが添付されなくなって、32bitサクラエディタはプラグインが読めない発生する可能性がありそう。<br><br>そういえば、Tomcatはwarを置くと自動で検出して、workディレクトリ以下に展開して使ってくれると思います。<br></div></section>
    <ul><li><section><h1 id=1137>
    <span class="no">[1137]</span>
    <a class="title" href="#1137">Re5:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-22T06:58:58">2010年03月22日 06:58</time></h1>
    <div class="body">▼ もかさん<br>&gt; プロセスごとにプラグイン設定の実体を持っているので、<br>&gt; ウィンドウを開くたびに設定している全プラグインをメモリー上で解凍する処理が必要になります。<br>&gt; plugin.defだけ解凍すればいいのかもしれないけど、19個全部読み込んだら重そうです。<br>私もそう思いました。<br>が、しかし、現在の実装でも、解凍が無いだけで各プロセスの起動時に読み込むことは変わりが無いわけです。<br>実装のほうで、プラグインの共有メモリ化を図った方が建設的ではないかと思います。<br>&gt; サクラに設定ファイルzip(のようなもの)を適用(ドロップかインポートみたいなアクションか何か)させたら、タイプ別設定・強調キーワード・マクロ設定・プラグイン設定・などなどがユーザの許可が下りれば自動でできるのが理想です。<br>私もほしいです。<br>私は、まずは、タイプ別設定の丸ごとインポート、エクスポートを作成しようとしたら、引っ付いてくるデータが多すぎてあきらめたことがあります。<br>今回のプラグインでまた引っ付くデータ2個増えたという感じですね。<br>&gt; だたの想像ですけど、次のOSからエクスプローラは64bitだけになって32bit版zipfldr.dllが添付されなくなって、32bitサクラエディタはプラグインが読めない発生する可能性がありそう。<br>Windowsの次期バージョンは64bitのみの提供になることは、既定の路線のようですね。<br>その時点でsakuraの64bit版が32bit版と同じくらいに走っていればいいですね。<br></div></section>
    </li></ul></li></ul></li></ul></li><li><section><h1 id=1131>
    <span class="no">[1131]</span>
    <a class="title" href="#1131">Re2:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">syat</span>
    <time datetime="2010-03-22T00:45:53">2010年03月22日 00:45</time></h1>
    <div class="body">▼ Uchiさん<br>&gt; CMenuDrawer.cpp<br>&gt; ..\sakura_core\CMenuDrawer.cpp(538) : error C2065: 'F_TOOLBARWRAP' : 定義されていない識別子です。<br>&gt; のエラーが出て、コンパイルできませんでした。<br>すみません。ヘッダ自動生成されるのを忘れてました。なぜかビルド通ったので気付かなかった；<br>リビジョン1722で修正しています。<br><br>&gt; &gt; &gt; ３. 「新規プラグインの追加」、「削除」を実行した後、再起動せずに有効となるようにしてほしい。<br>&gt; この要望を出した理由は、<br>&gt; 「追加」の後に、「タイプ別設定」で「アウトライン解析方法」「インデント」を設定するわけですが、そこまで一連で作業が行いたい。<br>&gt; ということです。<br>なるほど。<br><br>&gt; &gt; &gt; ４. プラグインの「オプションファイル」の設定を行うダイアログがほしい。<br>&gt; たとえば、「共通設定」の「プラグイン」タグの「削除」の隣当たりに「プラグイン設定」のボタンがあり、それを押すと、設定ダイアログが表示され、たとえばRubyIndent.ini の内容を設定する、という様なイメージです。<br>ボタンを押すと別サクラでRubyIndent.iniを開くという悪魔案を思いつきましたが、いらないですよね。。<br><br>&gt; &gt; &gt; ５. プラグインの中のファイルをZIP等で固めて、そのZIPファイルごとプラグインとして使用できるようにしてほしい。<br>&gt; わたしは、解凍せずにそのままの形でプラグインとして機能することを考えていました。<br>&gt; インストールでも良いのですけれども。<br>OSの機能でZIP内のファイルを直接読み込めるのだったらそれがいいと思います。<br>毎回テンポラリに解凍するくらいなら、プラグイン追加時に解凍してしまった方が性能的に良いかなと思ったので。<br></div></section>
    <ul><li><section><h1 id=1134>
    <span class="no">[1134]</span>
    <a class="title" href="#1134">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-22T01:24:55">2010年03月22日 01:24</time></h1>
    <div class="body">４. ５. の要望を出した理由は、<br>プラグインの作者と使用者が異なり、かつ使用者が初心者クラスであることを想定しています<br>（もちろん、初心者でなくても十分役に立ちますが）。<br>ネットから拾ってきて、そのまま設定すればOKねに近いほうが使用してもらえるのではと思いました。<br>作成のほうは大変のなので、プラグインが固まってからでも考慮していただけたら嬉しく思います。</div></section>
    </li><li><section><h1 id=1135>
    <span class="no">[1135]</span>
    <a class="title" href="#1135">Re3:Commit報告(Fix): ツールバーの設定でプラグインのコマンドと「折返」が衝突</a>
    <span class="author">Uchi</span>
    <time datetime="2010-03-22T01:56:35">2010年03月22日 01:56</time></h1>
    <div class="body">▼ syatさん<br>&gt; ▼ Uchiさん<br>&gt; &gt; CMenuDrawer.cpp<br>&gt; &gt; ..\sakura_core\CMenuDrawer.cpp(538) : error C2065: 'F_TOOLBARWRAP' : 定義されていない識別子です。<br>&gt; &gt; のエラーが出て、コンパイルできませんでした。<br>&gt; すみません。ヘッダ自動生成されるのを忘れてました。なぜかビルド通ったので気付かなかった；<br>&gt; リビジョン1722で修正しています。<br><br>コンパイル、動作確認いたしました。<br><br>不具合というほどのものではないのですが、プラグインコマンドのデフォルトアイコンの右上と左上に小さな点が付いています。<br>何かの折に綺麗にしていただけたらと思います。</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></body></html>