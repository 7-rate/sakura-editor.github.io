<!DOCTYPE html><html><head><meta charset='utf-8'><title>お気に入り機能</title><link rel='stylesheet' href='bbs.css' /><script src='bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←ansiトップへ</a><li><div class="list-title">
    <span class="no">2671</span>
    <a class="title" href="2671.html#2671">お気に入り機能</a></div>
    <ul><li><div class="list-title">
    <span class="no">2672</span>
    <a class="title" href="2671.html#2672">RE: お気に入り機能</a></div>
    <ul><li><div class="list-title">
    <span class="no">2673</span>
    <a class="title" href="2671.html#2673">RE2: お気に入り機能</a></div>
    <ul><li><div class="list-title">
    <span class="no">2676</span>
    <a class="title" href="2671.html#2676">RE3: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    <ul><li><div class="list-title">
    <span class="no">2677</span>
    <a class="title" href="2671.html#2677">Re4: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    <ul><li><div class="list-title">
    <span class="no">2678</span>
    <a class="title" href="2671.html#2678">Re5: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    <ul><li><div class="list-title">
    <span class="no">2679</span>
    <a class="title" href="2671.html#2679">Re6: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    <ul><li><div class="list-title">
    <span class="no">2683</span>
    <a class="title" href="2671.html#2683">Re7: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    <ul><li><div class="list-title">
    <span class="no">2684</span>
    <a class="title" href="2671.html#2684">Re8: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    </li><li><div class="list-title">
    <span class="no">2685</span>
    <a class="title" href="2671.html#2685">Re8: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a></div>
    </li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">2692</span>
    <a class="title" href="2671.html#2692">ダイレクトタグジャンプ要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">2693</span>
    <a class="title" href="2671.html#2693">Re: ダイレクトタグジャンプ要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">2700</span>
    <a class="title" href="2671.html#2700">Re2: ダイレクトタグジャンプ要望</a></div>
    </li><li><div class="list-title">
    <span class="no">2701</span>
    <a class="title" href="2671.html#2701">Re2: ダイレクトタグジャンプ要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">2705</span>
    <a class="title" href="2671.html#2705">Re3: ダイレクトタグジャンプ要望</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">2737</span>
    <a class="title" href="2671.html#2737">RE: お気に入り機能</a></div>
    </li></ul></li></ul><ul class="main"><li><section><h1 id=2671>
    <span class="no">[2671]</span>
    <a class="title" href="#2671">お気に入り機能</a>
    <span class="author">みく</span>
    <time datetime="2003-04-08T22:01:26">2003年04月08日 22:01</time></h1>
    <div class="body"><br>実装してみました。→favorite20030408.zip<br>ssrc_2003-04-01 に対する差分です。<br>修正量が多いのでバグが取りきれてないと思いますので、バグ出し（要望もあれば）お願いします。<br><br>お気に入りには、最近使ったファイル・フォルダメニューにアイコンが付きます。<br>お気に入りの設定は「ツール」→「お気に入りの設定」で行います。<br>「最近使ったものリスト」がすべて新しいクラス経由に変わってます。<br>すべて（？）の「最近使ったものリスト」の履歴削除も補助機能として付けました。<br><br>＃誰かお気に入りアイコンを作っていただけると助かります。<br></div></section>
    <ul><li><section><h1 id=2672>
    <span class="no">[2672]</span>
    <a class="title" href="#2672">RE: お気に入り機能</a>
    <span class="author">みく</span>
    <time datetime="2003-04-09T10:06:05">2003年04月09日 10:06</time></h1>
    <div class="body"><br>→favorite20030409.zip<br><br>差分ファイルにビットマップファイルが入ってなかった。<br>リソースファイルに F_FAVORITE が追加されてなかった。<br>メニューアイコンを非表示にしたとき、お気に入りかどうかわからなかった。<br></div></section>
    <ul><li><section><h1 id=2673>
    <span class="no">[2673]</span>
    <a class="title" href="#2673">RE2: お気に入り機能</a>
    <span class="author">みく</span>
    <time datetime="2003-04-09T17:02:38">2003年04月09日 17:02</time></h1>
    <div class="body"><br>→favorite20030409a.zip<br><br>お気に入り設定画面にフォーカスが戻ったときの警告ダイアログの出方が変だった。<br>共通設定で履歴数を変更した直後に並べ替えが発生しなかった。<br>その他：開き直すにアイコンがなかった。<br></div></section>
    <ul><li><section><h1 id=2676>
    <span class="no">[2676]</span>
    <a class="title" href="#2676">RE3: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">みく</span>
    <time datetime="2003-04-13T17:12:07">2003年04月13日 17:12</time></h1>
    <div class="body"><br>favorite20030413.zip<br><br>・CDocLineMgr.cpp:FileWrite()の戻り値バグ修正<br>・CShareData.cppの初期化バグ修正<br>・CMRU.cppのソースちょこっと修正<br>・編集中ファイルのDIFF実装(Write時は共通関数を使用)<br>・ダイレクトタグジャンプの実装<br><br>タグジャンプの機能拡張として実装しましたので、<br>いままでのタグジャンプ（ファイル名、行番号形式）でタグジャンプできない<br>ときに、さらにダイレクトタグジャンプをしようとします。<br><br>タグファイルの作成にはctags.exeが必要です。<br>（sakura.exeと同じフォルダに置きます。）<br>私は、以下のプログラムで試しました。<br><br>Exuberant Ctags 日本語対応版 5.4J1<br>http://hp.vector.co.jp/authors/VA025040/<br><br>まず、検索メニュー→タグファイルの作成でタグファイルを作成します。<br>（カレントフォルダのみのタグファイルを作成します。）<br><br>手動で作成するときは、<br>ctags.exe --excmd=n -R *<br>のように指定してください。<br>（結果のタグファイルはソートされていること）<br><br>キーワード上でタグジャンプすると、定義位置へジャンプします。<br>複数のジャンプ先がある場合は、ダイアログが出ます。<br><br>タグファイルの検索はカレントフォルダのみですが、<br>プログラム内ではフォルダをさかのぼることができるようにしてますので、<br>必要な人は設定部分を実装してください。<br></div></section>
    <ul><li><section><h1 id=2677>
    <span class="no">[2677]</span>
    <a class="title" href="#2677">Re4: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">げんた</span>
    <time datetime="2003-04-14T02:55:30">2003年04月14日 02:55</time></h1>
    <div class="body">▼ みくさん<br>&gt; ・ダイレクトタグジャンプの実装<br>おおー、感激です。欲しかったんですよこれ。<br>まだ見てませんが(^^;)</div></section>
    <ul><li><section><h1 id=2678>
    <span class="no">[2678]</span>
    <a class="title" href="#2678">Re5: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">みく</span>
    <time datetime="2003-04-14T20:40:58">2003年04月14日 20:40</time></h1>
    <div class="body">&gt;タイトル: Re5: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他<br>&gt;発言者: げんた<br>&gt;▼ みくさん<br>&gt;&gt; ・ダイレクトタグジャンプの実装<br>&gt;おおー、感激です。欲しかったんですよこれ。<br>&gt;まだ見てませんが(^^;)<br><br>私も欲しかったものですから。。。<br><br>一応、今回の機能拡張はこれくらいです。<br>バグ報告等お待ちしております。<br><br>質問：<br>タグジャンプCEditView_Command.cpp:Command_TAGJUMP():6562行目<br>（パッチ当てる前のソースの行数です）でカーソル位置を計算しています。<br>他のファイルにタグジャンプしたときの計算をカレントファイルで<br>やってるような気がするのですが。<br><br>質問：<br>開くダイアログの「ファイルの種類リスト」ですが、<br>現在は埋め込みとなっています。これって、<br>タイプ別設定から拾ってきたほうがいいと思うのですが<br>どうでしょうか。<br>＃私は "すべて *.*" しか使わないですけど。<br></div></section>
    <ul><li><section><h1 id=2679>
    <span class="no">[2679]</span>
    <a class="title" href="#2679">Re6: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">みく</span>
    <time datetime="2003-04-15T19:17:51">2003年04月15日 19:17</time></h1>
    <div class="body"><br>バグ修正→favorite20030415.zip<br><br>・カーソル位置が保存されなくなっていたのを修正。<br>・タグファイル作成中のメッセージと、終了ダイアログを表示するように。<br>・タグ一覧で選びそうなキーに初期カーソルを合わせるように。<br>・タグのビットマップを若干修正。→誰かきれいなアイコンをお願いします。<br>・makefileにCDlgTagJumpList.objを追加。<br>・MessageBox→MYMESSAGEBOX。<br></div></section>
    <ul><li><section><h1 id=2683>
    <span class="no">[2683]</span>
    <a class="title" href="#2683">Re7: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">みく</span>
    <time datetime="2003-04-17T12:45:00">2003年04月17日 12:45</time></h1>
    <div class="body"><br>→favorite20030417.zip<br><br>・正規表現の置換で選択位置挿入を動作するように<br>・ダイレクトタグジャンプをメニューに入れた<br><br>→help_src_20030417.zip<br>変更・追加のあったファイルしかありませんので、古いファイルを展開してそこに上書きしてください。<br><br>・欠けていた部分を作成<br>・今回追加になった部分を追加<br><br>以下は未作成です。<br>HLP000177<br>HLP000217<br>HLP000244<br>HLP000278<br>HLP000303<br>HLP000304<br>HLP000011<br></div></section>
    <ul><li><section><h1 id=2684>
    <span class="no">[2684]</span>
    <a class="title" href="#2684">Re8: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">すい</span>
    <time datetime="2003-04-18T12:48:15">2003年04月18日 12:48</time></h1>
    <div class="body">みくさん家(http://www.geocities.co.jp/SiliconValley-SanJose/3299/) に<br>バイナリ(s20030417try.zip)が出ていたので早速試して見ましたが．．．<br><br>改行の置換が正常に出来なくなっています。。<br><br>・置換前：[\r\n]+<br>・置換後：<br><br>の正規表現で [すべて置換(A)] すると、全ての改行が削除されるのが期待する<br>動作なのですが、あちこちに改行が残ってしまいます。<br>[すべて置換(A)] じゃなく [置換(R)] を繰り返した場合もおかしいですね。<br>しかも [すべて置換(A)] した場合と [置換(R)] を繰り返した場合とで<br>結果が異なるという。<br><br>ひょっとして<br>&gt; ・正規表現の置換で選択位置挿入を動作するように<br>あたりでしょうか？<br>だとすると、どういう方法で実装したのでしょうか？まだソース見ていないんですぅ。 m(_ _)m<br><br>単純に置換後文字列に $&amp; をくっつけてから DLL に渡すようにする、<br>とかじゃ駄目なのかな？（手抜き (;^^;) ）<br><br>・置換後：abc<br>なら<br>・始点に挿入 → abc$&amp;<br>・終点に挿入 → $&amp;abc<br>とか。<br></div></section>
    </li><li><section><h1 id=2685>
    <span class="no">[2685]</span>
    <a class="title" href="#2685">Re8: お気に入り機能、ダイレクトタグジャンプ、DIFF差分他</a>
    <span class="author">げんた</span>
    <time datetime="2003-04-21T04:10:58">2003年04月21日 04:10</time></h1>
    <div class="body">業務連絡です。<br><br>すいませんが、みくさんの4/17の変更をリポジトリに入れてしまったので、さらに変更されることがあるのであればそこからの差分でお願いします。<br><br>私の変更分とマージして次のバージョンにする予定ですが、衝突部分が多いので手で少しずつマージすることにします。ですので、ちょっと時間がかかりそうです。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=2692>
    <span class="no">[2692]</span>
    <a class="title" href="#2692">ダイレクトタグジャンプ要望</a>
    <span class="author">げんた</span>
    <time datetime="2003-04-25T01:25:41">2003年04月25日 01:25</time></h1>
    <div class="body">1.3.9.0でダイレクトタグジャンプ組み込みました。<br>で、早速要望です。<br><br>▼タグファイル作成<br>* ディレクトリ以下すべてを選択するオプション<br>実際のソースコードは複数ディレクトリに分かれていることが多いですからねぇ。<br><br>* 基準ディレクトリを指定したい<br>ディレクトリ以下すべてのtagsを作るときは作成場所を指定したいです。<br><br>* コマンドラインオプションを直接指定したい<br>MFCのマクロを解析対象外にするには-Iオプションを指定する必要があります。それをコマンドの中から指定できて、しかも前回のオプションを覚えてくれるといいなぁと。<br><br>▼タグジャンプ<br>ちょっと言語依存になってしまって気持ち悪いのですが、<br>A::foo, a-&gt;foo(), a.foo のように書かれているときにA/aの型情報(tagsより取得)を用いてfooの型を絞り込むことは難しいでしょうか。<br>＃よく考えたらaがローカル変数だとアウトですね。</div></section>
    <ul><li><section><h1 id=2693>
    <span class="no">[2693]</span>
    <a class="title" href="#2693">Re: ダイレクトタグジャンプ要望</a>
    <span class="author">げんた</span>
    <time datetime="2003-04-26T22:29:07">2003年04月26日 22:29</time></h1>
    <div class="body">&gt;実際のソースコードは複数ディレクトリに分かれていることが多いですからねぇ。<br>ディレクトリ以下すべてでダイレクトタグジャンプできると勘違いしていました。ですが、やはりディレクトリ全体サポートは欲しいです。<br><br>CEditDoc::GetFilePath()で得られるパス名が絶対パス名なのであれば、パス名からディレクトリの深さを計算して、ルートに行き着くまでtagsを探すという方針でどうでしょう？<br></div></section>
    <ul><li><section><h1 id=2700>
    <span class="no">[2700]</span>
    <a class="title" href="#2700">Re2: ダイレクトタグジャンプ要望</a>
    <span class="author">げんた</span>
    <time datetime="2003-05-01T01:37:00">2003年05月01日 01:37</time></h1>
    <div class="body">&gt;パス名からディレクトリの深さを計算して<br>という関数を作ってみました。<br><br>/*! @brief ディレクトリの深さを計算する<br><br>&#9;与えられたパス名からディレクトリの深さを計算する．<br>&#9;パスの区切りは\．ルートディレクトリが深さ0で，サブディレクトリ毎に<br>&#9;深さが1ずつ上がっていく．<br> <br>&#9;@param [in] path 深さを調べたいファイル/ディレクトリのフルパス<br><br>&#9;@date 2003.04.30 genta 新規作成<br>*/<br>int CalcDirectoryDepth(const char* path)<br>{<br>&#9;int depth = 0;<br> <br>&#9;//&#9;とりあえず\の数を数える<br>&#9;for( const char *p = path; *p != '\0'; ++p ){<br>&#9;&#9;//&#9;2バイト文字は区切りではない<br>&#9;&#9;if( _IS_SJIS_1(*(unsigned const char*)p)){ // unsignedにcastしないと判定を誤る<br>&#9;&#9;&#9;++p;<br>&#9;&#9;&#9;if( *p == '\0' )<br>&#9;&#9;&#9;&#9;break;<br>&#9;&#9;}<br>&#9;&#9;else if( *p == '\\' ){<br>&#9;&#9;&#9;++depth;<br>&#9;&#9;&#9;//&#9;フルパスには入っていないはずだが念のため<br>&#9;&#9;&#9;//&#9;.\はカレントディレクトリなので，深さに関係ない．<br>&#9;&#9;&#9;while( p[1] == '.' &amp;&amp; p[2] == '\\' ){<br>&#9;&#9;&#9;&#9;p += 2;<br>&#9;&#9;&#9;}<br>&#9;&#9;}<br>&#9;}<br> <br>&#9;//&#9;補正<br>&#9;//&#9;ドライブ名はパスの深さに数えない<br>&#9;if(( 'A' &lt;= (path[0] &amp; ~0x20)) &amp;&amp; ((path[0] &amp; ~0x20) &lt;= 'Z' ) &amp;&amp;<br>&#9;&#9;path[1] == ':' &amp;&amp; path[2] == '\\' ){<br>&#9;&#9;//フルパス<br>&#9;&#9;--depth; // C:\ の \ はルートの記号なので階層深さではない<br>&#9;}<br>&#9;else if( path[0] == '\\' ){<br>&#9;&#9;if( path[1] == '\\' ){<br>&#9;&#9;&#9;//&#9;ネットワークパス<br>&#9;&#9;&#9;//&#9;先頭の2つはネットワークを表し，その次はホスト名なので<br>&#9;&#9;&#9;//&#9;ディレクトリ階層とは無関係<br>&#9;&#9;&#9;depth -= 3;<br>&#9;&#9;}<br>&#9;&#9;else {<br>&#9;&#9;&#9;//&#9;ドライブ名無しのフルパス<br>&#9;&#9;&#9;//&#9;先頭の\は対象外<br>&#9;&#9;&#9;--depth;<br>&#9;&#9;}<br>&#9;}<br>&#9;return depth;<br>}<br></div></section>
    </li><li><section><h1 id=2701>
    <span class="no">[2701]</span>
    <a class="title" href="#2701">Re2: ダイレクトタグジャンプ要望</a>
    <span class="author">げんた</span>
    <time datetime="2003-05-01T01:39:19">2003年05月01日 01:39</time></h1>
    <div class="body">みくさんに質問<br>CEditView::Command_TagJumpByTagsFile()の中で<br><br>for( j = 0; j &lt; 2; j++ )<br>の2回ループは何を意図したものなんでしょう？<br>ファイル名の取得もループの内側にあって意図がよくわかりません。<br></div></section>
    <ul><li><section><h1 id=2705>
    <span class="no">[2705]</span>
    <a class="title" href="#2705">Re3: ダイレクトタグジャンプ要望</a>
    <span class="author">みく</span>
    <time datetime="2003-05-01T10:57:03">2003年05月01日 10:57</time></h1>
    <div class="body"><br>&gt;の2回ループは何を意図したものなんでしょう？<br><br>ループは1回させてないので、今となっては意味がありません。<br><br>ループの終わりのところのコメントアウトを見ればわかりますが、<br>tagsファイルがなかったときに自動生成させてもう一回処理させようとしていたのです。<br>でも、余計なお世話になるのでやめました。<br>きれいに消してもらっても結構です。<br><br>バグ：<br>同一タグが１００個以上あるとき、リストに出るメッセージがカーソル位置に挿入されてしまいます。<br>（多分そんなに同一タグがあることはないと思うけど）<br>その結果、そのメッセージ以降のタグでのタグジャンプが正しくありません（一個ずれる）。<br>CDlgTagJump.cpp:210～221行の処理ブロックを203行の前に移動しないといけません。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=2737>
    <span class="no">[2737]</span>
    <a class="title" href="#2737">RE: お気に入り機能</a>
    <span class="author">みく</span>
    <time datetime="2003-05-13T19:05:40">2003年05月13日 19:05</time></h1>
    <div class="body"><br>&gt;すべて（？）の「最近使ったものリスト」の履歴削除も補助機能として付けました。<br><br>お気に入りは残して履歴を削除するパターンも欲しいと思いました。<br></div></section>
    </li></ul></li></ul></body></html>