<!DOCTYPE html><html><head><meta charset='utf-8'><title>sakura_2002-02-23.zip</title><link rel='stylesheet' href='../bbs.css' /><script src='../bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←ANSI版開発トップへ</a><li><div class="list-title">
    <span class="no">1648</span>
    <a class="title" href="1648.html#1648">sakura_2002-02-23.zip</a></div>
    <ul><li><div class="list-title">
    <span class="no">1655</span>
    <a class="title" href="1648.html#1655">Re:sakura_2002-02-23.zip</a></div>
    <ul><li><div class="list-title">
    <span class="no">1658</span>
    <a class="title" href="1648.html#1658">Re2:sakura_2002-02-23.zip</a></div>
    <ul><li><div class="list-title">
    <span class="no">1659</span>
    <a class="title" href="1648.html#1659">Re2:sakura_2002-02-23.zip</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">1665</span>
    <a class="title" href="1648.html#1665">Re2:sakura_2002-02-23.zip</a></div>
    <ul><li><div class="list-title">
    <span class="no">1666</span>
    <a class="title" href="1648.html#1666">Re3:sakura_2002-02-23.zip</a></div>
    </li><li><div class="list-title">
    <span class="no">1671</span>
    <a class="title" href="1648.html#1671">うぬ～、わからん</a></div>
    <ul><li><div class="list-title">
    <span class="no">1677</span>
    <a class="title" href="1648.html#1677">もしかして...</a></div>
    <ul><li><div class="list-title">
    <span class="no">1678</span>
    <a class="title" href="1648.html#1678">RE: もしかして...</a></div>
    <ul><li><div class="list-title">
    <span class="no">1684</span>
    <a class="title" href="1648.html#1684">Re2: もしかして...</a></div>
    <ul><li><div class="list-title">
    <span class="no">1693</span>
    <a class="title" href="1648.html#1693">Re3: もしかして...</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=1648>
    <span class="no">[1648]</span>
    <a class="title" href="#1648">sakura_2002-02-23.zip</a>
    <span class="author">やざき</span>
    <time datetime="2002-02-23T09:11:29">2002年02月23日 09:11</time></h1>
    <div class="body">アップロードしました。<br><br>・horさんのssrc_2002-02-11_p1まで取り込み<br><br>・CShareDataのインスタンスを作ることが許されるのはCProcessのみ。<br>　ほかの場所では、getInstanceするように変更。<br>　→新しくかかわった人がわかりやすいように。<br><br>・上のとあわせて、GetShareDataから、ドキュメントタイプを返す部分を取りはずして、<br>　GetDocumentTypeとした。<br><br>・マクロにファイル系を追加。<br>　- S_FileCloseOpenだけ未。どなたか～。<br>　S_FileSaveAs(ファイル名, 文字コード, 改行コード)<br>　ファイル名：<br>　　　きっとフルパス。<br>　文字コード：<br>　　　0:SJIS<br>　　　1:JIS<br>　　　2:EUC<br>　　　3:Unicode<br>　　　4:UTF-8<br>　　　5:UTF-7<br>　改行コード：<br>　　　0:変換なし<br>　　　1:CR+LF<br>　　　2:LF(UNIX)<br>　　　3:CR(Mac)<br><br>・存在しないマクロを呼んだときにエラーがでるように。<br><br>・プリンタを選択できるように。<br><br>・CPrintからできるかぎりstaticをはずす。<br><br>・起動時にプリンタを探しに行かないように。<br><br>といったところでしょうか。</div></section>
    <ul><li><section><h1 id=1655>
    <span class="no">[1655]</span>
    <a class="title" href="#1655">Re:sakura_2002-02-23.zip</a>
    <span class="author">げんた</span>
    <time datetime="2002-02-26T01:24:56">2002年02月26日 01:24</time></h1>
    <div class="body">共通設定－バックアップを選ぶと、自動的に「フォルダの選択ダイアログボックス」が出てきてしまいます。<br><br>こんなところ変更したっけ？(@_@)はて？<br></div></section>
    <ul><li><section><h1 id=1658>
    <span class="no">[1658]</span>
    <a class="title" href="#1658">Re2:sakura_2002-02-23.zip</a>
    <span class="author">やざき</span>
    <time datetime="2002-02-26T10:01:28">2002年02月26日 10:01</time></h1>
    <div class="body">▼ げんたさん<br>&gt; 共通設定－バックアップを選ぶと、自動的に「フォルダの選択ダイアログボックス」が出てきてしまいます。<br>&gt; <br>&gt; こんなところ変更したっけ？(@_@)はて？<br><br>あれれ。手元では出てこないなぁ。何かオプションに関係あったりします？<br><br>一般のほうで言われている上書き保存などの件は、マクロを実装するのに確かにいじっていたんだけど、<br>フォルダの選択ダイアログを出す／出さないはいじってない気がするなぁ。</div></section>
    <ul><li><section><h1 id=1659>
    <span class="no">[1659]</span>
    <a class="title" href="#1659">Re2:sakura_2002-02-23.zip</a>
    <span class="author">げんた</span>
    <time datetime="2002-02-26T10:42:04">2002年02月26日 10:42</time></h1>
    <div class="body">&gt;あれれ。手元では出てこないなぁ。何かオプションに関係あったりします？<br>&gt;<br>&gt;一般のほうで言われている上書き保存などの件は、マクロを実装するのに確かにいじっていたんだけど、<br>&gt;フォルダの選択ダイアログを出す／出さないはいじってない気がするなぁ。<br>別のマシンでは出ませんでした．iniファイルが無い場合も出ません．<br>ということは，設定に依るのかも．昔からあった潜在的な問題かもしれません．<br>調べてみます．<br></div></section>
    </li></ul></li><li><section><h1 id=1665>
    <span class="no">[1665]</span>
    <a class="title" href="#1665">Re2:sakura_2002-02-23.zip</a>
    <span class="author">げんた</span>
    <time datetime="2002-02-27T02:01:22">2002年02月27日 02:01</time></h1>
    <div class="body">▼ げんたさん<br>&gt; 共通設定－バックアップを選ぶと、自動的に「フォルダの選択ダイアログボックス」が出てきてしまいます。<br>Windows XPでsakura.exe.manifestファイルを同じフォルダに置いている場合にのみ再現します。<br><br>ダイアログは一定時間ごとに何枚でも出てくるようです。</div></section>
    <ul><li><section><h1 id=1666>
    <span class="no">[1666]</span>
    <a class="title" href="#1666">Re3:sakura_2002-02-23.zip</a>
    <span class="author">やざき</span>
    <time datetime="2002-02-27T08:15:54">2002年02月27日 08:15</time></h1>
    <div class="body">▼ げんたさん<br>&gt; ▼ げんたさん<br>&gt; &gt; 共通設定－バックアップを選ぶと、自動的に「フォルダの選択ダイアログボックス」が出てきてしまいます。<br>&gt; Windows XPでsakura.exe.manifestファイルを同じフォルダに置いている場合にのみ再現します。<br>&gt; <br>&gt; ダイアログは一定時間ごとに何枚でも出てくるようです。<br><br>うぬぅ。それは降参。<br>XPあるけど、インストールできなかったので(←せっかく買ったのに。と、怒っている。)<br></div></section>
    </li><li><section><h1 id=1671>
    <span class="no">[1671]</span>
    <a class="title" href="#1671">うぬ～、わからん</a>
    <span class="author">げんた</span>
    <time datetime="2002-03-01T01:58:22">2002年03月01日 01:58</time></h1>
    <div class="body">▼ げんたさん<br>&gt; Windows XPでsakura.exe.manifestファイルを同じフォルダに置いている場合にのみ再現<br>謎謎謎です。<br><br>勝手に出てくるフォルダを選択してOKを押すとバックアップ先がそこに設定されるので、CPropComBackup.cppの197行目付近を通っていることは間違いない。<br><br>ソースをどう読んでもuMsg==WM_COMMAND &amp;&amp; wNotifyCode==BN_CLICKED &amp;&amp; wID == IDC_BUTTON_BACKUP_FOLDER_REF以外のルートでここに来ることは無いのだが、SPY++でWM_COMMANDを監視してもそれらしきものは引っかからない。<br><br>参照ボタンがEnable/Disableされるとウィンドウが出てくるようだ。<br></div></section>
    <ul><li><section><h1 id=1677>
    <span class="no">[1677]</span>
    <a class="title" href="#1677">もしかして...</a>
    <span class="author">げんた</span>
    <time datetime="2002-03-02T02:25:43">2002年03月02日 02:25</time></h1>
    <div class="body">CPropComBackup.cppを131行目WM_NOTIFYのところからたどってみると、<br><br>switch( idCtrl )でdefaultに入り、その中のswitch( pNMHDR-&gt;code )で３つの条件のどれにも引っかからなかった場合にWM_NOTIFYに対応するbreakが抜けているためにWM_COMMANDに落ちてしまいます。<br><br>Windows XPでWM_NOTIFYのメッセージが何か追加されてこのルートを通るようになったのかもしれない。<br>そして、コントロールIDがIDC_BUTTON_BACKUP_FOLDER_REFだとめでたくダイアログボックスが表示される、と。<br><br>未確認ですが、WM_COMMAND直前にbreak;と書けば直るような気がします。</div></section>
    <ul><li><section><h1 id=1678>
    <span class="no">[1678]</span>
    <a class="title" href="#1678">RE: もしかして...</a>
    <span class="author">みく</span>
    <time datetime="2002-03-02T09:12:33">2002年03月02日 09:12</time></h1>
    <div class="body"><br>...という視点で見てみると、以下の場所もまずいです。<br><br>CPropComFile.cpp:183<br>CPropComWin.cpp:193<br>CPropTypesRegex.cpp:100,105<br></div></section>
    <ul><li><section><h1 id=1684>
    <span class="no">[1684]</span>
    <a class="title" href="#1684">Re2: もしかして...</a>
    <span class="author">やざき</span>
    <time datetime="2002-03-04T01:00:50">2002年03月04日 01:00</time></h1>
    <div class="body">▼ みくさん<br>&gt; CPropComFile.cpp:183<br>&gt; CPropComWin.cpp:193<br>&gt; CPropTypesRegex.cpp:100,105<br><br>break;入れてみました。</div></section>
    <ul><li><section><h1 id=1693>
    <span class="no">[1693]</span>
    <a class="title" href="#1693">Re3: もしかして...</a>
    <span class="author">げんた</span>
    <time datetime="2002-03-05T01:10:59">2002年03月05日 01:10</time></h1>
    <div class="body">▼ やざきさん<br>&gt; break;入れてみました。<br>直りました！</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>