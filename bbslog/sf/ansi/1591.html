<!DOCTYPE html><html><head><meta charset='utf-8'><title>INIファイルの強調キーワード</title><link rel='stylesheet' href='bbs.css' /><script src='bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←ANSI版開発トップへ</a><li><div class="list-title">
    <span class="no">1591</span>
    <a class="title" href="1591.html#1591">INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1601</span>
    <a class="title" href="1591.html#1601">Re:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1602</span>
    <a class="title" href="1591.html#1602">Re2:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1608</span>
    <a class="title" href="1591.html#1608">Re2:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1609</span>
    <a class="title" href="1591.html#1609">Re2:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1619</span>
    <a class="title" href="1591.html#1619">Re3:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1620</span>
    <a class="title" href="1591.html#1620">Re:INIファイルの強調キーワード</a></div>
    <ul><li><div class="list-title">
    <span class="no">1621</span>
    <a class="title" href="1591.html#1621">Re2:INIファイルの強調キーワード</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=1591>
    <span class="no">[1591]</span>
    <a class="title" href="#1591">INIファイルの強調キーワード</a>
    <span class="author">hor</span>
    <time datetime="2002-02-14T13:36:26">2002年02月14日 13:36</time></h1>
    <div class="body">CShareDataの構造が変わったとき<br>新exeで旧iniを読み込むと強調キーワード(だけ？)が壊れます。<br><br>みなさんはこんな現象でませんか？</div></section>
    <ul><li><section><h1 id=1601>
    <span class="no">[1601]</span>
    <a class="title" href="#1601">Re:INIファイルの強調キーワード</a>
    <span class="author">あろか</span>
    <time datetime="2002-02-14T22:08:23">2002年02月14日 22:08</time></h1>
    <div class="body">▼ horさん<br>&gt; CShareDataの構造が変わったとき<br>&gt; 新exeで旧iniを読み込むと強調キーワード(だけ？)が壊れます。<br>&gt; <br>&gt; みなさんはこんな現象でませんか？<br>こちらでも出ています。少し前からでているようです。<br></div></section>
    <ul><li><section><h1 id=1602>
    <span class="no">[1602]</span>
    <a class="title" href="#1602">Re2:INIファイルの強調キーワード</a>
    <span class="author">hor</span>
    <time datetime="2002-02-14T23:57:00">2002年02月14日 23:57</time></h1>
    <div class="body">▼ あろかさん<br>&gt; ▼ horさん<br>&gt; &gt; CShareDataの構造が変わったとき<br>&gt; &gt; 新exeで旧iniを読み込むと強調キーワード(だけ？)が壊れます。<br>&gt; &gt; <br>&gt; &gt; みなさんはこんな現象でませんか？<br>&gt; こちらでも出ています。少し前からでているようです。<br><br>REG_MULTI_SZ 周辺だとは思うのですが・・・私にはさっぱりです。<br>どなたか修正していただけますでしょうか？</div></section>
    <ul><li><section><h1 id=1608>
    <span class="no">[1608]</span>
    <a class="title" href="#1608">Re2:INIファイルの強調キーワード</a>
    <span class="author">みく</span>
    <time datetime="2002-02-16T09:25:16">2002年02月16日 09:25</time></h1>
    <div class="body">&gt;タイトル: Re2:INIファイルの強調キーワード<br>&gt;発言者: hor<br>&gt;▼ あろかさん<br>&gt;&gt; ▼ horさん<br>&gt;&gt; &gt; CShareDataの構造が変わったとき<br>&gt;&gt; &gt; 新exeで旧iniを読み込むと強調キーワード(だけ？)が壊れます。<br>&gt;&gt; &gt; <br>&gt;&gt; &gt; みなさんはこんな現象でませんか？<br>&gt;&gt; こちらでも出ています。少し前からでているようです。<br><br>私もたまにあります。<br><br>&gt;REG_MULTI_SZ 周辺だとは思うのですが・・・私にはさっぱりです。<br>&gt;どなたか修正していただけますでしょうか？<br><br>CShareData_new.cpp:790行、CProfile.cpp:306行<br>pszMem = new char[MAX_SETNUM * MAX_KEYWORDNUM * ( MAX_KEYWORDLEN ) + 1];<br>のMAX_SETNUMはよくわかりませんが、キーワードのセパレータを考慮してないので、<br>その分不足するのではないでしょうか。(MAX登録してないので大丈夫とは思う)<br><br>それよりも、793行目でnMemLenを取得した後に必要なバッファサイズを確保した<br>ほうが確実だと思います。<br><br><br>あと、CProfile.cpp:336で1バイトだけクリアしてますが、後の処理でmemcpyを<br>使うところがあり0で終端させる処理がないので初期化するなら全エリア0クリア<br>しないと危険です。<br>メモリにごみがあるときにキーワードが壊れるんではないでしょうか。<br></div></section>
    <ul><li><section><h1 id=1609>
    <span class="no">[1609]</span>
    <a class="title" href="#1609">Re2:INIファイルの強調キーワード</a>
    <span class="author">みく</span>
    <time datetime="2002-02-16T09:57:32">2002年02月16日 09:57</time></h1>
    <div class="body"><br>&gt;あと、CProfile.cpp:336で1バイトだけクリアしてますが、後の処理でmemcpyを<br>&gt;使うところがあり0で終端させる処理がないので初期化するなら全エリア0クリア<br>&gt;しないと危険です。<br>&gt;メモリにごみがあるときにキーワードが壊れるんではないでしょうか。<br><br>bReadのときは、memcpyする前に呼び元が用意したバッファを全クリア<br>するのが確実です。<br><br>呼び元が要求したデータサイズを強制的にmemcpyしていますが、CProfile<br>が持っているデータのほうが短ければ範囲外をリードしてしまいます。<br><br>もう一個、キーワードセットがiniファイルの文字列の中で一番長いと思って<br>szValueStrバッファを確保していますが、要求がそのバッファサイズを超えるか<br>どうかは未チェックのような。<br></div></section>
    <ul><li><section><h1 id=1619>
    <span class="no">[1619]</span>
    <a class="title" href="#1619">Re3:INIファイルの強調キーワード</a>
    <span class="author">hor</span>
    <time datetime="2002-02-18T15:40:06">2002年02月18日 15:40</time></h1>
    <div class="body">メモ帳でINIファイルを開いてそのまま上書保存するだけで強調キーワードが壊れました…</div></section>
    <ul><li><section><h1 id=1620>
    <span class="no">[1620]</span>
    <a class="title" href="#1620">Re:INIファイルの強調キーワード</a>
    <span class="author">げんた</span>
    <time datetime="2002-02-18T16:11:50">2002年02月18日 16:11</time></h1>
    <div class="body">&gt;メモ帳でINIファイルを開いてそのまま上書保存するだけで強調キーワードが壊れました…<br>キーワードの区切りに\0を使っていますからねぇ．「普通」のテキストファイルしか扱えないようなら壊れるでしょうね．<br><br>バイナリはBase64エンコードするとかした方が良いのでしょうけど．<br></div></section>
    <ul><li><section><h1 id=1621>
    <span class="no">[1621]</span>
    <a class="title" href="#1621">Re2:INIファイルの強調キーワード</a>
    <span class="author">hor</span>
    <time datetime="2002-02-18T17:00:39">2002年02月18日 17:00</time></h1>
    <div class="body">▼ げんたさん<br>&gt; &gt;メモ帳でINIファイルを開いてそのまま上書保存するだけで強調キーワードが壊れました…<br>&gt; キーワードの区切りに\0を使っていますからねぇ．「普通」のテキストファイルしか扱えないようなら壊れるでしょうね．<br><br>なるほど・・・失礼しました。(メモ帳で編集できるようになったらうれしいです)<br><br>この件と旧バージョンのINIファイルを新バイナリで読んだら強調キーワードが壊れる場合がある件とは無関係ってことで、<br>引き続きどなたか修正していただけることを期待しています。</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>