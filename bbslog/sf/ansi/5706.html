<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="favicon.ico">
  <title>英語版 (求むreviwer) | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀ANSI版開発トップへ</a>
        <li><div class="list-title">
    <span class="no">5706</span>
    <a class="thread-title" href="5706.html#5706">英語版 (求むreviwer)</a></div>
    <ul><li><div class="list-title">
    <span class="no">5707</span>
    <a class="thread-title" href="5706.html#5707">Re:英語版 (求むreviwer)</a></div>
    <ul><li><div class="list-title">
    <span class="no">5708</span>
    <a class="thread-title" href="5706.html#5708">Re2:英語版 (求むreviwer)</a></div>
    <ul><li><div class="list-title">
    <span class="no">5709</span>
    <a class="thread-title" href="5706.html#5709">Re3:英語版 (求むreviwer)</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5713</span>
    <a class="thread-title" href="5706.html#5713">Re:英語版 (求むreviwer)</a></div>
    </li><li><div class="list-title">
    <span class="no">5714</span>
    <a class="thread-title" href="5706.html#5714">Re:英語版 (求むreviwer)</a></div>
    <ul><li><div class="list-title">
    <span class="no">5715</span>
    <a class="thread-title" href="5706.html#5715">Re2:英語版 (求むreviwer)</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5716</span>
    <a class="thread-title" href="5706.html#5716">リソースの外部DLL化</a></div>
    <ul><li><div class="list-title">
    <span class="no">5717</span>
    <a class="thread-title" href="5706.html#5717">Re:リソースの外部DLL化</a></div>
    </li><li><div class="list-title">
    <span class="no">5718</span>
    <a class="thread-title" href="5706.html#5718">Re:リソースの外部DLL化（req53に在る模様）</a></div>
    </li><li><div class="list-title">
    <span class="no">5719</span>
    <a class="thread-title" href="5706.html#5719">Re:リソースの外部DLL化</a></div>
    </li><li><div class="list-title">
    <span class="no">5720</span>
    <a class="thread-title" href="5706.html#5720">Re:リソースの外部DLL化</a></div>
    <ul><li><div class="list-title">
    <span class="no">5721</span>
    <a class="thread-title" href="5706.html#5721">Re2:リソースの外部DLL化</a></div>
    </li><li><div class="list-title">
    <span class="no">5722</span>
    <a class="thread-title" href="5706.html#5722">Re2:リソースの外部DLL化</a></div>
    <ul><li><div class="list-title">
    <span class="no">5723</span>
    <a class="thread-title" href="5706.html#5723">Re3:リソースの外部DLL化</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5724</span>
    <a class="thread-title" href="5706.html#5724">Re:リソースの外部DLL化</a></div>
    </li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=5706>
    <span class="no">[5706]</span>
    <a class="thread-title" href="#5706">英語版 (求むreviwer)</a>
    <span class="author">げんた</span>
    <time datetime="2011-03-05T18:14:42">2011年03月05日 18:14</time></h1>
    <div class="body">Lucien さんが，サクラエディタの英語版を作ってくれました．<br>内容としては 1.6.6.0を英語化したものになっています．<br><br>ソースは以下のブランチに格納されています．<br>/sakura/branches/english/<br><br>手法としては埋め込まれている文字列を全てリソースに追い出して<br>LoadStringで読み出しています．<br>とりあえずはバグ，ロジック，翻訳等何でも結構ですので，<br>コメントをお願いします．<br><br>あと，リソースには日本語・英語の両方が入っているのですが，<br>扱いをどうしましょうかね...<br><br>さらに，Unicode版にも着手したいとの希望なのですが，<br>この方法でUnicode版に統合する形で入れられますかね？<br>いかがでしょうか．<br></div></section>
    <ul><li><section><h1 id=5707>
    <span class="no">[5707]</span>
    <a class="thread-title" href="#5707">Re:英語版 (求むreviwer)</a>
    <span class="author">ryoji</span>
    <time datetime="2011-03-05T23:54:08">2011年03月05日 23:54</time></h1>
    <div class="body">▼ げんたさん<br>&gt; あと，リソースには日本語・英語の両方が入っているのですが，<br>&gt; 扱いをどうしましょうかね...<br>&gt; <br>&gt; さらに，Unicode版にも着手したいとの希望なのですが，<br>&gt; この方法でUnicode版に統合する形で入れられますかね？<br>&gt; いかがでしょうか．<br><br>リソースで言語切替する手法は定石的なものですし、Unicode版でも可能なんじゃないかと思います。<br>欲しいですし、頑張って統合（日英一本化）に持ち込んでもらえたらいいなぁ～、と思います。その「頑張る」ってのがたいへんそうで、逃げ腰になっちゃいますが。<br>σ(^^;;;</div></section>
    <ul><li><section><h1 id=5708>
    <span class="no">[5708]</span>
    <a class="thread-title" href="#5708">Re2:英語版 (求むreviwer)</a>
    <span class="author">げんた</span>
    <time datetime="2011-03-06T11:25:38">2011年03月06日 11:25</time></h1>
    <div class="body">&gt;▼ げんたさん<br>&gt;&gt; あと，リソースには日本語・英語の両方が入っているのですが，<br>&gt;&gt; 扱いをどうしましょうかね... <br>&gt;&gt; <br>&gt;&gt; さらに，Unicode版にも着手したいとの希望なのですが，<br>&gt;&gt; この方法でUnicode版に統合する形で入れられますかね？<br>&gt;&gt; いかがでしょうか．<br>&gt;<br>&gt;リソースで言語切替する手法は定石的なものですし、Unicode版でも可能なんじゃないかと思います。<br>&gt;欲しいですし、頑張って統合（日英一本化）に持ち込んでもらえたらいいなぁ～、と思います。<br>がんばる部分は協力してくれるとのことですので甘えるとして，たぶんかなりの箇所に同じような変更がばらまかれることになりますので予め「こうして欲しい」というところを伝えておいた方が良いかと思います．<br>というのもあって，ANSI版をとりあえず見ていただけたらなと思ったのですが．<br><br>ANSI版の変更点で言うと，例えば<br>* LoadStringを含めて関数(or マクロ)にするべき？<br>  メッセージ表示も実はMYMESSAGEBOXを使っているところもあればwsprintfのところもあったりしてバラバラ．<br>* 文字列用バッファは256文字固定でその都度取っているが...<br>* SetThreadLocale, SetThreadUILanguage (Windows 95/98ではどちらも使えないのですね)<br>SetThreadLocaleを使って言語自体を切り替えるより，FindResourceExで取得したハンドルをLoadStringに渡した方がいいのでしょうか．今はGetModuleHandle(NULL)が毎回呼ばれていますが，これだとリソースの外部DLL化に対応できませんよね．<br><br>あと，実際に着手するとしても UNICODE版は頻繁に変更が入っているので，うまく協調してできるかが心配です．<br></div></section>
    <ul><li><section><h1 id=5709>
    <span class="no">[5709]</span>
    <a class="thread-title" href="#5709">Re3:英語版 (求むreviwer)</a>
    <span class="author">ryoji</span>
    <time datetime="2011-03-06T13:55:07">2011年03月06日 13:55</time></h1>
    <div class="body">&gt; あと，実際に着手するとしても UNICODE版は頻繁に変更が入っているので，うまく協調してできるかが心配です．<br>自分はこのところV2（UNICODE版）本体を正式版にする作業で手一杯で、もともとこのあたりで一休みのつもりでいました。簡単に修正可能なバグくらいは対応するつもりではいましたけど。<br>日英統合自体には賛成ですので、それまでの間、それ以外の修正はパッチとして保留しておいて、しばらく凍結（コミット禁止）、ということになってもいいです、はい。その際にひとこと号令かけていただければ。(^^)<br>＃むしろ明確に止めていただいたほうが気持ちの切替えはしやすいです</div></section>
    </li></ul></li></ul></li><li><section><h1 id=5713>
    <span class="no">[5713]</span>
    <a class="thread-title" href="#5713">Re:英語版 (求むreviwer)</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-03-07T00:25:02">2011年03月07日 00:25</time></h1>
    <div class="body">▼ げんたさん<br>とりあえずビルドしてみました。<br><br>VC6, VS2005EE でビルドエラー<br>　SetThreadUILanguage() が無い<br><br>BCC5.5.1 でビルドエラー<br>　Error sakura_rc_jp.rc 135 34: Expecting BEGIN<br><br>VS2008EE ビルド正常終了<br>　日本語 Windows XP SP2で起動テスト<br>　　地域と言語：日本語<br>　　　英語メニューで正常に動作<br><br>　　地域と言語：英語（米国）<br>　　　sakura.exeのみだと起動しない<br>---------------------------<br>sakura<br>---------------------------<br>\'D:\_MyWork\???????\sakura.exe\'<br>???????????????<br>?????????????????????? ???????????????<br>---------------------------<br><br>　　　ビルドしたReleaseフォルダで起動すると日本語メニューで立ち上がる（なぜ？）<br><br>&gt; あと，リソースには日本語・英語の両方が入っているのですが，<br>&gt; 扱いをどうしましょうかね...<br><br>sakura_english.exeの時は英語メニューとか (^^; 間に合うのかな？<br>ビルド環境とWin9x,NTの扱いをどうするかもあるので、ANSI版は英語メニュー版として別にしておいた方が良いかも？<br><br>ではでは。<br></div></section>
    </li><li><section><h1 id=5714>
    <span class="no">[5714]</span>
    <a class="thread-title" href="#5714">Re:英語版 (求むreviwer)</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-03-21T11:08:32">2011年03月21日 11:08</time></h1>
    <div class="body">メニューまわりを見てみました。英語が話せるわけではないので、その辺は割り引いてください (^^;<br><br>■タイプ別設定、共通設定<br>全体的にフィールドやボタンの幅が足りなくて文字列が表示しきれない所が見られるため保留。<br><br>■メニュー<br>メニュー全体について<br>　メニュー文字列の末尾にアクセスキーがある場合、文字列とアクセスキーの間にスペースがあった方が見やすいと思う（現在はスペースの有無が混在している）<br>　　「Save all (Z)」　OK<br>　　「Close Untitled(R)」→「Close Untitled (R)」<br><br>　文字列の途中にアクセスキーがあるメニューで()が付いていたり大文字にしてある所があるが、()は無しで無理に大文字にしない方が見やすいと思う。<br>　　「Close all (O)ther tabs」→「Close all other tabs」<br>　　「Move to neXt group」→「Move to next group」<br><br>　ダイアログが表示されるメニューで文字列末尾に「...」の無いものがある、またはその逆。<br>　　「Save As」→「Save As...」<br>　　「Open C/C++ header with same name...」→「Open C/C++ header with same name」<br><br>Fileメニュー<br>　「Save As」：「名前を付けて保存(A)...」<br>　　→「Save As...」（...を付ける）<br><br>　「Save\Close」：「保存して閉じる(E)」<br>　　円マークは &amp; の誤り？<br>　　→「Save&amp;Close」または「Save &amp; Close」または「Save and Close」<br><br>　「Re-open With encoding」：「開き直す(W)」<br>　　サブニューが「Re-open」「Re-Open」混在している。どちらかに統一。<br><br>Editメニュー<br>　「High Level Editing」：「高度な操作(V)」<br>　　改行単位と折り返し単位が表現できていない（難しいので無くても良い？）<br><br>　　「Copy selected line nr.(:)」：「選択範囲内全行番号付きコピー(:)」<br>　　　英語では番号の略語は「No.」の方が一般的な気がする。日本人にも分かりやすいです。<br>　　　「nr.」はオランダ・デンマークとかのヨーロッパ語な感じ？<br><br>　「Cursor Movement」：「移動(O)」<br>　　「End of file(Z)」：「ファイルの最後に移動(B)」<br>　　　→「End of file (B)」（アクセスキーの誤り）<br><br>　　「Jump to Line」：「指定行へジャンプ(J)...」<br>　　　→「Jump to Line...」<br><br>　　「Jump to Initial search start position」：「検索開始位置へ戻る(I)」<br>　　　Initialが無しの「Jump to search start position (I)」でも良い気がする。<br><br>　「Cosmetik」：「整形(K)」<br>　　英語としては「Cosmetic」の方が違和感がないけどkで正しい？<br>　　「Trimmng (K)」ではどうでしょうか。<br><br>Convertメニュー<br>　「Full Height」「Half Height」<br>　　Height→Width だと思う。<br><br>　「Change Encoding」<br>　　「Base64 Decode and save」→「Base64 Decode and Save」<br>　　「uudecode and save」→「uudecode and Save」<br>　　　saveの先頭を大文字にした方が良いと思ったけど、他のメニューを見ると選択に迷う (^^;<br><br>（つづく）<br></div></section>
    <ul><li><section><h1 id=5715>
    <span class="no">[5715]</span>
    <a class="thread-title" href="#5715">Re2:英語版 (求むreviwer)</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-03-21T11:09:19">2011年03月21日 11:09</time></h1>
    <div class="body">（つづき）<br><br>Searchメニュー<br>　「Find」：「検索(F)...」<br>　　→「Find...」<br><br>　「Replace」：「置換(R)...」<br>　　→「Replace...」<br><br>　「Jump to Initial search start position」：「検索開始位置へ戻る(I)」<br>　　Initialが無しの「Jump to search start position(I)」でも良い気がする。<br>　　（Editのサブメニューにも存在）<br><br>　「Open C/C++ header with same name...」：「同名のC/C++ヘッダ(ソース)を開く(C)」<br>　　→「Open C/C++ header with same name」<br><br>　「DIFF Differences」：「DIFF差分表示(D)...」<br>　　→「DIFF Differences...」<br><br>Toolメニュー<br>　メニュー内にmacroとMacroが混在するのでMacroで統一する。<br>　「Save the macro」：「キーマクロの保存(R)」<br>　　→「Save the Macro」<br><br>　「Load the macro」：「キーマクロの読み込み(M)」<br>　　→「Load the Macro」<br><br>　「Run the macro」：「キーマクロの実行(A)」<br>　　→「Run the Macro」<br><br>　「Run an Existing macro」：「名前を指定して実行(E)...」<br>　　→「Run an Existing Macro...」<br><br>Settingsメニュー<br>　「File type list」：「タイプ別設定一覧(L)...」<br>　　→「File type list...」<br><br>　「File type settings」：「タイプ別設定(Y)...」<br>　　→「File type settings...」<br><br>　「Common Settings」：「共通設定(C)...」<br>　　→「Common Settings...」<br><br>　「Font settings」：「フォント設定(F)...」<br>　　→「Font settings...」<br><br>　「Manage History」：「履歴の管理(O)...」<br>　　→「Manage History...」<br><br>Windowメニュー<br>　「Close all (O)ther tabs」：「このタブ以外を閉じる(O)」<br>　　→「Close all other tabs」（かっこは削除かつ小文字で）<br><br>　「Window list」：「ウィンドウ一覧(W)...」<br>　　→「Window list...」<br><br>　「Tab control」：「タブの操作(B)」<br>　　「Move to neXt group」：「次のグループに移動(X)」<br>　　　→「Move to next group」<br><br>　　「Move to preV group」：「前のグループに移動(V)」<br>　　　→「Move to prev group」<br><br>　「Show outpUt window」：「アウトプット(U)」<br>　　→「Show output window」<br><br>Helpメニュー<br>　「Search help by keyword」：「キーワード検索(S)...」<br>　　→「Search help by keyword...」<br><br>　「CoMmand list」：「コマンド一覧(M)」<br>　　→「Command list」<br><br>以上<br></div></section>
    </li></ul></li><li><section><h1 id=5716>
    <span class="no">[5716]</span>
    <a class="thread-title" href="#5716">リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-06T13:25:32">2011年04月06日 13:25</time></h1>
    <div class="body">メッセージリソースの外部DLL対応を試しに作成していますが、初期値作成より前にDLLを読み込む必要があるのでちょっと悩ましいです。<br><br>1. 言語選択ダイアログにてメッセージリソースを選択する<br>　選択後アプリを再起動する（動的変更は難しい）。<br>　選択された情報をiniファイルへ記憶し、次回起動時に読み込む。<br><br>2. 最初に見つけたメッセージリソースを自動的に読み込む<br>　iniまたはexeと同一階層からDLLを探し、最初に見つかったメッセージリソースを読み込む。<br><br>上記を考えましたが、1.の場合だと現状は初期値作成後にiniファイルを読み込むので言語選択情報だけは先に読み込む必要があります。<br>なので、2.の方法で作ってみようと思いますがどうでしょうか？<br></div></section>
    <ul><li><section><h1 id=5717>
    <span class="no">[5717]</span>
    <a class="thread-title" href="#5717">Re:リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-06T16:29:19">2011年04月06日 16:29</time></h1>
    <div class="body">とりあえずソースを以下にアップしました（14番）<br>　http://www.geocities.jp/nasukoji_7/download/download_sakuraeditor.html<br><br>SetThread...() はコメントアウトしてあるのでVC6でもビルド可能です（BCCはリソースでエラーになってしまった）<br><br>sakura_lang_en_US.dll を作成して sakura.exe と同一階層に置くとexe起動時に読み込まれます。<br>日本語Windowsで実行すると検索ダイアログなどが英語になります。<br></div></section>
    </li><li><section><h1 id=5718>
    <span class="no">[5718]</span>
    <a class="thread-title" href="#5718">Re:リソースの外部DLL化（req53に在る模様）</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-07T13:06:16">2011年04月07日 13:06</time></h1>
    <div class="body">wikiのrequest 53に対してwakuraさんによるリソース切り替えの実装がアップされていました。<br>車輪の再発明になってしまうので、そこにあるソースと上手いこと融合させたいのですが、wikiの「ライセンス明確化推進計画 」にwakuraさんの名前がありません。<br><br>zlib/libpng ライセンスで組み込んでも良いです？ ＞ wakuraさん<br><br>一応コメントに「いじりたおしてください」とありますので大丈夫とは思いますが念のため (^^;<br></div></section>
    </li><li><section><h1 id=5719>
    <span class="no">[5719]</span>
    <a class="thread-title" href="#5719">Re:リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-11T10:14:05">2011年04月11日 10:14</time></h1>
    <div class="body">結局wakuraさんのソースを使用しない状態でやり切りました。<br>あと必要なのは、現在読み込まれているDLLの情報表示や、exeとのバージョンが不一致の時の警告表示などでしょうか。<br><br>・外部DLLの名称は sakura_lang_*.dll となります（'*' の部分は一応自由）<br>・外部DLLはsakura.exeと同一階層におく必要があります<br>・外部DLLには言語IDと言語表示用文字列を追加しています<br>・外部DLLを読み込んだ場合、上記の言語IDを SetThreadLocale, SetThreadUILanguage に使用します<br>・内部リソースを使用する場合 SetThreadLocale, SetThreadUILanguage を発行しません<br><br><a href=http://www.geocities.jp/nasukoji_7/download/download_sakuraeditor.html target=_top><nobr>http://<wbr>www.<wbr>geocitie<wbr>s.<wbr>jp/<wbr>nasukoji<wbr>_7/<wbr>download<wbr>/<wbr>download<wbr>_sakurae<wbr>ditor.<wbr>html</nobr></a><br></div></section>
    </li><li><section><h1 id=5720>
    <span class="no">[5720]</span>
    <a class="thread-title" href="#5720">Re:リソースの外部DLL化</a>
    <span class="author">syat</span>
    <time datetime="2011-04-26T07:16:01">2011年04月26日 07:16</time></h1>
    <div class="body">▼ なすこじさん<br>20110410の版で、DLLによって言語が切り替わることを確認しました。<br>DLL化はあきらかに有用なので、せっかくenglishブランチを切っていることだし、どんどんコミットしていったらどうでしょうか。<br><br>&gt;あと必要なのは、現在読み込まれているDLLの情報表示や、exeとのバージョンが不一致の時の警告表示などでしょうか。<br>exeとのバージョン一致は課題ですね。本体をバージョンアップして、DLLのバージョンが古いままだと、新たに追加されたメッセージが空文字になってしまいとても残念。<br><br>以下、多言語化に対して気づいたことを。（亀レスで申し訳ないです）<br>・翻訳＆文字列リソース化お疲れさまでした。＞Lucienさん、なすこじさん<br>・英語版リソースで「(無題)」が「No Title11」のように連番がついたままです。<br>・ANSI版だと結局LoadStringAが呼ばれるのでsjis変換されるはず。本格的な多言語対応はUNICODE版かな？<br><br>もしUNICODE版に入れていくのであれば、以下も検討してほしいです。<br><br>・exeとDLLのバージョン不一致救済として、DLLから文字列を取得できなかったときは内部リソースから取得するようにしたらよいかも。<br>　↓こんなメソッドを用意する<br>int CSelectLang::LoadString( UINT uid, LPSTR _pszLabel, int nBufferMax )<br>{<br>&#9;int nRet = ::LoadString( getLangRsrcInstance(), uid, _pszLabel, nBufferMax );<br>&#9;if( nRet == 0 ){<br>&#9;&#9;return ::LoadString( ::GetModuleHandle(NULL), uid, _pszLabel, nBufferMax );<br>&#9;}<br>&#9;return nRet;<br>}<br><br>・毎回バッファを用意するのが正直面倒なので、糖衣構文が欲しい。<br>　↓このくらい<br>LPSTR CSelectLang::LoadString2( UINT uid )<br>{<br>&#9;char _pszLabel[1024];<br>&#9;CSelectLang::LoadString( uid, _pszLabel, _countof(_pszLabel)-2 );<br>&#9;return _pszLabel;<br>}<br>　↓使用例<br>::MYMESSAGEBOX( m_hWnd, MB_OK , GSTR_APPNAME, CSelectLang::LoadString2( STR_ERR_DLGFIND1 ) );<br>　自動変数の返却がだめならstatic変数のバッファでもよいので。。<br></div></section>
    <ul><li><section><h1 id=5721>
    <span class="no">[5721]</span>
    <a class="thread-title" href="#5721">Re2:リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-27T23:09:10">2011年04月27日 23:09</time></h1>
    <div class="body">▼ syatさん<br>確認どうもありがとうございます。<br>本命のUNICODE版への布石ということで実験的にANSI版を作ってみたものなので、完成度が低くてコミットはちょっと悩む所です (^^;<br><br>・初期値データも翻訳されています<br>　なので、iniファイル無しで起動した時の言語で初期値が作成されてしまいます。<br>　一旦作成されるとiniファイルが後から読み込まれて上書きされるので元に戻りません。<br>　exeのバージョンアップで追加設定があった場合、起動した時点で読み込んだ言語に依存します。<br><br>・現状プロセス起動時にDLLを探しているのでウィンドウ毎に言語が混在可能です<br>　例えば、日本語OSかつDLL無しでsakura.exeを起動し英語DLLをコピー後もう1枚画面を開いた場合、1枚目は日本語メニュー、2枚目は英語メニューとなります。<br><br>だれが（日本人？外国人？）どのように（日本語OS？英語OS？日英以外のローカライズ版OS？で）利用するかをもう少し考えないと変なものができてしまいそうです。<br><br>&gt; もしUNICODE版に入れていくのであれば、以下も検討してほしいです。<br>&gt; <br>&gt; ・exeとDLLのバージョン不一致救済として、DLLから文字列を取得できなかったときは内部リソースから取得するようにしたらよいかも。<br>&gt; 　↓こんなメソッドを用意する<br>&gt; int CSelectLang::LoadString( UINT uid, LPSTR _pszLabel, int nBufferMax )<br>&gt; {<br>&gt; &#9;int nRet = ::LoadString( getLangRsrcInstance(), uid, _pszLabel, nBufferMax );<br>&gt; &#9;if( nRet == 0 ){<br>&gt; &#9;&#9;return ::LoadString( ::GetModuleHandle(NULL), uid, _pszLabel, nBufferMax );<br>&gt; &#9;}<br>&gt; &#9;return nRet;<br>&gt; }<br><br>そうですね。これは必要だと思います。<br><br>&gt; ・毎回バッファを用意するのが正直面倒なので、糖衣構文が欲しい。<br>&gt; 　↓このくらい<br>&gt; LPSTR CSelectLang::LoadString2( UINT uid )<br>&gt; {<br>&gt; &#9;char _pszLabel[1024];<br>&gt; &#9;CSelectLang::LoadString( uid, _pszLabel, _countof(_pszLabel)-2 );<br>&gt; &#9;return _pszLabel;<br>&gt; }<br>&gt; 　↓使用例<br>&gt; ::MYMESSAGEBOX( m_hWnd, MB_OK , GSTR_APPNAME, CSelectLang::LoadString2( STR_ERR_DLGFIND1 ) );<br>&gt; 　自動変数の返却がだめならstatic変数のバッファでもよいので。。<br><br>確かに面倒です。悩んだのですが良い方法が浮かびませんでした (^^;<br>連続してLoadStringしている箇所もあったので、staticで1個というのもできません（今のままでは）<br>さすがに自動変数はまずいと思います。クラスを作ってコンストラクタでロードでしょうか？<br><br>取りあえずこんな感じです。<br>私の方は5月末まで忙しくて何もできそうにないのですが、げんたさんとLucienさんの間では何か進展しているのでしょうか？<br><br>ではでは。<br></div></section>
    </li><li><section><h1 id=5722>
    <span class="no">[5722]</span>
    <a class="thread-title" href="#5722">Re2:リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-04-30T20:30:02">2011年04月30日 20:30</time></h1>
    <div class="body">▼ syatさん<br>すみません、私変なことを書いていました。<br><br>&gt; 　↓使用例<br>&gt; ::MYMESSAGEBOX( m_hWnd, MB_OK , GSTR_APPNAME, CSelectLang::LoadString2( STR_ERR_DLGFIND1 ) );<br>&gt; 　自動変数の返却がだめならstatic変数のバッファでもよいので。。<br><br>ならその場で使うだけなのでstaticでOKですね。<br></div></section>
    <ul><li><section><h1 id=5723>
    <span class="no">[5723]</span>
    <a class="thread-title" href="#5723">Re3:リソースの外部DLL化</a>
    <span class="author">syat</span>
    <time datetime="2011-05-02T22:42:45">2011年05月02日 22:42</time></h1>
    <div class="body">▼ なすこじさん<br>連続してLoadStringしてるところは呼び元でバッファを準備するしかないと思いますが、例のようにメッセージボックスを出す程度の用途なら便利関数でさらっと書きたいなぁ、と思ったので。<br><br>ちなみにUNICODE版には渡した文字列をA &lt;-&gt; W変換してくれるto_wchar, to_acharという関数があって、使い勝手が良いです。（引数はたったの一個）<br>どうやってるのかと思ったら内部で６４個分のバッファを用意して使い回してました。<br><br>&gt;だれが（日本人？外国人？）どのように（日本語OS？英語OS？日英以外のローカライズ版OS？で）利用するかをもう少し考えないと変なものができてしまいそうです。<br>OSの違いはちょっとわからないですが、基本、日本語より英語のほうが得意な人が使うのでしょう。<br>本体と言語DLLをセットにして「英語版」として配布するイメージなら、言語の混在はあまり気になりません。<br><br>&gt;・初期値データも翻訳されています<br>これは、難しい。。<br>言語が絡む所ってタイプ別設定の名称だったりカスタムメニュー名だったりで、起動時に初期設定されてしまうので、例えば日本語で使っていて後から英語DLLを導入した場合、メニューやダイアログはほとんど英語なのに、タイプ別設定やウィンドウタイトルなどが日本語混じりになって？？？です。<br>iniを消して全再起動すればよいのですけど。<br>根本的に直すなら、今後の機能実装で初期値をiniにベタ書きしないような、本体での対応が必要な気がします。<br>iniには初期値として空欄を設定し、画面表示は空欄だったらリソースから取った文字列を表示するとか。<br></div></section>
    </li></ul></li></ul></li><li><section><h1 id=5724>
    <span class="no">[5724]</span>
    <a class="thread-title" href="#5724">Re:リソースの外部DLL化</a>
    <span class="author">なすこじ</span>
    <time datetime="2011-06-02T21:14:40">2011年06月02日 21:14</time></h1>
    <div class="body">syatさんの意見を参考に ::LoadString() をラップした関数で文字列リソースを読み込む様にしてみました。<br><br>　<a href=http://www.geocities.jp/nasukoji_7/download/download_sakuraeditor.html target=_top><nobr>http://<wbr>www.<wbr>geocitie<wbr>s.<wbr>jp/<wbr>nasukoji<wbr>_7/<wbr>download<wbr>/<wbr>download<wbr>_sakurae<wbr>ditor.<wbr>html</nobr></a><br>　　14-2. sakura_multi_lang_20110602.zip<br><br>CLoadString::LoadStringSt(UINT uid)<br>CLoadString::LoadString(UINT uid)<br><br>LoadStringSt()は4個ある静的バッファに文字列を取り込みます。バッファをぐるぐる使いまわすので、5回リソースを読み込むと最初の文字列が破壊されます。<br><br>LoadString()は変数を準備して使用します。<br>　CLoadString cStr; cStr.LoadString( リソースID );<br><br>アルファベット順で CEditView_Diff.cpp まで変更完了しています（残り300箇所ちょっと）<br>ひとまずこんな感じです。<br><br>そういえば「No Title」に番号が付く件は現在そのままです。<br>あとVC2008以降でないとビルドが通りません。<br><br>これから暫くはサクラエディタ以外の事をするので、この件には手を入れられなくなります。<br><br>ではでは。<br></div></section>
    </li></ul></li></ul></li></ul></body></html>