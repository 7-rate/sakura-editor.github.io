<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="/favicon.ico">
  <title>水平スクロールバーを常にテキストの幅に合わせる | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀ANSI版開発トップへ</a>
        <li><div class="list-title">
    <span class="no">5299</span>
    <a class="thread-title" href="5299.html#5299">水平スクロールバーを常にテキストの幅に合わせる</a></div>
    <ul><li><div class="list-title">
    <span class="no">5303</span>
    <a class="thread-title" href="5299.html#5303">問題について</a></div>
    </li><li><div class="list-title">
    <span class="no">5304</span>
    <a class="thread-title" href="5299.html#5304">仕様について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5305</span>
    <a class="thread-title" href="5299.html#5305">Re:仕様について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5307</span>
    <a class="thread-title" href="5299.html#5307">作ってみました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5308</span>
    <a class="thread-title" href="5299.html#5308">Re:作ってみました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5310</span>
    <a class="thread-title" href="5299.html#5310">Re2:作ってみました</a></div>
    </li><li><div class="list-title">
    <span class="no">5312</span>
    <a class="thread-title" href="5299.html#5312">Re2:作ってみました</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5309</span>
    <a class="thread-title" href="5299.html#5309">Re:作ってみました</a></div>
    </li><li><div class="list-title">
    <span class="no">5311</span>
    <a class="thread-title" href="5299.html#5311">Re:作ってみました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5313</span>
    <a class="thread-title" href="5299.html#5313">Re2:作ってみました</a></div>
    </li><li><div class="list-title">
    <span class="no">5314</span>
    <a class="thread-title" href="5299.html#5314">Re2:作ってみました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5315</span>
    <a class="thread-title" href="5299.html#5315">Re3:作ってみました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5316</span>
    <a class="thread-title" href="5299.html#5316">Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5317</span>
    <a class="thread-title" href="5299.html#5317">Re:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5318</span>
    <a class="thread-title" href="5299.html#5318">Re2:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5319</span>
    <a class="thread-title" href="5299.html#5319">Re3:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5320</span>
    <a class="thread-title" href="5299.html#5320">Re4:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5321</span>
    <a class="thread-title" href="5299.html#5321">Re5:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5322</span>
    <a class="thread-title" href="5299.html#5322">Re6:Patchesにアップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5324</span>
    <a class="thread-title" href="5299.html#5324">Re7:Patchesにアップしました</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5323</span>
    <a class="thread-title" href="5299.html#5323">Re:水平スクロールバーを常にテキストの幅に合わせる</a></div>
    <ul><li><div class="list-title">
    <span class="no">5325</span>
    <a class="thread-title" href="5299.html#5325">修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5326</span>
    <a class="thread-title" href="5299.html#5326">Re:修正版アップしました</a></div>
    </li><li><div class="list-title">
    <span class="no">5330</span>
    <a class="thread-title" href="5299.html#5330">Re:修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5331</span>
    <a class="thread-title" href="5299.html#5331">Re2:修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5333</span>
    <a class="thread-title" href="5299.html#5333">Re3:修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5335</span>
    <a class="thread-title" href="5299.html#5335">Re4:修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5340</span>
    <a class="thread-title" href="5299.html#5340">Re5:修正版アップしました</a></div>
    <ul><li><div class="list-title">
    <span class="no">5343</span>
    <a class="thread-title" href="5299.html#5343">Re6:修正版アップしました</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5345</span>
    <a class="thread-title" href="5299.html#5345">ユーザ視点的な感想</a></div>
    </li><li><div class="list-title">
    <span class="no">5346</span>
    <a class="thread-title" href="5299.html#5346">ユーザ視点的な感想　つづき</a></div>
    <ul><li><div class="list-title">
    <span class="no">5347</span>
    <a class="thread-title" href="5299.html#5347">Re:ユーザ視点的な感想　つづき</a></div>
    <ul><li><div class="list-title">
    <span class="no">5351</span>
    <a class="thread-title" href="5299.html#5351">Re2:ユーザ視点的な感想　つづき</a></div>
    <ul><li><div class="list-title">
    <span class="no">5361</span>
    <a class="thread-title" href="5299.html#5361">Re3:ユーザ視点的な感想　つづき</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5352</span>
    <a class="thread-title" href="5299.html#5352">Re2:ユーザ視点的な感想　つづき</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5349</span>
    <a class="thread-title" href="5299.html#5349">Re:ユーザ視点的な感想　つづき</a></div>
    <ul><li><div class="list-title">
    <span class="no">5353</span>
    <a class="thread-title" href="5299.html#5353">Re2:ユーザ視点的な感想　つづき</a></div>
    </li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=5299>
    <span class="no">[5299]</span>
    <a class="thread-title" href="#5299">水平スクロールバーを常にテキストの幅に合わせる</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-25T03:26:55">2008年05月25日 03:26</time></h1>
    <div class="body">A) 水平スクロールバーを常にテキストの幅に合わせる<br>B) 常にウィンドウの幅で折り返す<br><br>上記の機能を実験的に作ってみました（ダウンロードページの10-5.）<br>しかし、速度の問題と分割ウィンドウでの表示の問題があります。<br><br>■速度の問題<br>A：入力毎に全ラインを走査してテキストの最大幅を求めています。そしてAdjustScrollBars()でそれを使っています。<br>B：OnSize()にて折り返し位置の変更を呼び出しています。こちらの方が負荷が高いです。<br><br>これをAthlonXP-M3000, mem DDR1GB, Win2k SP4のデスクトップ環境で試してみました。<br>A：10万行程度までなら使えそうな感じ。<br>B：1万行までなら大丈夫そう、2万行あると遅さが分かる。<br> 　5万行では明らかに遅い。書き直しに1秒程掛かる。<br><br>■分割ウィンドウの問題（Bのみ）<br>左右に分割すると、左側のウィンドウが右側のウィンドウサイズで折り返されます。<br>折り返し幅は1つしかないので処理順の都合でこの様になります（と思う）<br>こちらは今のままだとちょっと致命的ですかね？左右に分割すると問題ありますよ、で押し通したい所ですが……<br><br><br>一応タイプ別オプション→スクリーン→レイアウトの所にオプションを追加して選択できるようにしてみました。<br>また、Ctrl+Alt+Uでの折り返しの変更については、AまたはBが選択されている時はA,Bのトグルとしました。<br><br>こんな感じですが、この機能使えると思います？<br>Patchesに載せる価値あるでしょうか？<br><br><a href=http://www.geocities.jp/nasukoji_7/download/download_sakuraeditor.html target=_top><nobr>http://<wbr>www.<wbr>geocitie<wbr>s.<wbr>jp/<wbr>nasukoji<wbr>_7/<wbr>download<wbr>/<wbr>download<wbr>_sakurae<wbr>ditor.<wbr>html</nobr></a><br><br></div></section>
    <ul><li><section><h1 id=5303>
    <span class="no">[5303]</span>
    <a class="thread-title" href="#5303">問題について</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-27T18:46:44">2008年05月27日 18:46</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; A：入力毎に全ラインを走査してテキストの最大幅を求めています。そしてAdjustScrollBars()でそれを使っています。<br><br>他エディタではどれも、<br>・最大幅の拡大を監視してスクロール幅をそれにあわせて拡大する<br>・最大幅の縮小は監視せずスクロール幅を縮小することはしない<br>になっていると思います。<br>たいてい、長ーい行を貼り付けるとスクロール幅が広がりますが、削除しても狭くはなりません。<br>つまり、スクロール幅は常に全ラインを走査して現在の最大幅に合わせるのではなく、変更された行だけを走査して編集開始以後に記録した過去最大幅に合わせておくこと（ある意味手抜き）で性能を確保しているような気がしますが、違いますかね？<br><br>&gt; B：OnSize()にて折り返し位置の変更を呼び出しています。こちらの方が負荷が高いです。<br><br>常に折り返すのは、どっちかというと付加的な機能ですし性能にさほど過敏になる必要はないと思いますけど...<br><br>&gt; ■分割ウィンドウの問題（Bのみ）<br>&gt; 左右に分割すると、左側のウィンドウが右側のウィンドウサイズで折り返されます。<br><br>どちらかのビュー幅の桁数に他方の桁数をあわせるので良いと思います。同時スクロールはそのほうが見やすい、とも。EmEditorだと左側のビューの桁数に右側の桁数を合わせているみたいですね。</div></section>
    </li><li><section><h1 id=5304>
    <span class="no">[5304]</span>
    <a class="thread-title" href="#5304">仕様について</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-27T18:50:28">2008年05月27日 18:50</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; A) 水平スクロールバーを常にテキストの幅に合わせる<br>&gt; B) 常にウィンドウの幅で折り返す<br><br>ちょっとだけ触ってみました。<br>常に折り返しのとき、右側に少し空白が欲しいかな。ぶら下げ文字＋改行文字くらいは見せてほしいですね～。<br>…って、細かい。(^^;<br><br>Aは特に欲しいとは思ったこと無いです。でも、性能低下が無ければ全タイプ（！）の設定をこれにして使うと思います。桁数を考える必要が無いしスクロールバーのつまみ部分も長めになって楽ちん。<br>Bは欲しいと思うときがあります。ワープロや掲示板投稿用の文章の下書きをするときとか。<br><br>この件については、細部まで仕様を練って他の人たちと調整するのがなんだか面倒に感じていたので手をつけていませんでした。この機会に、自分が期待する仕様（現在のところ）を書いておきます。まぁ、割と変哲のない仕様だとは思いますが...<br><br>折り返しモードの名称は、<br>「折り返さない」  &lt;--- A相当<br>「指定幅で折り返す」<br>「右端で折り返す」 &lt;--- B相当<br>のように他エディタでも使われているような簡潔でありふれた表記に。<br>※「折り返さない」は限度を超えたら折り返しちゃうじゃない？とかいう突っ込みは置いといて。<br><br>設定ＵＩや設定の引き継ぎについては以下のとおり。<br><br>・各タイプ別設定に３択の「折り返し方法」コンボボックスを１個だけ置く（「折り返し桁数」の上あたり）<br>・メニューコマンドは個別に３つ（折り返さない／指定幅で折り返す／右端で折り返す）を用意する<br>・折り返し方法（３種）はタイプ別設定とコマンドとでは対象範囲と有効期間が違うだけで機能的には同じ<br>・コマンドでの変更はその画面だけに適用される一時設定で、元のタイプ別設定は変更しない<br>・タイプ別設定を変更しても一時設定になっている画面には反映しない（一時設定未適用の画面には反映）<br>※完全代用とはいかないかもしれないけど、上記仕様になれば従来のトグル式メニューと挙動は不要（僕には）<br><br>ちょうど VxEditor あたり（秀丸も？）がこれと同様の感じになってたような気がします。<br><br>同じ.txt拡張子のファイルでも、折り返さないほうが見やすいものと、右端で折り返したほうが見やすいものとがあって、同時に２つ開いているときは別々の設定にして使いたいのです。基本は「折り返さない」設定で使い、右端で折り返したほうが見やすいものに出くわしたらその画面だけ一時的に「右端で折り返す」設定に変更、という具合に。逆に、「右端で折り返す」が基本で「折り返さない」は一時使用という人もいるかもしれませんね。<br><br>●補足：一時設定の適用中／未適用の制御方法<br>コマンドで現在の設定がタイプ別設定と異なる設定に変更されたら一時設定適用中、逆にコマンドでタイプ別設定と同じ設定に変更されたら一時設定未適用、という扱いでＯＫ。同じ画面で対象ファイルが変更されるとき（閉じて無題、閉じて開く）は一時設定未適用にして新たなファイルに対応するタイプ別設定を適用。</div></section>
    <ul><li><section><h1 id=5305>
    <span class="no">[5305]</span>
    <a class="thread-title" href="#5305">Re:仕様について</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-29T00:41:46">2008年05月29日 00:41</time></h1>
    <div class="body">▼ ryojiさん<br>レスどうもありがとうございます m(_ _)m<br><br>拡大縮小については、Notepad以外は意識して確認しない様にしていたので分かりません (^^;<br>ただ、パフォーマンスを確保するために全ラインの走査はしていないだろうなぁとは思っていました。<br><br>&gt; &gt; 左右に分割すると、左側のウィンドウが右側のウィンドウサイズで折り返されます。<br>&gt; <br>&gt; どちらかのビュー幅の桁数に他方の桁数をあわせるので良いと思います。同時スクロールはそのほうが見やすい、とも。EmEditorだと左側のビューの桁数に右側の桁数を合わせているみたいですね。<br><br>確かに左右の折り返しが一致していた方が見やすいかもしれませんね。<br>そもそも同時スクロールの場合、別々の折り返し位置だと制御が難しいかな？<br><br>と言う事で、折り返しやスクロールバーの制御については基本的にこの動作のまま行こうと思います。<br><br>設定変更処理については、私も文書毎に一時設定できた方が良いかも？と思っていましたので、ryojiさん提案の方法をとってみようと思います。<br><br>&gt; 折り返しモードの名称は、<br>&gt; 「折り返さない」  &lt;--- A相当<br>&gt; 「指定幅で折り返す」<br>&gt; 「右端で折り返す」 &lt;--- B相当<br><br>&gt; ・各タイプ別設定に３択の「折り返し方法」コンボボックスを１個だけ置く（「折り返し桁数」の上あたり）<br>&gt; ・メニューコマンドは個別に３つ（折り返さない／指定幅で折り返す／右端で折り返す）を用意する<br>&gt; ・折り返し方法（３種）はタイプ別設定とコマンドとでは対象範囲と有効期間が違うだけで機能的には同じ<br>&gt; ・コマンドでの変更はその画面だけに適用される一時設定で、元のタイプ別設定は変更しない<br>&gt; ・タイプ別設定を変更しても一時設定になっている画面には反映しない（一時設定未適用の画面には反映）<br><br>&gt; コマンドで現在の設定がタイプ別設定と異なる設定に変更されたら一時設定適用中、逆にコマンドでタイプ別設定と同じ設定に変更されたら一時設定未適用、という扱いでＯＫ。同じ画面で対象ファイルが変更されるとき（閉じて無題、閉じて開く）は一時設定未適用にして新たなファイルに対応するタイプ別設定を適用。<br><br>■その他<br>・S_WrapWindowWidth()マクロはそのまま。<br>・「折り返し方法」変更用（一時設定）のマクロは1個+引き数で処理。引き数が無理なら3つ準備する。<br>・従来のトグル式メニューは折り返し方法が「指定幅で折り返す」の時有効とする（一時設定時を含む）<br>・折り返し方法のデフォルトは「折り返さない」とする。<br><br>※デフォルトを「折り返さない」にして新仕様での使用を促すか、「指定幅で折り返す」にして新しい仕様を隠した状態とするかは悩ましいですが、取りあえず新仕様をデフォルトにしてみようと思います。<br><br>ではでは。<br></div></section>
    <ul><li><section><h1 id=5307>
    <span class="no">[5307]</span>
    <a class="thread-title" href="#5307">作ってみました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-31T06:44:32">2008年05月31日 06:44</time></h1>
    <div class="body">&gt;&gt;dev:5305の仕様で作ってみました。<br><br>mytool.bmpを修正したのですが、TortiseSVNのパッチ作成ではbmp部分は当然面倒見れないという事で不完全な差分となってしまったので、今回も自分のwebページに置きました（ダウンロードページ 10-7）<br><br>bmpを修正した場合の差分はどのように作成すれば良いのでしょうか？<br><br>以下動作について：<br>タイプ別設定以外で折り返しの設定を変更した場合、一時設定となります。<br>一時設定状態の時は、複数画面で作業している時にタイプ別設定にて折り返し方法を変更しても、タイプ別設定を呼び出したウィンドウ以外は一時設定のままとなります。<br>タイプ別設定を呼び出したウィンドウについては強制的にタイプ別設定で選んだ方法とします（上の発言から少し変更）<br><br>・メニュー<br>　　「設定」→「テキストの折り返し方法変更」<br>・ツールバー対応<br>・ショートカット対応<br>　　Ctrl+Alt+X：折り返しなし<br>　　Ctrl+Alt+S：指定幅で折り返し<br>　　Ctrl+Alt+W：右端で折り返し<br>・マクロ対応「S_TextWrapMethod()」<br>　　0：折り返しなし<br>　　1：指定幅で折り返し<br>　　2：右端で折り返し<br><br><br>現在の問題<br>・テキスト最長行の右端に移動しバックスペースで文字を削除するとカーソルがウィンドウの左へ移動するが、ここでスクロールバーのつまみをクリックするとテキスト表示エリアが切り替わりカーソルおよび表示テキストが画面右側へ飛ぶ。<br>・デバッグモードで実行すると新規に追加したメニューの字が青いんですが、理由が分かりません (^^;<br></div></section>
    <ul><li><section><h1 id=5308>
    <span class="no">[5308]</span>
    <a class="thread-title" href="#5308">Re:作ってみました</a>
    <span class="author">神楽</span>
    <time datetime="2008-05-31T12:48:24">2008年05月31日 12:48</time></h1>
    <div class="body">▼ なすこじさん&gt; ・ショートカット対応<br>&gt; 　　Ctrl+Alt+X：折り返しなし<br>&gt; 　　Ctrl+Alt+S：指定幅で折り返し<br>&gt; 　　Ctrl+Alt+W：右端で折り返し<br>&gt; ・マクロ対応「S_TextWrapMethod()」<br>&gt; 　　0：折り返しなし<br>&gt; 　　1：指定幅で折り返し<br>&gt; 　　2：右端で折り返し<br><br>横槍失礼します。<br>上記は既存の以下の機能と等価でしょうか？<br><a href=http://sakura-editor.sourceforge.net/htmlhelp/HLP000184.html target=_top><nobr>http://<wbr>sakura-<wbr>editor.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>htmlhelp<wbr>/<wbr>HLP00018<wbr>4.<wbr>html</nobr></a><br>（ショートカットキーは、Ctrl+Alt+Uです）</div></section>
    <ul><li><section><h1 id=5310>
    <span class="no">[5310]</span>
    <a class="thread-title" href="#5310">Re2:作ってみました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-31T13:11:17">2008年05月31日 13:11</time></h1>
    <div class="body">▼ 神楽さん<br>&gt; 上記は既存の以下の機能と等価でしょうか？<br>&gt; <a href=http://sakura-editor.sourceforge.net/htmlhelp/HLP000184.html target=_top><nobr>http://<wbr>sakura-<wbr>editor.<wbr>sourcefo<wbr>rge.<wbr>net/<wbr>htmlhelp<wbr>/<wbr>HLP00018<wbr>4.<wbr>html</nobr></a><br>&gt; （ショートカットキーは、Ctrl+Alt+Uです）<br><br>Ctrl+Alt+Uの機能はサクラだけの特殊機能で、自画面の「折り返し桁数」を変更するものですね。<br>で、なすこじさんがやっているのは、他エディタ（メモ帳含む）によくあるのと等価な「折り返し方法」を変更するものです。</div></section>
    </li><li><section><h1 id=5312>
    <span class="no">[5312]</span>
    <a class="thread-title" href="#5312">Re2:作ってみました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-31T17:48:46">2008年05月31日 17:48</time></h1>
    <div class="body">説明が変で申し訳ないです m(_ _)m<br><br>「折り返しなし」「右端で折り返し」は新規機能となります。<br><br>A：折り返しなし（水平スクロールバーがテキストの幅に動的に追従）<br>B：指定幅で折り返し（既存機能）<br>　　B1：折り返さない<br>　　B2：タイプ別設定の幅で折り返し<br>　　B3：現在のウィンドウ幅で折り返し<br>C：右端で折り返し（折り返し位置がウィンドウサイズに動的に追従）<br><br>上記Bが今までと同じ動作となっています。<br>B選択中のみCtrl+Alt+Uが使用可能で動作も今まで通りです。<br></div></section>
    </li></ul></li><li><section><h1 id=5309>
    <span class="no">[5309]</span>
    <a class="thread-title" href="#5309">Re:作ってみました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-31T12:54:22">2008年05月31日 12:54</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; &gt;&gt;dev:5305の仕様で作ってみました。<br><br>ありがとうございます。<br>ソースを見るのは余力があるときにでも…、となりそうですが、使いながら操作感や動作の確認をしてみたいと思います。(^^;<br><br>&gt; bmpを修正した場合の差分はどのように作成すれば良いのでしょうか？<br><br>Patchesのサイズ制限でも特に問題なくUPできると思います。<br>パッチ本体とあわせてzipにまとめるのでも、別メッセージでUPするのでも、どちらでもよろしいかと。<br><br>&gt; 以下動作について：<br>&gt; タイプ別設定以外で折り返しの設定を変更した場合、一時設定となります。<br>&gt; 一時設定状態の時は、複数画面で作業している時にタイプ別設定にて折り返し方法を変更しても、タイプ別設定を呼び出したウィンドウ以外は一時設定のままとなります。<br>&gt; タイプ別設定を呼び出したウィンドウについては強制的にタイプ別設定で選んだ方法とします（上の発言から少し変更）<br><br>明示的に折り返しを変更しなくても、ＯＫボタンで閉じただけで強制的に変更されてしまうのがちょっと悲しいかなぁ？<br>Windows画面プロパティの[テーマ]欄で「変更されたテーマ」が表示されるように、自画面が一時設定中のときは、折り返し方法に「一時設定適用中」とでも表示しておいて、そこが変更されなければ他画面も一切変更しない、という具合にすることは可能でしょうか？<br>単なる思い付きで言ってますが…(^^;<br><br>&gt; ・デバッグモードで実行すると新規に追加したメニューの字が青いんですが、理由が分かりません (^^;<br><br>これはヘルプIDを割り当てていないと、忘れてるんじゃない？という確認の意味で青表示されるようになっています。<br>HLP000340～342あたりの連番を振っておけばいいと思います。あとはヘルプメンテの方がうまくやってくれている、という感じです。<br><br>他に気づいた点：<br>「右端で折り返し」のときに１桁分だけ右余白がつくようになった？<br>「改行ぶら下げ」や「句読点ぶら下げ」を設定しているときは各々で２桁づつ、折り返し記号の１桁をあわせると、おそらく最大５桁は桁オーバーで表示されることになると思います。<br>設定に合わせて余白も自動調整されるといいのですが…<br>メニューアイコンの左右上端にゴミが残っていますね。（アイコン追加する際のガイド用に予備部分に点々をつけているのだと思いますが、これは消しておかないと）</div></section>
    </li><li><section><h1 id=5311>
    <span class="no">[5311]</span>
    <a class="thread-title" href="#5311">Re:作ってみました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-31T14:52:44">2008年05月31日 14:52</time></h1>
    <div class="body">分割ビューの場合なんですが、「右端で折り返す」はアクティブなビューの画面幅が変化するとそれに合わせて変化してますね。左右どちらかに固定した方が扱いやすいような気がします。左上のビュー（インデックス０番）のサイズ変更に合わせるのがソースコード記述上でも楽なんじゃないでしょうか？</div></section>
    <ul><li><section><h1 id=5313>
    <span class="no">[5313]</span>
    <a class="thread-title" href="#5313">Re2:作ってみました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-31T17:49:25">2008年05月31日 17:49</time></h1>
    <div class="body">▼ ryojiさん<br><br>沢山のご助言ありがとうございます m(_ _)m<br><br>&gt; 明示的に折り返しを変更しなくても、ＯＫボタンで閉じただけで強制的に変更されてしまうのがちょっと悲しいかなぁ？<br>&gt; Windows画面プロパティの[テーマ]欄で「変更されたテーマ」が表示されるように、自画面が一時設定中のときは、折り返し方法に「一時設定適用中」とでも表示しておいて、そこが変更されなければ他画面も一切変更しない、という具合にすることは可能でしょうか？<br><br>現在の状態が一時設定なのかどうかが分からないのはあまり良くないですね。<br>メニューの「テキストの折り返し方法変更」を、一時設定適用中は「折り返し方法（一時設定適用中）」にしてみます。<br>タイプ別設定の適用の動作については検討してみます。<br><br>&gt; 「右端で折り返し」のときに１桁分だけ右余白がつくようになった？<br>&gt; 「改行ぶら下げ」や「句読点ぶら下げ」を設定しているときは各々で２桁づつ、折り返し記号の１桁をあわせると、おそらく最大５桁は桁オーバーで表示されることになると思います。<br>&gt; 設定に合わせて余白も自動調整されるといいのですが…<br><br>あうっ、全く分かっていませんでした (^^;<br>1桁分余裕を入れれば良いと思ってた……、修正し直します。<br><br>&gt; メニューアイコンの左右上端にゴミが残っていますね。（アイコン追加する際のガイド用に予備部分に点々をつけているのだと思いますが、これは消しておかないと）<br><br>こっちは悩んだ挙げ句に残したのですが、上の点はガイドだったんですね。<br>それと「右端で折り返し」は「現在のウィンドウ幅で折り返し」のアイコンをコピーして使っているので、両方ツールバーに置くと区別できなくなります。<br>なので「右端で折り返し」のアイコンをほんの少しですが変更します。<br><br>&gt; 分割ビューの場合なんですが、「右端で折り返す」はアクティブなビューの画面幅が変化するとそれに合わせて変化してますね。左右どちらかに固定した方が扱いやすいような気がします。左上のビュー（インデックス０番）のサイズ変更に合わせるのがソースコード記述上でも楽なんじゃないでしょうか？<br><br>右側で統一されている予定でしたが間違いでした。おっしゃる通り左上が最も楽なので左上のビューに合わせることにします。<br><br>ではでは。<br></div></section>
    </li><li><section><h1 id=5314>
    <span class="no">[5314]</span>
    <a class="thread-title" href="#5314">Re2:作ってみました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-05-31T21:07:30">2008年05月31日 21:07</time></h1>
    <div class="body">▼ ryojiさん<br>「改行ぶら下げ」をマニュアルで確認してみましたが、文字通り改行マークを右にぶら下げると言う事のようですので1桁分の幅ですよね。<br><br>従って、折り返し位置より右側に出るのは、<br>　句読点ぶら下げによる句読点（2桁）+ 折り返し記号（1桁）<br>　または<br>　句読点ぶら下げによる句読点（2桁）+ 改行ぶら下げによる改行マーク（1桁）<br>の3桁になると思います。<br><br>折り返し記号はオプションの選択状態によらず発生しますので、結局右側に必要なマージンはデフォルト1桁、「句読点ぶら下がり」選択時3桁で良さそうな感じですがどうでしょう？<br></div></section>
    <ul><li><section><h1 id=5315>
    <span class="no">[5315]</span>
    <a class="thread-title" href="#5315">Re3:作ってみました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-05-31T23:51:25">2008年05月31日 23:51</time></h1>
    <div class="body">&gt; 「改行ぶら下げ」をマニュアルで確認してみましたが、文字通り改行マークを右にぶら下げると言う事のようですので1桁分の幅ですよね。<br><br>CRLFなどの改行マークは２桁幅でないと記号全体が見えないので、<br><br>句読点ぶら下げによる句読点（2桁）+ 改行ぶら下げによる改行マーク（2桁）<br>（このときは折り返し記号はつかない）<br><br>で最大は４桁かしら？</div></section>
    <ul><li><section><h1 id=5316>
    <span class="no">[5316]</span>
    <a class="thread-title" href="#5316">Patchesにアップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-02T04:26:08">2008年06月02日 04:26</time></h1>
    <div class="body">Patches #1981460　テキスト折り返し方法の追加<br><br>色々修正しました。<br>ただし、タイプ別設定画面に「一時設定適用中」を表示するのは未実装です。<br>CShareDataにフラグを追加しそのON/OFFによって文字列を変更するくらいしか思い付かないのですが、セマフォみたいなことが必要でしょうかね？<br>もっと良い方法があったらお願いします m(_ _)m<br></div></section>
    <ul><li><section><h1 id=5317>
    <span class="no">[5317]</span>
    <a class="thread-title" href="#5317">Re:Patchesにアップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-02T22:44:25">2008年06月02日 22:44</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; 色々修正しました。<br><br>設定画面で折り返し方法の変更が無ければ、自画面の一時設定は解除しないようにされたのですね。良い感じです。<br><br>&gt; ただし、タイプ別設定画面に「一時設定適用中」を表示するのは未実装です。<br><br>これについては、設定無変更なら一時設定解除はしないで欲しいという、そのついでにふと思いついたことです。表示の無い現状でも十分かな？と思います。<br><br>その他：<br>「折り返さない」設定のときの動作でいくつか気になる点があります。<br>１．置換画面で置換実行した場合、最大幅の更新に水平スクロールバーが追随しないみたいです<br>２．１行が最大幅を超える場合、水平スクロールバーのつまみを最右端にすることができない<br>　例えば、折り返しで３行になるような場合は最右端にしようとしても半分以下までに引き戻される<br>３．変更のたびに全行走査、というのでは単独で動かしているときには問題にならないレベルでも、別アプリと同時動作の場合に応答が悪くならないか？あるいは別アプリのほうの性能を極端に下げたりしないか？<br>　例えば、プログラムのコンパイル中にサクラで文字入力した場合とか、（まだ試していないけど）ちょっと気がかりです。なんだか必要以上にＣＰＵを使ってしまう気がして。</div></section>
    <ul><li><section><h1 id=5318>
    <span class="no">[5318]</span>
    <a class="thread-title" href="#5318">Re2:Patchesにアップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-03T13:10:55">2008年06月03日 13:10</time></h1>
    <div class="body">▼ ryojiさん<br><br>&gt; 「折り返さない」設定のときの動作でいくつか気になる点があります。<br>&gt; １．置換画面で置換実行した場合、最大幅の更新に水平スクロールバーが追随しないみたいです<br>&gt; ２．１行が最大幅を超える場合、水平スクロールバーのつまみを最右端にすることができない<br>&gt; 　例えば、折り返しで３行になるような場合は最右端にしようとしても半分以下までに引き戻される<br><br>ありがとうございます。確認・修正します。<br><br>&gt; ３．変更のたびに全行走査、というのでは単独で動かしているときには問題にならないレベルでも、別アプリと同時動作の場合に応答が悪くならないか？あるいは別アプリのほうの性能を極端に下げたりしないか？<br>&gt; 　例えば、プログラムのコンパイル中にサクラで文字入力した場合とか、（まだ試していないけど）ちょっと気がかりです。なんだか必要以上にＣＰＵを使ってしまう気がして。<br><br>負荷が高くなるのは間違いないので問題となるかもしれませんね。<br>数千行あるとカーソル行アンダーラインのちらつきも感じるようになりますし。<br><br>『負荷を上げずに「折り返しなし」を使う』オプションを追加して、オプションがチェックされている場合はメモ帳と同様に行長の拡大のみ監視するようにするというのはどうでしょう？（初期値はチェック入）<br>ryojiさんが&gt;&gt;dev:5303で上げられているように、編集した行だけをチェックすれば良いので相当負荷は軽くなると思います。<br></div></section>
    <ul><li><section><h1 id=5319>
    <span class="no">[5319]</span>
    <a class="thread-title" href="#5319">Re3:Patchesにアップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-03T22:27:08">2008年06月03日 22:27</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; 『負荷を上げずに「折り返しなし」を使う』オプションを追加して、オプションがチェックされている場合はメモ帳と同様に行長の拡大のみ監視するようにするというのはどうでしょう？（初期値はチェック入）<br><br>僕としては、さほど大きな魅力を感じているわけでもない「折り返しなし」機能にそこまで細かい設定は要らないかな、と思いますけど．．．<br>特に欲しいと考えている人たちが機能・性能バランスを考慮して「こっちが妥当だ」と決めてくれるなら、そっちの意見に従いたいところです。</div></section>
    <ul><li><section><h1 id=5320>
    <span class="no">[5320]</span>
    <a class="thread-title" href="#5320">Re4:Patchesにアップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-04T09:46:24">2008年06月04日 09:46</time></h1>
    <div class="body">&gt; 機能・性能バランス<br><br>機能／性能バランス、ということについて少し考えてみました。<br>現状のサクラでは、対括弧の強調表示は画面可視範囲内しかサーチしない、カラー表示の上塗りはしないなど、実用範囲でＯＫなら無理にハードに負担はかけないようにしているところが多々見られます。<br>個々の機能で見るともっと完全なものにするのが良いのでしょうが、他機能のために余力を残すという意味では妥当なことなのかな～、とも思います。<br>エディタ機能全体として、既存機能の強化、新機能の追加まで含めたハード的な余力って、どのくらいあるんでしょうかね？？</div></section>
    <ul><li><section><h1 id=5321>
    <span class="no">[5321]</span>
    <a class="thread-title" href="#5321">Re5:Patchesにアップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-04T12:57:28">2008年06月04日 12:57</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; エディタ機能全体として、既存機能の強化、新機能の追加まで含めたハード的な余力って、どのくらいあるんでしょうかね？？<br><br>私自身は余力があり余っていると思うのですが、使用者のPCや使用方法で変わってくるので中々定量的に示すのは難しいですね。<br><br>ただ、常に全ライン走査というのはかなりパワーを必要とするので余り良い方法ではないとは思います。<br>現にカーソル行アンダーラインがちらつくなどの影響が出ています。<br>単純なコーディングで済まそうとしていたからなのですが、上記のような見た目の問題を軽減するために現在はもう少し複雑な判定を考えています。<br><br>逆に、見た目の性能劣化が少なければ少々要求パワーが上がっても良いかなという感じです。<br>気になる方はオプションを切って今まで通りの状態で使用してもらうということで……<br><br>複雑なコーディングをすると後々の不具合の元になるのでできるだけ単純にしたかったのですが、私のレベルではもう無理、どんどん汚くなっていく (^^;<br><br>あと&gt;&gt;dev:5317の、<br>&gt; 「折り返さない」設定のときの動作でいくつか気になる点があります。<br>&gt; １．置換画面で置換実行した場合、最大幅の更新に水平スクロールバーが追随しないみたいです<br><br>上記現象の発生条件がわかりません。<br>文書が編集されたときに下記の関数のどれかが呼ばれれば大丈夫なつもりなんですが、呼ばれないルートがあるのでしょうかね？<br>　CEditView::InsertData_CEditView()<br>　CEditView::DeleteData2()<br>　CEditView::ReplaceData_CEditView()<br><br>ではでは。<br></div></section>
    <ul><li><section><h1 id=5322>
    <span class="no">[5322]</span>
    <a class="thread-title" href="#5322">Re6:Patchesにアップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-04T19:15:13">2008年06月04日 19:15</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; 現在はもう少し複雑な判定を考えています。<br><br>if(変更行長＞最大長)<br>　最大長＝変更行長<br>else if(最大長だった行が短くなった)<br>　全行再スキャン<br><br>てな感じの細工でもかなり負荷緩和されそうですね。<br><br>&gt; &gt; １．置換画面で置換実行した場合、最大幅の更新に水平スクロールバーが追随しないみたいです<br>&gt; <br>&gt; 上記現象の発生条件がわかりません。<br><br>普通に「置換」ボタンで置換実行するだけです。<br>例えば、改行のみがいくつか存在するテキストに１行だけスクロールバーが表示されるような長い行を追加しておいて、その行データを空文字列に置換するとスクロールバーが追随しません。<br>その後、置換ダイアログを閉じてビューをクリックしたり、矢印キーでカーソル移動すると、そのときにスクロールバーが追随します。<br><br>&gt; 　CEditView::InsertData_CEditView()<br>&gt; 　CEditView::DeleteData2()<br>&gt; 　CEditView::ReplaceData_CEditView()<br><br>「置換」ボタンでの置換動作は、検索でカーソル移動／選択したのち選択範囲の文字列を入れ替えるという連続動作になっています。<br>検索でのカーソル移動では画面がスクロールしますが、文字列入れ替えは描画OFFで行ってから全体再描画してます。<br>描画OFFでMoveCursor()が実行されるときはスクロールOFFになっているため現状のコードでは最大幅のスキャンが行われません。<br>最後の全体再描画では更新されていない昔の最大幅のままでスクロールバーが再描画されます。<br><br>MoveCursor()ではなく、MoveCursor()の中で呼び出しているAdjustScrollBars()のほうに最大幅計算の処理も入れてしまえば、最後の全体再描画（こちらでもAdjustScrollBars()を呼び出している）で正しく表示されるんじゃないでしょうか。</div></section>
    <ul><li><section><h1 id=5324>
    <span class="no">[5324]</span>
    <a class="thread-title" href="#5324">Re7:Patchesにアップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-04T21:17:01">2008年06月04日 21:17</time></h1>
    <div class="body">▼ ryojiさん<br>どうもありがとうございます。現象確認できました。<br>相変わらずソースが読み切れてませんでした (^^;<br><br>修正の方なんですが、最大幅の算出の呼び出しを if( bScroll ){ の上に出してしまうというのではまずいですかね？<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=5323>
    <span class="no">[5323]</span>
    <a class="thread-title" href="#5323">Re:水平スクロールバーを常にテキストの幅に合わせる</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-04T20:05:58">2008年06月04日 20:05</time></h1>
    <div class="body">ツリーが深いのでここへ繋げます。<br>修正版をアップしました。<br>　080604_01_TextWrapControl_a1364.zip<br><br>１．1行が最大幅を超える場合、水平スクロール バーのつまみを最右端にすることができない不具合を修正しました。<br><br>２．以下の操作を除いて全ラインの走査をしないようにしました。<br>・最大幅の行で改行を入力する<br>・最大幅の行を含んで削除を実行する<br><br>Undo, Redoや置換で発生する操作も対象に含まれます。<br>普通に入力するぶんには今まで殆ど変わらない負荷となると思います。<br><br>高負荷となるような操作例：<br>・最大幅の行の行頭でEnterキーをリピートする<br>・最大幅の行でDeleteキーまたはBackSpaceキーをリピートする<br></div></section>
    <ul><li><section><h1 id=5325>
    <span class="no">[5325]</span>
    <a class="thread-title" href="#5325">修正版アップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-05T17:51:44">2008年06月05日 17:51</time></h1>
    <div class="body">以下の修正を行いました。<br><br>１．置換ダイアログで置換を実行したとき、スクロールバーの幅が更新されない不具合を修正（dev:5322,5324）<br>２．最大幅の行での文字削除によるカーソル行アンダーラインのちらつきを軽減した<br>３．最大幅の行で改行を入力した場合でも、行頭かつ文字列非選択の場合は全ラインの走査を実行しないようにした（負荷軽減）<br></div></section>
    <ul><li><section><h1 id=5326>
    <span class="no">[5326]</span>
    <a class="thread-title" href="#5326">Re:修正版アップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-05T20:54:51">2008年06月05日 20:54</time></h1>
    <div class="body">ざっとソースコードも眺めてみました。<br>それで、いくつか疑問・コメントがあります。<br><br>１．<br>テキスト最大幅の算出をテキスト変更直後ではなく CEditView::MoveCursor() で遅延実行するのはなぜですか？<br>その場で計算させれば、<br>m_bCalTextWidth<br>m_nCalTextWidthLinesFrom<br>m_nCalTextWidthLinesTo<br>といったややこしいメンバー変数も不要になると思うのですが…<br>あと、以前の計算要求が実行される前に次のテキスト変更があった場合、新たな変更を加えてしまった後で以前の計算要求を実行しているように見えますが、これは何？<br><br>２．<br>テキスト最大幅の算出を CEditView::OnSize() で実行するのはなぜですか？<br>テキスト最大幅は画面サイズには関係無いと思うのですが…<br>CEditView::OnSize() は各ビューのサイズ変更で呼ばれるので、画面を４分割して分割バーを動かすと１度に４回も計算しなおすことになるのでは？<br>テキスト変更時と SetLayoutInfo() のときくらいだけで済ませられないのでしょうか？<br><br>３．<br>CEditView::GetRightEdgeForScrollBar()は「折り返しなし」のときしか使われていないのですが、全モード共通でスクロール最右端の計算をするのに使えれば、もっとすっきりしたものができるかな？と思います。<br>指定幅で折り返す場合にも指定幅ぴったりではなく、右余白（改行／句読点ぶら下げ）が見えるところまでスクロールバーでスクロールできるようになると嬉しいですね。</div></section>
    </li><li><section><h1 id=5330>
    <span class="no">[5330]</span>
    <a class="thread-title" href="#5330">Re:修正版アップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-06T12:54:49">2008年06月06日 12:54</time></h1>
    <div class="body">コードを眺めていて思ったんですが、今は「折り返さない」については最低限の実装（最大長の拡大方向のみ追従）に止めておきませんか？<br>設定やコマンドの追加だけでも結構な量なのに、動作まで厳密さを求めていたらレビュー／テストは滞るばかりで、そのうちまたお蔵入りになってしまいそうな予感。<br>そんなことになるくらいなら、最低限の実装で固めておいて、追加分は追加分としてあとでじっくり煮詰めていくのが良いように思いますけど。今考えているよりも良い案が浮かぶかもしれませんし。<br><br>・最大長の縮小方向への追従<br>・どんなに長くなっても折り返さない<br>・スクロールなしのときはスクロールバーを消す<br><br>といったあたりは後付けでも…<br>＃「読み切れない／意欲が追い付かない」いうのが本音だったりしますけど(^^;</div></section>
    <ul><li><section><h1 id=5331>
    <span class="no">[5331]</span>
    <a class="thread-title" href="#5331">Re2:修正版アップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-06T21:46:12">2008年06月06日 21:46</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; コードを眺めていて思ったんですが、今は「折り返さない」については最低限の実装（最大長の拡大方向のみ追従）に止めておきませんか？<br><br>私はそれでかまいません。<br>ただ、私の中では「最大長の拡大方向のみ追従」というのが「折り返さない」からほんの少し変更しただけの状態なので、いっその事出来の悪い「折り返さない」を削除してしまった方が良い気がしています。<br><br>以下&gt;&gt;dev:5326に対して<br>&gt; １．<br>&gt; テキスト最大幅の算出をテキスト変更直後ではなく CEditView::MoveCursor() で遅延実行するのはなぜですか？<br><br>元々は1回の操作に対して何度も全ライン走査が走らない様にする事を考えていたのですが、負荷軽減をした事で不要になったと思います。<br><br>&gt; あと、以前の計算要求が実行される前に次のテキスト変更があった場合、新たな変更を加えてしまった後で以前の計算要求を実行しているように見えますが、これは何？<br><br>バグです (^^;<br>ループした時のために辻褄を合わせようとして変な事になってます。<br><br>&gt; ２．<br>&gt; テキスト最大幅の算出を CEditView::OnSize() で実行するのはなぜですか？<br>&gt; テキスト最大幅は画面サイズには関係無いと思うのですが…<br><br>最大幅が未算出の時に算出されるようにしていますが、手抜き……かもしれない。<br>未算出の時だけなので、アプリ起動時／ファイル読み込み／設定変更などで最大幅がクリアされなければ殆ど実行されないです。<br>ただ、OnSize()を利用するのは確かに変ですね。<br>SetLayoutInfo()は印刷プレビューとの絡みで躊躇しました。<br><br>ということで、「折り返さない」を削除したものを作成しても良いでしょうか？<br></div></section>
    <ul><li><section><h1 id=5333>
    <span class="no">[5333]</span>
    <a class="thread-title" href="#5333">Re3:修正版アップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-06T22:07:13">2008年06月06日 22:07</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; ということで、「折り返さない」を削除したものを作成しても良いでしょうか？<br><br>当面は「折り返さない」を選択したら最大幅（10240桁）が適用されるようにしておくのでもいいんじゃないでしょうか？<br>まだ本格的に手をつける人がいないから最大幅で代用してるだけ、というつもりで。<br>他エディタにそういう実装のものもちょくちょく見かけますし、あとで変更の話が出たとしてもＵＩ部の作り込みの手間が省けると思います。</div></section>
    <ul><li><section><h1 id=5335>
    <span class="no">[5335]</span>
    <a class="thread-title" href="#5335">Re4:修正版アップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-07T22:40:20">2008年06月07日 22:40</time></h1>
    <div class="body">修正版をアップしました。<br><br>080607_01_TextWrapControl_a1372<br>　&gt;&gt;dev:5326の1,2の取り込みなど。<br><br>080607_02_TextWrapControl_a1372<br>　上記から「折り返しなし」機能を10240桁で折り返しに機能縮小した。<br>　折り返し方法の初期値を「指定幅で折り返す」に変更した。<br><br>「折り返しなし」機能は開発中ということにして、080607_02を使って「右端で折り返す」機能の完成を目指すことにします。<br>でも差分が1300行近い……<br></div></section>
    <ul><li><section><h1 id=5340>
    <span class="no">[5340]</span>
    <a class="thread-title" href="#5340">Re5:修正版アップしました</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-10T21:06:55">2008年06月10日 21:06</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; 修正版をアップしました。<br><br>基本路線としてなすこじさんのパッチで筋の良い感じだったので、それをもとに既存機能も含め細部に修正を加えてみました。<br><br>詳細はPatchesのほうをご覧頂くとして、自分なりにですが、これでおおむね満足なものになったと思ってます。</div></section>
    <ul><li><section><h1 id=5343>
    <span class="no">[5343]</span>
    <a class="thread-title" href="#5343">Re6:修正版アップしました</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-12T00:14:41">2008年06月12日 00:14</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; 詳細はPatchesのほうをご覧頂くとして、自分なりにですが、これでおおむね満足なものになったと思ってます。<br><br>080611_02版で確認しました。<br>私も十分満足のいくものだと思います。<br><br>後は、折角作ったので使ってくれる人がいるといいなぁって感じです (^^;<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=5345>
    <span class="no">[5345]</span>
    <a class="thread-title" href="#5345">ユーザ視点的な感想</a>
    <span class="author">kobake</span>
    <time datetime="2008-06-18T22:18:06">2008年06月18日 22:18</time></h1>
    <div class="body">今更ですが、試用してみました（ryojiさんに作成いただいたUNICODE版パッチにて動作を試させていただきました）。<br>今のところこの件の作業のお手伝いはできそうにないですが、<br>ユーザ視点な感想だけ、勝手ながら述べさせてください。長文失礼致します。。<br><br>◆メニュー文言について<br><br>　「折り返し桁数: XX桁 (XX)」というメニューの意味がわからなかった。<br>　↓<br>　ちょっと考えて、「あぁ、現在の折り返しステータスが表示されているのか」と思ったが、違った。<br>　↓<br>　さらに考えて、「これをクリックすると、このステータスになるのか」という正確な理解にやっとたどり着いた。<br>　↓<br>　「折り返し桁数: XX桁 (XX)」にはわざわざ数字を出しているのに「折り返し方法」のサブメニューには数字が出ていなく、文言の不整合が気持ち悪く感じた。<br>　↓<br>　個人的には「折り返し方法の順次切替」のような文言が直感的かな、と思っています。<br><br><br>◆「指定桁で折り返す」について<br><br>　「指定桁で折り返す」を押すと、桁数入力ダイアログが出て任意の桁数が入力できるのかな、と思ったが、違った。<br>　↓<br>　動作だけを見ると、正直、「折り返さない」と何が違うの？と思った。<br>　↓<br>　どっかに桁数設定があるのかと思い、探した。ちょっと時間かかった。（実はズルしてソースを眺めて探した）<br>　↓<br>　共通設定的な要素だと思ったが、タイプ別設定であることを知って、ちょっと戸惑った。<br><br>一般的なユースケースかは分かりませんが、自分は以下のような使い方をよくします。<br>・「メールの下書きだから72桁で折り返す設定で文章を書こう」<br>・「コマンド文が含まれる文書だから80桁で折り返す設定で文章を書こう」<br>・「50文字で折り返される掲示板への発言の下書きだから、50桁で折り返す設定で文章を書こう」<br><br>今までは、上記目的を果たすために、ウィンドウ幅を目的の桁数に合わせて、<br>「現在のウィンドウ幅で折り返し」をしてから、作業していました。<br>作業中は、他のウィンドウを見ながら作業する等の理由で、<br>状況に応じてウィンドウサイズを変更していました。<br><br>「目的の桁数（桁数は場面によりけり）に折り返し設定をしてから、<br>折り返し位置を保ったままウィンドウサイズを変更する」という操作が<br>以前よりも手軽にできなくなってしまった（毎回設定を変更しなければならない）のが、<br>ちょっと残念です。<br><br>可能であれば、「指定桁で折り返す」のときは毎回、<br>桁数をダイアログ問い合わせするような機能も付けていただけると嬉しいです。<br><br><br>上記機能が付かないにしても、<br>「指定桁で折り返す」の「指定桁」って何？という疑問を多くの方が抱かれる気がするので、せめて「タイプ別設定の指定桁で折り返す」などの文言にしておいたほうが、混乱が起きにくいかな、と思いました。<br><br>さらに言うと、デフォルト設定の「指定桁」が10240なので、<br>「折り返さない」と「指定桁で折り返す」の動作の違いって何？という疑問を抱く方もけっこう出てくると思います。<br>デフォルト値を100などにしておき、「折り返されたことに気づける」ようにしておくと、<br>少しは機能の理解の助けになると思いますが、どうでしょう。<br><br>（文字数オーバーしちゃいましたので、分割投稿させていただきます）</div></section>
    </li><li><section><h1 id=5346>
    <span class="no">[5346]</span>
    <a class="thread-title" href="#5346">ユーザ視点的な感想　つづき</a>
    <span class="author">kobake</span>
    <time datetime="2008-06-18T22:18:48">2008年06月18日 22:18</time></h1>
    <div class="body">（文字数オーバーしちゃいましたので、分割投稿させていただきます）<br><br>◆折り返し設定の保存について<br><br>「折り返し方法」「折り返し桁数」を「タイプ別設定」で保持する利点がよくわかりませんでした。<br>・「設定」メニューの「折り返し方法」から折り返し方法を変更した場合はタイプ別設定にまで影響しちゃうのかしら…。<br>・このウィンドウでは折り返し無し、あのウィンドウでは折り返しあり、でも両者は同タイプの文書…。<br>などなど、なんだかユーザ視点的にはモヤモヤする印象です。<br><br>このモヤモヤは、保存場所が「タイプ別設定」だろうが「共通設定」だろうが変わらないと思います。<br><br>アプリ起動時（ウィンドウオープン時）のデフォルト折り返し設定が、<br>設定 (タイプ別設定 or 共通設定) として保存されている、<br>という動作であれば、個人的には一切のモヤモヤが消えます。<br><br>＃ちなみに、タイプ別設定 or 共通設定どちらが良いかと聞かれたら、すみませんが自分は共通設定を推しちゃいます。。<br><br><br>-- -- --<br>以上、こんなところです。<br>なんだか否定的なことばかり多く書いてしまったように見えて恐縮ですが、ピュアなフィードバック、ということでご参考いただければ、と思います（時期的に今更ですけど）。<br><br>ウィンドウ追従の折り返し機能は、自分も前々から欲しいなぁ、とは思っていたので、<br>今回の対応には感謝しております。よりよい機能に洗練されれば、と思い、<br>辛口ですが純粋な感想を書き残しました。<br></div></section>
    <ul><li><section><h1 id=5347>
    <span class="no">[5347]</span>
    <a class="thread-title" href="#5347">Re:ユーザ視点的な感想　つづき</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-18T23:51:50">2008年06月18日 23:51</time></h1>
    <div class="body">▼ kobakeさん<br>ご意見どうもありがとうございますm(_ _)m<br><br>&gt; ◆メニュー文言について<br>&gt; <br>&gt; 　「折り返し桁数: XX桁 (XX)」にはわざわざ数字を出しているのに「折り返し方法」のサブメニューには数字が出ていなく、文言の不整合が気持ち悪く感じた。<br><br>折り返し桁の変更と折り返し方法の変更なので意味自体がちょっと違うのですが、言われてみれば確かに気持ち悪いかもですね。<br><br>&gt; 　個人的には「折り返し方法の順次切替」のような文言が直感的かな、と思っています。<br><br>ここはちょっと判断がつかないです。<br>ただ、「折り返し方法の順次切替」だと文字列が長いので、この後に数字を付けるとメニューが大きくなりすぎるような気はします。<br>例えば「折り返し方法の順次切替（次は10240桁）」とか (^^;<br><br>&gt; ◆「指定桁で折り返す」について<br>&gt; <br>&gt; 　「指定桁で折り返す」を押すと、桁数入力ダイアログが出て任意の桁数が入力できるのかな、と思ったが、違った。<br>&gt; 　↓<br>&gt; 　動作だけを見ると、正直、「折り返さない」と何が違うの？と思った。<br><br>「指定桁で折り返す」が既存機能そのままという事と、「折り返さない」がまだ育成途中という事があります。<br>「折り返さない」は、スクロールバーがテキストの幅に一致するようになる予定です。<br><br>（省略）<br>&gt; 「目的の桁数（桁数は場面によりけり）に折り返し設定をしてから、<br>&gt; 折り返し位置を保ったままウィンドウサイズを変更する」という操作が<br>&gt; 以前よりも手軽にできなくなってしまった（毎回設定を変更しなければならない）のが、<br>&gt; ちょっと残念です。<br><br>「指定桁で折り返す」が既存機能そのままなので、それを選べばいままで通りです。<br><br>&gt; 可能であれば、「指定桁で折り返す」のときは毎回、<br>&gt; 桁数をダイアログ問い合わせするような機能も付けていただけると嬉しいです。<br><br>これはあり得る対応ですね。ウィンドウ幅とは関係なく折り返し桁を指定したいという事はあるかもしれません。<br><br>&gt; ◆折り返し設定の保存について<br>&gt; <br>&gt; 「折り返し方法」「折り返し桁数」を「タイプ別設定」で保持する利点がよくわかりませんでした。<br><br>（省略）<br><br>&gt; アプリ起動時（ウィンドウオープン時）のデフォルト折り返し設定が、<br>&gt; 設定 (タイプ別設定 or 共通設定) として保存されている、<br>&gt; という動作であれば、個人的には一切のモヤモヤが消えます。<br><br>すみません、ここ意味が読み取れません m(_ _)m<br><br>通常の使用で折り返し方法を頻繁に変更するというのは無いような気がするのですが、どうなんでしょうね？<br><br>そのウィンドウの設定が一時的に変更できる、というのが重要だと思います。<br>問題は、一時設定になっている事をメニューの中でしか表示していない事ではないでしょうか？<br>そのウィンドウを見て一時設定適用中である事が判断できないと私も混乱しそうです。<br><br>&gt; ＃ちなみに、タイプ別設定 or 共通設定どちらが良いかと聞かれたら、すみませんが自分は共通設定を推しちゃいます。。<br><br>私は、基本を1024桁、テキストを120桁、C/C++を512桁の設定にしていたので、タイプ別設定にないと困ります (^^;<br><br>ただ、「折り返さない」が完成した後は、テキスト以外は「折り返さない」に設定予定なので共通設定でもOKですが……<br><br>ではでは。<br></div></section>
    <ul><li><section><h1 id=5351>
    <span class="no">[5351]</span>
    <a class="thread-title" href="#5351">Re2:ユーザ視点的な感想　つづき</a>
    <span class="author">kobake</span>
    <time datetime="2008-06-20T00:16:11">2008年06月20日 00:16</time></h1>
    <div class="body">▼ なすこじさん<br>&gt; &gt; ◆メニュー文言について<br>&gt; &gt; <br>&gt; &gt; 　「折り返し桁数: XX桁 (XX)」にはわざわざ数字を出しているのに「折り返し方法」のサブメニューには数字が出ていなく、文言の不整合が気持ち悪く感じた。<br>&gt; <br>&gt; 折り返し桁の変更と折り返し方法の変更なので意味自体がちょっと違うのですが、言われてみれば確かに気持ち悪いかもですね。<br><br>むむむ、さらに自分は勘違いをしていたようです。<br>Ctrl+Alt+U は桁数の切替のみなのですね。。。説明されてやっと理解した…気がします。<br>ただ、理解した(？)後でも、実際にメニューを使う度に「どんな仕様だったっけ」と説明を読み直しています。。<br><br>考えられる折り返しパターン（折り返し方法と折り返し桁のポリシー）を<br>簡潔に説明できますか？（「簡潔さ」は設計においてもユーザの理解においても重要です）<br><br><br>&gt; &gt; 　個人的には「折り返し方法の順次切替」のような文言が直感的かな、と思っています。<br>&gt; <br>&gt; ここはちょっと判断がつかないです。<br>&gt; ただ、「折り返し方法の順次切替」だと文字列が長いので、この後に数字を付けるとメニューが大きくなりすぎるような気はします。<br>&gt; 例えば「折り返し方法の順次切替（次は10240桁）」とか (^^;<br><br>上で気づきましたが、順次切替では無いのですね (もともとのCtrl+Alt+Uの挙動と同じだという思い込みがありました)。<br>なので、この文言はどっちみち誤りなので取り下げます。ちなみに、「折り返し方法の順次切替」の後に数字を付ける想定ではなく、単に「折り返し方法の順次切替」とするだけの想定で提案しました。<br><br><br>&gt; &gt; ◆「指定桁で折り返す」について<br>&gt; &gt; 　動作だけを見ると、正直、「折り返さない」と何が違うの？と思った。<br>&gt; 「指定桁で折り返す」が既存機能そのままという事と、「折り返さない」がまだ育成途中という事があります。<br>&gt; 「折り返さない」は、スクロールバーがテキストの幅に一致するようになる予定です。<br><br>なるほど、「折り返さない」の挙動は了解です。<br><br><br>&gt; &gt; 「目的の桁数（桁数は場面によりけり）に折り返し設定をしてから、<br>&gt; &gt; 折り返し位置を保ったままウィンドウサイズを変更する」という操作が<br>&gt; &gt; 以前よりも手軽にできなくなってしまった（毎回設定を変更しなければならない）のが、<br>&gt; &gt; ちょっと残念です。<br>&gt; <br>&gt; 「指定桁で折り返す」が既存機能そのままなので、それを選べばいままで通りです。<br><br>「桁数を変える度に」「毎回設定を変更しなければならない」のは変わりませんよね？（自分はそのことを、「手軽でなくなった」と言いました）<br><br><br>（文字数制限につき投稿を分割します）</div></section>
    <ul><li><section><h1 id=5361>
    <span class="no">[5361]</span>
    <a class="thread-title" href="#5361">Re3:ユーザ視点的な感想　つづき</a>
    <span class="author">なすこじ</span>
    <time datetime="2008-06-23T01:48:59">2008年06月23日 01:48</time></h1>
    <div class="body">見落としてました m(_ _)m<br>必要そうなとこだけコメントします。<br><br>&gt; ただ、理解した(？)後でも、実際にメニューを使う度に「どんな仕様だったっけ」と説明を読み直しています。。<br>&gt; <br>&gt; 考えられる折り返しパターン（折り返し方法と折り返し桁のポリシー）を<br>&gt; 簡潔に説明できますか？（「簡潔さ」は設計においてもユーザの理解においても重要です）<br><br>A：折り返さない（現在は不完全対応）<br>　折り返さずに改行までを1行で表示する。<br>　スクロールバーがテキストの最大幅に一致する。<br>　利点としては<br>　　・スクロールバーからそのテキストの横幅が大体判る<br>　　・余分な領域へスクロールする事が少ない<br>　　・横幅が長くなっても折り返し桁の再調整が不要<br><br>B：指定幅で折り返す（既存機能）<br>　ユーザが指定した幅で折り返す。<br>　折り返し位置を動的に変更はしない。<br><br>C：ウィンドウ幅で折り返す<br>　ウィンドウ幅の変更に追従して折り返し位置を変更する。<br>　利点としては<br>　　・テキストが横にはみ出ないので横スクロールする必要がない<br><br>上記の通りです。<br>元々処理能力の問題からBのみ存在していたと思います。<br>Bの中で、<br>　B1：アプリの最大幅（10240桁）に折り返し位置を設定する<br>　B2：タイプ別設定の桁数に折り返し位置を設定する<br>　B3：現在表示中のウィンドウ幅に折り返し位置を設定する<br>があり、AをB1で、CをB3で代用していた様な状態ですね。<br></div></section>
    </li></ul></li><li><section><h1 id=5352>
    <span class="no">[5352]</span>
    <a class="thread-title" href="#5352">Re2:ユーザ視点的な感想　つづき</a>
    <span class="author">kobake</span>
    <time datetime="2008-06-20T00:16:35">2008年06月20日 00:16</time></h1>
    <div class="body">（文字数制限につき投稿を分割します）<br><br>&gt; &gt; アプリ起動時（ウィンドウオープン時）のデフォルト折り返し設定が、<br>&gt; &gt; 設定 (タイプ別設定 or 共通設定) として保存されている、<br>&gt; &gt; という動作であれば、個人的には一切のモヤモヤが消えます。<br>&gt; <br>&gt; すみません、ここ意味が読み取れません m(_ _)m<br><br>具体的に説明しますと、以下のような感じです。<br><br>・折り返し方法は、ウィンドウ毎に個別に一時的に設定するポリシー。<br>・タイプ別設定は「デフォルトの折り返し方法」を保持する。<br>・ウィンドウが生成された時点での折り返し方法は、タイプ別設定が保持する「デフォルトの折り返し方法」に従う。<br>・タイプ別設定の「デフォルトの折り返し方法」を変更した場合、それはあくまでもウィンドウ生成時に用いられるデフォルト値であるため、既に存在するウィンドウには影響を与えない。<br>・ウィンドウ個別の折り返し方法を変更した場合、それはあくまでもウィンドウ個別の設定であるので、他の既存のウィンドウにも、タイプ別設定にも、影響は与えない。<br><br><br>&gt; 通常の使用で折り返し方法を頻繁に変更するというのは無いような気がするのですが、どうなんでしょうね？<br><br>とりあえずユーザのうちの1人の自分は、<br>割と頻繁に折り返し方法を変更します。<br><br><br>&gt; &gt; ＃ちなみに、タイプ別設定 or 共通設定どちらが良いかと聞かれたら、すみませんが自分は共通設定を推しちゃいます。。<br>&gt; <br>&gt; 私は、基本を1024桁、テキストを120桁、C/C++を512桁の設定にしていたので、タイプ別設定にないと困ります (^^;<br><br>なるほど。では反対はしません。<br><br></div></section>
    </li></ul></li><li><section><h1 id=5349>
    <span class="no">[5349]</span>
    <a class="thread-title" href="#5349">Re:ユーザ視点的な感想　つづき</a>
    <span class="author">ryoji</span>
    <time datetime="2008-06-19T02:15:13">2008年06月19日 02:15</time></h1>
    <div class="body">▼ kobakeさん<br><br>ご意見ありがとうございます。<br><br>表記については、自分としては、それなりに考えてとりあえず今の形にしました。<br>観点としては、簡潔で、他エディタと似通った表記を採用する、というくらいでしょうか。<br>自分では違和感を感じないものにしたつもりではありますが、モヤモヤするというのも、さもありなんという感じです。<br>直感的か、好みに合うか、については個人差が大きく出るので何とも言えません。<br>これまでも、些細なことでどうにも意見がかみ合わない、参加する人の数だけ提案がある、ということは何度もありまして。<br><br>ほんの少し慣れてもらえば済む程度、ちょっと変えても現実問題として大差無かったなぁ、みたいなことも。<br>今回のは従来機能との絡みもあって、少々ややこしくなっているのかな？と思います。<br><br>&gt;&gt;dev:5304 でも述べたとおり、「細部まで仕様を練って他の人たちと調整するのが面倒」なので、とりあえず自分仕様で作って投下するので、特に強いこだわりがあるようなら、以後はその人が他の人たちの意見をとりまとめていただけたらなぁ、と思っております。<br><br>タイプ別設定か共通設定か、ということについては、他エディタもほとんどタイプ別のほうですし、自分もそれで何の違和感もありませんけど、どうなんでしょう？<br>たとえば「右端で折り返す」を好んで使う人は、どんな文書でも必ず、まずはそれで開いてほしいと思っているんでしょうかね？<br>自分は「右端で折り返す」や「折り返さない」はコマンドからの一時設定でしか使わないと思うので、自分用途に限れば設定として保存できる必要はまったくありません。従来通りタイプ別設定で折り返し桁数が指定できれば十分です。<br><br>最近ではだいぶ試用者が見込めるようになったUNICODE版に入れてしまって評価してもらうのがいいのかしら？</div></section>
    <ul><li><section><h1 id=5353>
    <span class="no">[5353]</span>
    <a class="thread-title" href="#5353">Re2:ユーザ視点的な感想　つづき</a>
    <span class="author">kobake</span>
    <time datetime="2008-06-20T00:16:51">2008年06月20日 00:16</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; 表記については、自分としては、それなりに考えてとりあえず今の形にしました。<br>&gt; 観点としては、簡潔で、他エディタと似通った表記を採用する、というくらいでしょうか。<br>&gt; 自分では違和感を感じないものにしたつもりではありますが、モヤモヤするというのも、さもありなんという感じです。<br>&gt; 直感的か、好みに合うか、については個人差が大きく出るので何とも言えません。<br>&gt; これまでも、些細なことでどうにも意見がかみ合わない、参加する人の数だけ提案がある、ということは何度もありまして。<br>&gt; <br>&gt; ほんの少し慣れてもらえば済む程度、ちょっと変えても現実問題として大差無かったなぁ、みたいなことも。<br>&gt; 今回のは従来機能との絡みもあって、少々ややこしくなっているのかな？と思います。<br><br>議論を煮詰めるあまり、進行が遅くなるのは避けたいところです。<br>ただ、簡単な変更で大きな効果を得られる（かもしれない）提案項目に関しては<br>前向きにご検討いただければ幸いです。<br><br><br>&gt; タイプ別設定か共通設定か、ということについては、他エディタもほとんどタイプ別のほうですし、自分もそれで何の違和感もありませんけど、どうなんでしょう？<br>&gt; たとえば「右端で折り返す」を好んで使う人は、どんな文書でも必ず、まずはそれで開いてほしいと思っているんでしょうかね？<br><br>たぶんトリッキーな使い方なので、あえて説明はしませんが<br>場面によっては「どんな文書でもそれで開いてほしい」ことは、自分の場合、あります。<br><br>逆に、自分は、タイプ別設定で折り返し情報を保存することの利点が分からなかったから、「共通設定でいいじゃん」的に単純に思っただけなのですが、少なくとも、それ（タイプ別設定での保持）を必要とする方がおられることが分かりましたので、今の時点での自分の意見は「タイプ別設定で良い」です。<br><br><br>&gt; 最近ではだいぶ試用者が見込めるようになったUNICODE版に入れてしまって評価してもらうのがいいのかしら？<br><br>個人的には、コミットしてしまって良いと思います。<br>第三者のフィードバックほど貴重なものはないので。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></body></html>