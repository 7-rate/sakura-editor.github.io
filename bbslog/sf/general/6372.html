<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css">
  <link rel="shortcut icon" href="favicon.ico">
  <title>印刷/印刷プレビューで落ちる | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">6372</span>
    <a class="thread-title" href="6372.html#6372">印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6388</span>
    <a class="thread-title" href="6372.html#6388">Re:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6389</span>
    <a class="thread-title" href="6372.html#6389">Re2:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6391</span>
    <a class="thread-title" href="6372.html#6391">Re3:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6392</span>
    <a class="thread-title" href="6372.html#6392">Re4:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6393</span>
    <a class="thread-title" href="6372.html#6393">Re5:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6395</span>
    <a class="thread-title" href="6372.html#6395">Re6:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6396</span>
    <a class="thread-title" href="6372.html#6396">Re7:印刷/印刷プレビューで落ちる</a></div>
    </li><li><div class="list-title">
    <span class="no">6401</span>
    <a class="thread-title" href="6372.html#6401">Re7:印刷/印刷プレビューで落ちる</a></div>
    </li><li><div class="list-title">
    <span class="no">6402</span>
    <a class="thread-title" href="6372.html#6402">Re7:印刷/印刷プレビューで落ちる</a></div>
    </li><li><div class="list-title">
    <span class="no">6418</span>
    <a class="thread-title" href="6372.html#6418">Re7:印刷/印刷プレビューで落ちる</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">6390</span>
    <a class="thread-title" href="6372.html#6390">Re:印刷/印刷プレビューで落ちる</a></div>
    <ul><li><div class="list-title">
    <span class="no">6394</span>
    <a class="thread-title" href="6372.html#6394">Re2:印刷/印刷プレビューで落ちる</a></div>
    </li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=6372>
    <span class="no">[6372]</span>
    <a class="thread-title" href="#6372">印刷/印刷プレビューで落ちる</a>
    <span class="author">doju</span>
    <time datetime="2007-10-16T15:37:03">2007年10月16日 15:37</time></h1>
    <div class="body">はじめまして。<br>sakuraの問題かそれ以外の問題なのかいまいち切り分けが<br>つかないため、ひとまずこちらに投稿させていただきます。<br>1.5.17.0および1.6.0.0で印刷、もしくは印刷プレビューを<br>実行すると、しばらく応答がなくなった後<br>「"0x0044657b" の命令が "0x00000008" のメモリを参照しました。メモリが "written" になることはできませんでした。」<br>のメッセージでsakuraが落ちます。<br>sakuraに一文字も入力しない状態でプレビューすると症状は<br>発生しませんが、何らかの入力がある状態ではほぼ確実に<br>発生します(1、2文字であれば落ちない「こともある」のですが)。<br><br>他のアプリ(Word(2000/2003)、Excel(2000/2003)、メモ帳、<br>IE(6)、Firefox(2.0.0.7))では同様の症状は発生しません。<br>また、最近PCを入れ替えてOSからクリーンインストールした<br>後にsakuraを導入したのですが、やはり症状再現します。<br>……が、まったく別の環境でsakuraを動かした場合、<br>同じバージョンでも症状が再現しませんでした。<br>(症状が出るのは職場の環境で、別の環境というのは<br>自宅の環境です)<br>プリンタドライバが怪しいかと思い、Office2003の<br>仮想プリンタ以外を全て削除してみましたが状況に<br>変わりありませんでした。<br><br>職場の環境は<br>・Windows XP Pro SP2<br>・Office 2003、2000(IMEは2003)<br>・IE6<br>・プリンタ NEC MultiWriter2300(標準)、NEC MULTINA ALPHA、<br>　Microsoft Office Document Image Writer<br>自宅環境は<br>・Windows XP Pro SP2<br>・Office 2003<br>・IE6<br>・プリンタ　Konica magicolor2530DL、Fine Print5(標準)、<br>　Microsoft Office Document Image Writer<br>いずれもWindows、IEのアップデートはWindows Updateで<br>公開されたものは全て適用済みです。<br>ご面倒とは存じますがお調べいただけないでしょうか?<br>よろしくお願い申し上げます。</div></section>
    <ul><li><section><h1 id=6388>
    <span class="no">[6388]</span>
    <a class="thread-title" href="#6388">Re:印刷/印刷プレビューで落ちる</a>
    <span class="author">じゅうじ</span>
    <time datetime="2007-10-20T12:17:19">2007年10月20日 12:17</time></h1>
    <div class="body">▼ dojuさん<br>&gt; 1.5.17.0および1.6.0.0で印刷、もしくは印刷プレビューを<br>&gt; 実行すると、しばらく応答がなくなった後<br>&gt; 「"0x0044657b" の命令が "0x00000008" のメモリを参照しました。メモリが "written" になることはできませんでした。」<br>&gt; のメッセージでsakuraが落ちます。<br><br>1.5.17.0 -&gt; 0x004453E3<br>1.6.0.0  -&gt; 0x0044657B ですね。<br><br>&gt; ……が、まったく別の環境でsakuraを動かした場合、<br>&gt; 同じバージョンでも症状が再現しませんでした。<br>&gt; (症状が出るのは職場の環境で、別の環境というのは<br>&gt; 自宅の環境です)<br><br>それは大丈夫なんです。<br><br>&gt; プリンタドライバが怪しいかと思い、Office2003の<br>&gt; 仮想プリンタ以外を全て削除してみましたが状況に<br>&gt; 変わりありませんでした。<br><br>大変参考になります。Winows の再起動もなさいました？<br><br>CLayout* CLayoutMgr::CreateLayout(省略)<br>１行目の Yahoo!/Junk/data-6388(temp)<br>&#9;CLayout* pLayout = new CLayout;<br>で、new を失敗して、予想では pLayout = NULL; になっている。<br>結論：<br>メモリーが足りない？ &gt;&gt;印刷チーム</div></section>
    <ul><li><section><h1 id=6389>
    <span class="no">[6389]</span>
    <a class="thread-title" href="#6389">Re2:印刷/印刷プレビューで落ちる</a>
    <span class="author">げんた</span>
    <time datetime="2007-10-20T17:02:51">2007年10月20日 17:02</time></h1>
    <div class="body">&gt;CLayout* CLayoutMgr::CreateLayout(省略)<br>&gt;１行目の Yahoo!/Junk/data-6388(temp)<br>を見ましたが，なんかアドレスが違うのでどこを見たのかいまいちわからず．<br>じゅうじさんのところで再現できました？<br>こちらで再現できないのでDr. Watsonのログを取るようお願いしたいと思ったのですが，Windows XPでは自動的には作られない？みたいでどのようにお願いしたらよいのか困っていたところなんです．<br></div></section>
    <ul><li><section><h1 id=6391>
    <span class="no">[6391]</span>
    <a class="thread-title" href="#6391">Re3:印刷/印刷プレビューで落ちる</a>
    <span class="author">doju</span>
    <time datetime="2007-10-22T09:14:05">2007年10月22日 09:14</time></h1>
    <div class="body">　ご返答ありがとうございます。<br>▼ じゅうじさん<br>すみません、バージョンによって報告アドレスが異なる可能性を失念していました。<br>第一報のエラーは1.6.0.0で実行した際のものでした。<br><br>&gt; 大変参考になります。Winows の再起動もなさいました？<br><br>　再起動は試していませんでしたので、再起動直後に状況再現するかどうか<br>試してみました。結果はやはり同様に落ちてしまいました。<br><br>▼ げんたさん<br>&gt; こちらで再現できないのでDr. Watsonのログを取るようお願いしたいと思ったのですが，Windows XPでは自動的には作られない？みたいでどのようにお願いしたらよいのか困っていたところなんです．<br>　Dr.Watsonのログは取ってみましたが、うっかりしていまして、<br>サクラエディタのバージョン1.6.1.0(V 1310)で取ってしまいました。<br>　そちらで構わなければ、お送りしたいと思いますが<br>どのようにすればよろしいでしょうか?<br>(1.6.0.0でのログが必要でしたら、取り直します)</div></section>
    <ul><li><section><h1 id=6392>
    <span class="no">[6392]</span>
    <a class="thread-title" href="#6392">Re4:印刷/印刷プレビューで落ちる</a>
    <span class="author">げんた</span>
    <time datetime="2007-10-22T23:26:31">2007年10月22日 23:26</time></h1>
    <div class="body">&gt;　Dr.Watsonのログは取ってみましたが、うっかりしていまして、<br>&gt;サクラエディタのバージョン1.6.1.0(V 1310)で取ってしまいました。<br>&gt;　そちらで構わなければ、お送りしたいと思いますが<br>こちらも最新版で取っていただいた方がよいと思っていたのでありがたいです．<br><br>&gt;どのようにすればよろしいでしょうか?<br>適当にWikiのJunkにでも新しいページを作って添付していただければと思います．<br></div></section>
    <ul><li><section><h1 id=6393>
    <span class="no">[6393]</span>
    <a class="thread-title" href="#6393">Re5:印刷/印刷プレビューで落ちる</a>
    <span class="author">doju</span>
    <time datetime="2007-10-23T08:12:38">2007年10月23日 08:12</time></h1>
    <div class="body">▼ げんたさん<br>&gt; 適当にWikiのJunkにでも新しいページを作って添付していただければと思います．<br>http://sakura.qp.land.to/?Junk%2F35<br>を作成して、そちらに「プリントで落ちるdrwtsn32.log」として<br>置かせていただきました。<br>Wikiにも書きましたが会社名・PC名等は削除させていただいております。<br>よろしくお願いいたします。</div></section>
    <ul><li><section><h1 id=6395>
    <span class="no">[6395]</span>
    <a class="thread-title" href="#6395">Re6:印刷/印刷プレビューで落ちる</a>
    <span class="author">ryoji</span>
    <time datetime="2007-10-24T20:21:14">2007年10月24日 20:21</time></h1>
    <div class="body">▼ dojuさん<br>&gt; http://sakura.qp.land.to/?Junk%2F35<br>&gt; を作成して、そちらに「プリントで落ちるdrwtsn32.log」として<br>&gt; 置かせていただきました。<br>ログを解析してみました。<br>呼び出し元は、CLayoutMgr.cppの347行目。<br>そこが繰返し無限に呼び出された結果、じゅうじさんの推測どおりnew CLayoutに失敗して落ちてるんじゃないかと。<br><br>上記推測のもと、印刷ページ設定で、<br>A4縦<br>フォント幅:100<br>段数:4<br>左余白:50<br>右余白:50<br>のような設定をしてみたところ、再現しました。<br>上記設定にすると、行あたりの文字数がゼロになります。<br><br>印刷ページ設定の画面で「行あたりの文字数」がゼロに近い値になっていないか確認してください＞dojuさん<br>対策としては印刷の前にエラーメッセージを出すとか？<br>制限する桁数は、画面表示と同じ10桁くらい？<br>印刷関連はこれまで見たこと無いのでこのくらいで。<br>・・・・・・・　(；^^)</div></section>
    <ul><li><section><h1 id=6396>
    <span class="no">[6396]</span>
    <a class="thread-title" href="#6396">Re7:印刷/印刷プレビューで落ちる</a>
    <span class="author">ryoji</span>
    <time datetime="2007-10-24T20:39:07">2007年10月24日 20:39</time></h1>
    <div class="body">ちょっと訂正。<br>&gt; 呼び出し元は、CLayoutMgr.cppの347行目。<br>CLayoutMgr_New.cppの347行目、です。</div></section>
    </li><li><section><h1 id=6401>
    <span class="no">[6401]</span>
    <a class="thread-title" href="#6401">Re7:印刷/印刷プレビューで落ちる</a>
    <span class="author">じゅうじ</span>
    <time datetime="2007-10-25T07:15:48">2007年10月25日 07:15</time></h1>
    <div class="body">▼ ryojiさん<br>GJ!<br><br>ちょっと大げさだけど、開いてた編集中のテキストいつもどおり上書きして後ろ半分全部消えた！<br>ファンクラブに書ける内容ではないので、ここに。気をつけましょう。&gt;&gt; 印刷チーム</div></section>
    </li><li><section><h1 id=6402>
    <span class="no">[6402]</span>
    <a class="thread-title" href="#6402">Re7:印刷/印刷プレビューで落ちる</a>
    <span class="author">げんた</span>
    <time datetime="2007-10-25T08:16:09">2007年10月25日 08:16</time></h1>
    <div class="body">&gt;呼び出し元は、CLayoutMgr_New.cppの347行目。<br>&gt;そこが繰返し無限に呼び出された結果、じゅうじさんの推測どおりnew CLayoutに失敗して落ちてるんじゃないかと。<br>あー，なるほど...<br>while( nPos &lt; nLineLen - nEol_1 )<br>の条件がいつまでたってもfalseにならないから永遠に回ってしまう，と．<br><br>＞制限する桁数は、画面表示と同じ10桁くらい？<br>１ページあたり一文字で超拡大印刷...はできないですね．フォントサイズが100で制限されている．<br></div></section>
    </li><li><section><h1 id=6418>
    <span class="no">[6418]</span>
    <a class="thread-title" href="#6418">Re7:印刷/印刷プレビューで落ちる</a>
    <span class="author">doju</span>
    <time datetime="2007-10-29T09:42:47">2007年10月29日 09:42</time></h1>
    <div class="body">▼ ryojiさん<br>&gt; ▼ dojuさん<br>&gt; &gt; http://sakura.qp.land.to/?Junk%2F35<br>&gt; &gt; を作成して、そちらに「プリントで落ちるdrwtsn32.log」として<br>&gt; &gt; 置かせていただきました。<br>&gt; ログを解析してみました。<br>&gt; 呼び出し元は、CLayoutMgr.cppの347行目。<br>&gt; そこが繰返し無限に呼び出された結果、じゅうじさんの推測どおりnew CLayoutに失敗して落ちてるんじゃないかと。<br>&gt; <br>&gt; 上記推測のもと、印刷ページ設定で、<br>&gt; A4縦<br>&gt; フォント幅:100<br>&gt; 段数:4<br>&gt; 左余白:50<br>&gt; 右余白:50<br>&gt; のような設定をしてみたところ、再現しました。<br>&gt; 上記設定にすると、行あたりの文字数がゼロになります。<br>&gt; <br>&gt; 印刷ページ設定の画面で「行あたりの文字数」がゼロに近い値になっていないか確認してください＞dojuさん<br>&gt; 対策としては印刷の前にエラーメッセージを出すとか？<br>&gt; 制限する桁数は、画面表示と同じ10桁くらい？<br>&gt; 印刷関連はこれまで見たこと無いのでこのくらいで。<br>&gt; ・・・・・・・　(；^^)<br><br>確認してみました。<br>何のことはない、用紙サイズの設定が入っていないだけでした……<br>(そのため「行あたりの文字数」には何も表示されていませんでした。<br>内部的には0になっているのでしょうか)<br>用紙サイズを適切に設定して「行あたりの文字数」が極端に小さい値でないことを<br>確認した上でプレビューを行うと問題なく実行できました。<br>些細な設定ミスで皆様のお手を煩わせてしまい、申し訳ありませんでした。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=6390>
    <span class="no">[6390]</span>
    <a class="thread-title" href="#6390">Re:印刷/印刷プレビューで落ちる</a>
    <span class="author">じゅうじ</span>
    <time datetime="2007-10-20T18:18:03">2007年10月20日 18:18</time></h1>
    <div class="body">▼ げんたさん<br>&gt;1.5.17.0および1.6.0.0で印刷、もしくは印刷プレビューを<br>&gt;実行すると、しばらく応答がなくなった後<br>&gt;「"0x0044657b" の命令が "0x00000008" のメモリを参照しました。メモリが "written" になることはできませんでした。」<br>&gt;のメッセージでsakuraが落ちます。<br><br>Yahoo!/Junk/プリントで落ちるSVN(temp)<br>1.6.0.0 でのアドレスからすると、CLayoutのコンストラクタが戻り値０で失敗しています。<br><br>私のPCでは再現していません。<br>ワトソン博士もこれくらいの情報だと思います。＼○／□</div></section>
    <ul><li><section><h1 id=6394>
    <span class="no">[6394]</span>
    <a class="thread-title" href="#6394">Re2:印刷/印刷プレビューで落ちる</a>
    <span class="author">げんた</span>
    <time datetime="2007-10-24T20:19:14">2007年10月24日 20:19</time></h1>
    <div class="body">&gt;Yahoo!/Junk/プリントで落ちるSVN(temp)<br>&gt;1.6.0.0 でのアドレスからすると、CLayoutのコンストラクタが戻り値０で失敗しています。<br>mapファイルの最初のアドレスはオフセットで，後ろのアドレスが実際のものになるんですね．<br>じゅうじさんの解析通りでした．NULLとなる理由がメモリ確保の失敗という点は私も同意です．<br><br>&gt;しばらく応答がなくなった後<br>というのが気になるのですけど...ここで何が起こっているのか？？<br><br>もしメモリ不足であれば，タスクマネージャでどんどんメモリ使用量が増加するのが見えると思います．<br>この点を実際に確認できますか？できれば内容が少ない状態で．(数行程度)<br></div></section>
    </li></ul></li></ul></li></ul></body></html>