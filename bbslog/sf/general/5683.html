<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css">
  <link rel="shortcut icon" href="favicon.ico">
  <title>UTF-8をSJISにご認識するらしい | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">5683</span>
    <a class="thread-title" href="5683.html#5683">UTF-8をSJISにご認識するらしい</a></div>
    <ul><li><div class="list-title">
    <span class="no">5684</span>
    <a class="thread-title" href="5683.html#5684">Re:UTF-8をSJISに誤認識するらしい</a></div>
    </li><li><div class="list-title">
    <span class="no">5687</span>
    <a class="thread-title" href="5683.html#5687">Re:UTF-8をSJISにご認識するらしい</a></div>
    <ul><li><div class="list-title">
    <span class="no">5688</span>
    <a class="thread-title" href="5683.html#5688">Re2:UTF-8をSJISにご認識するらしい</a></div>
    <ul><li><div class="list-title">
    <span class="no">5690</span>
    <a class="thread-title" href="5683.html#5690">Re3:UTF-8をSJISにご認識するらしい</a></div>
    <ul><li><div class="list-title">
    <span class="no">5692</span>
    <a class="thread-title" href="5683.html#5692">Re4:UTF-8をSJISにご認識するらしい</a></div>
    <ul><li><div class="list-title">
    <span class="no">5733</span>
    <a class="thread-title" href="5683.html#5733">ありがとうございました</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5700</span>
    <a class="thread-title" href="5683.html#5700">早速Closeされたので、公告</a></div>
    </li></ul></li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=5683>
    <span class="no">[5683]</span>
    <a class="thread-title" href="#5683">UTF-8をSJISにご認識するらしい</a>
    <span class="author">穂下</span>
    <time datetime="2006-12-15T16:37:11">2006年12月15日 16:37</time></h1>
    <div class="body">ほとんどがASCIIコードで、日本語が数文字しか入っていない<br>UTF-8のファイルを開く際に、毎回、<br>「このファイルは前回は別の文字コードUTF-8で開かれています。<br>前回と同じ文字コードを使いますか？」<br>と表示されてしまいます。<br>例えば、「穂下」という日本語だけふくまれているUTF-8のファイルで起こります。<br>（自分の本名（4文字）も同じ現象でした。）<br><br>どうも、毎回、文字コード判別をし、SJISと判定しているみたいですね。<br>これまで開いたファイルの文字コードは.iniファイルに保存されているようなので、<br>文字判別をするのは、開いたことのないファイルだけにし、<br>履歴にあるファイルは、最後に開いた形式で無条件に開くようにしていただけないでしょうか。<br>毎回、「はい」「いいえ」「キャンセル」を答えなければいけないので、<br>面倒です。<br><br><br></div></section>
    <ul><li><section><h1 id=5684>
    <span class="no">[5684]</span>
    <a class="thread-title" href="#5684">Re:UTF-8をSJISに誤認識するらしい</a>
    <span class="author">穂下</span>
    <time datetime="2006-12-15T16:56:17">2006年12月15日 16:56</time></h1>
    <div class="body">タイトル誤変換しました。すみません。<br><br>他には「株式会社三菱」<br>という日本語だけ入ってる場合でもそうですね。<br>何度保存しなおしてもそうでした。<br><br>「UTF-8で保存するために日本語を埋めておく」<br>と長い文章を入れたファイルは、メッセージが出ず、<br>すぐに開いてくれます。<br></div></section>
    </li><li><section><h1 id=5687>
    <span class="no">[5687]</span>
    <a class="thread-title" href="#5687">Re:UTF-8をSJISにご認識するらしい</a>
    <span class="author">じゅうじ</span>
    <time datetime="2006-12-16T14:17:59">2006年12月16日 14:17</time></h1>
    <div class="body">▼ 穂下さん<br>&gt; どうも、毎回、文字コード判別をし、SJISと判定しているみたいですね。<br>&gt; これまで開いたファイルの文字コードは.iniファイルに保存されているようなので、文字判別をするのは、開いたことのないファイルだけにし、履歴にあるファイルは、最後に開いた形式で無条件に開くようにしていただけないでしょうか。<br>&gt; 毎回、「はい」「いいえ」「キャンセル」を答えなければいけないので、面倒です。<br><br>補足説明すると、共通設定メニューに有る、<br>「前回と異なる文字コードのとき問い合わせを行う(Q)」<br>の、チェックを外した時の動作を、自分のMy 履歴(SAKURA.INI)から取って来るように変えて欲しい。<br>と言う事ですね、私も賛成です。</div></section>
    <ul><li><section><h1 id=5688>
    <span class="no">[5688]</span>
    <a class="thread-title" href="#5688">Re2:UTF-8をSJISにご認識するらしい</a>
    <span class="author">maru</span>
    <time datetime="2006-12-16T16:46:19">2006年12月16日 16:46</time></h1>
    <div class="body">#1513775にあるように文字コード判別処理の改善は、ラスティブさんとげんたさんが検討をすすめていらっしゃるので、とりあえず設定部分のみ暫定変更案です。<br><br>ほとんどのユーザにとっては、前回開いた文字コードを継承しても、問題となる可能性は少ないと思われ、設定の分かりやすさと問い合わせダイアログが出る手間とのバランスを考えると、自動認識優先と前回文字コード優先の２択がシンプルで良いように思います。<br><br>問い合わせダイアログが表示されたときに、自動認識を選択しなければならないケースというと、自動認識が正しかったのに敢えて異なる文字コードで開いた場合か、文字コード混在のファイルの場合などで、かなり非一般的な状況だと思います。<br><br>#1616869<br>「前回と異なる文字コードのとき問い合わせを行う(&amp;Q)」を「前回開いた文字コードを優先する(&amp;Q)」に変更して、自動認識優先と前回文字コード優先の２択にするパッチです。<br></div></section>
    <ul><li><section><h1 id=5690>
    <span class="no">[5690]</span>
    <a class="thread-title" href="#5690">Re3:UTF-8をSJISにご認識するらしい</a>
    <span class="author">げんた</span>
    <time datetime="2006-12-16T19:54:58">2006年12月16日 19:54</time></h1>
    <div class="body">&gt;#1513775にあるように文字コード判別処理の改善は、ラスティブさんとげんたさんが検討をすすめていらっしゃるので<br>実はいつでも置き換えられるのですが，以前より悪化するケースがあるかどうかが不明なので放置気味になっております．<br><br>&gt;自動認識優先と前回文字コード優先の２択<br>以前にこの話が出たときはうやむやのままスルーしてしまった気がしますが，がんばって思い出してみますと，<br>現在の選択肢は「自動認識優先」と「尋ねる」の2種類で「前回の設定優先」が無い，<br>そして自動認識優先は使う必要が無いんじゃないの？という話だったように思います．<br><br>自動認識優先優先だと，意図せずにコードが変わってしまう可能性があるのでは？<br>例えばSJISのデータの後ろに意図せずにEUCデータが混入してEUCと認識されたとします．<br>しかし，元々SJISの部分はEUCで解釈出来ず，解釈出来ない部分は素通しになるので，文章の先頭部分を見るとSJISで開かれたように見えます．そしてそのまま保存するとファイルがEUCになってしまいます．<br><br>自動認識まかせだとこのように意図しないコードで開かれたことに気付かないケースが出てくるので「尋ねる」or「前回優先」の組み合わせがbetterかと思いますが，いかがでしょうか．<br></div></section>
    <ul><li><section><h1 id=5692>
    <span class="no">[5692]</span>
    <a class="thread-title" href="#5692">Re4:UTF-8をSJISにご認識するらしい</a>
    <span class="author">じゅうじ</span>
    <time datetime="2006-12-16T23:25:51">2006年12月16日 23:25</time></h1>
    <div class="body">▼ maruさん<br>&gt; #1616869<br>いつも自動判別を優先する必要性は無いと思います。<br><br>▼ げんたさん<br>&gt; 自動認識まかせだとこのように<br>&gt; 意図しないコードで開かれたことに気付かない<br>&gt; ケースが出てくるので「尋ねる」or「前回優先」<br>&gt; の組み合わせがbetterかと思いますが，いかがでしょうか．<br><br>--- sakura_core\CEditDoc_20061204.cpp&#9;Fri May 26 23:35:44 2006<br>+++ sakura_core\CEditDoc.cpp&#9;Sat Dec 16 23:08:34 2006<br>@@ -567 +567,5 @@<br>-&#9;&#9;&#9;if( bConfirmCodeChange ){<br>+&#9;&#9;&#9;if( !bConfirmCodeChange )&#9;&#9;&#9;// ADD じゅうじ 2006/12/16<br>+&#9;&#9;&#9;&#9;m_nCharCode = fi.m_nCharCode;<br>+&#9;&#9;&#9;else<br>+//&#9;&#9;&#9;if( bConfirmCodeChange )&#9;&#9;&#9;// DEL じゅうじ 2006/12/16<br>+&#9;&#9;&#9;{<br><br>これで直ると思いますが、この CEditDoc::FileRead() で余分な処理を除いた版はPatchにて。<br>以前の話では、MRUにするのなら（未チェックの条件では）自動認識のルートは不要。<br>SUBMIT出来ないので、Yahoo!/Developer/Source/CEditDoc_cpp.diff に置きました。<br><br>data:3692 X-&gt;O data:5692 間違えました。</div></section>
    <ul><li><section><h1 id=5733>
    <span class="no">[5733]</span>
    <a class="thread-title" href="#5733">ありがとうございました</a>
    <span class="author">穂下</span>
    <time datetime="2007-01-11T18:13:18">2007年01月11日 18:13</time></h1>
    <div class="body">遅ればせですが、ご対応ありがとうございました<br>m(__)m</div></section>
    </li></ul></li><li><section><h1 id=5700>
    <span class="no">[5700]</span>
    <a class="thread-title" href="#5700">早速Closeされたので、公告</a>
    <span class="author">じゅうじ</span>
    <time datetime="2006-12-19T01:48:08">2006年12月19日 01:48</time></h1>
    <div class="body">現在オープンしているファイルを、違う文字コードで二重オープンしようとすると、ワーニングのダイアログが出る時と、出ない時が有りますので、無くします。<br>ダイアログが出る時　＝ON 「前回と異なる文字コードのとき問い合わせを行う」<br>ダイアログが出ない時＝OFF「前回と異なる文字コードのとき問い合わせを行う」<br>V 1.5.13.1<br>CEditDoc_new.cpp [line:1303] をコメント化します。<br>/* &amp;&amp; m_pShareData-&gt;m_Common.GetQueryIfCodeChange() */<br><br>そして、その前の段落の、文字コード判定を外すと、二重オープンを行う場合、ワーニングのダイアログが出る時と、出ない時が出来ます。<br>ダイアログが出る時　＝「文字コード指定」で、且つ現在と文字コードが異なる<br>ダイアログが出ない時＝「文字コード自動選択」ならば必ずダイアログは出ない<br>つまりSAKURAは、単純なファイルの二重オープン・リクエストでは、ワーニングは出さないという事になります。文字コードが異なる場合だけワーニングが出ます。<br><br>二重オープンならば、必ずワーニングのダイアログを出すようにすると、意味も違って来ます。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></body></html>