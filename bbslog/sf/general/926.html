<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css">
  <link rel="shortcut icon" href="favicon.ico">
  <title>設定ファイルの場所を指定する方法 | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">926</span>
    <a class="thread-title" href="926.html#926">設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">927</span>
    <a class="thread-title" href="926.html#927">Re:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">929</span>
    <a class="thread-title" href="926.html#929">Re2:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">930</span>
    <a class="thread-title" href="926.html#930">Re3:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">931</span>
    <a class="thread-title" href="926.html#931">Re4:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">932</span>
    <a class="thread-title" href="926.html#932">Re5:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">936</span>
    <a class="thread-title" href="926.html#936">Re6:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">937</span>
    <a class="thread-title" href="926.html#937">Re7:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">940</span>
    <a class="thread-title" href="926.html#940">Re8:設定ファイルの場所を指定する方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">943</span>
    <a class="thread-title" href="926.html#943">Re9:設定ファイルの場所を指定する方法</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=926>
    <span class="no">[926]</span>
    <a class="thread-title" href="#926">設定ファイルの場所を指定する方法</a>
    <span class="author">tsuyo-pon</span>
    <time datetime="2001-12-02T02:27:53">2001年12月02日 02:27</time></h1>
    <div class="body">初めまして。サクラエディタをメインのエディタとして使わせていただいています。<br><br>質問あるいは新機能の提案です。<br>エディタの設定や MRU などの情報は sakura.exe と同じディレクトリの sakura.ini ファイルから読み込んで、同じファイルに書き出されるわけですが、このファイルの場所をコマンドラインオプションか何かで変更できないでしょうか。<br>Windows 2000 で（Power Users でなく） Users グループのメンバとして使っていると、デフォルトでは Program Files の下のファイルには書き込めないのです。<br>今はマシンを一人で使っているので sakura.ini を誰でも書き込み可能にして使っているのですが、少し気持ちが悪いです。<br>また、複数の人がログオンするような環境だと気持ちが悪い以上の問題が生じると思います。<br>設定ファイルの場所が指定できれば、 C:\Documents and Settings\ユーザ名\Application Data\sakura\sakura.ini などに保存すればいいので、便利ではないかと思いました。<br>それと、変更履歴を見ていたら、以前はレジストリに書かれていたようですが、やめてしまったのですか？ レジストリならマルチユーザ環境でも問題なく使えるのですが……。<br><br>1.2.102.0 を使っています（1.2.103 が出たんですね。早速新しいバージョンを入れてみます）。<br><br>余談: 名前が「テキストエディタ」の頃に人に聞いて、その後新しいバージョンが出ているかを確認していなかったので、久しぶりに調べて名前が変わっていて驚きました。中身を見たら構文ハイライトなどが充実していてもっと驚きましたけど。これからも安心して使える便利なエディタとして成長していってほしいと思います。<br></div></section>
    <ul><li><section><h1 id=927>
    <span class="no">[927]</span>
    <a class="thread-title" href="#927">Re:設定ファイルの場所を指定する方法</a>
    <span class="author">げんた</span>
    <time datetime="2001-12-02T05:04:05">2001年12月02日 05:04</time></h1>
    <div class="body">▼ tsuyo-ponさん<br>&gt; レジストリならマルチユーザ環境でも問題なく使えるのですが……。<br>確かにこれらは正論です。しかしレジストリを使うと<br>1. レジストリファイルの肥大化を招く<br>2. 設定を別のマシンに持っていくのがきわめて面倒。(特に初心者には)<br>なので、レジストリ保存は(特にパワーユーザには)嫌われる傾向にあるようです。<br><br>&gt; 今はマシンを一人で使っているので sakura.ini を誰でも書き込み可能にして使っているのですが、少し気持ちが悪いです。<br>&gt; 複数の人がログオンするような環境だと気持ちが悪い以上の問題が生じる<br>というのも確かにそうなのです。特にWindows XPのユーザをスイッチする環境では設定が選択できないだけではなく、iniファイルの上書き問題が起こります。<br>ただ、これらは上に書いた2とは矛盾します。(単なるフォルダコピーでは設定が保存されない)<br><br>ですからこれは選択可能として、たとえばコマンドラインオプションをつけたら個人の設定ファイルで起動するようにするのがよいのでしょうね。<br>-Mつけたらマルチユーザ環境としてDocument and settingの個人設定を使うとか。<br>ショートカットは共有できるようにするためにもiniのフルパス指定よりはマルチユーザの時だけ<br>指定フォルダを見に行く方が好ましいかな。<br><br>ただし、このエディタは初回起動時に設定をメモリに読み込んで２つ目以降のプロセスはそれを利用しますので、異なるオプションで起動しても初回時しか有効にならないことをあらかじめお断りしておきます。<br>(両方を混ぜて使うことは無いとは思いますが。)<br><br>なかなか(先週WinXPを初めて使った私にとって)タイムリーな要望ありがとうございました。</div></section>
    <ul><li><section><h1 id=929>
    <span class="no">[929]</span>
    <a class="thread-title" href="#929">Re2:設定ファイルの場所を指定する方法</a>
    <span class="author">tsuyo-pon</span>
    <time datetime="2001-12-02T12:04:27">2001年12月02日 12:04</time></h1>
    <div class="body">▼ げんたさん<br>&gt; なので、レジストリ保存は(特にパワーユーザには)嫌われる傾向にあるようです。<br>確かに嫌われているなと思っていました。最近はレジストリファイルのサイズが大きくても読み書きが高速になるよう工夫されているとどこかで読んだような気がしますが、気がするだけだし確かめてもいません。<br>ini ファイルを運ぶだけで設定が他のマシンにコピーできるというのは魅力的ですね。レジストリだとレジストリの一部をテキストファイルにエクスポートとかするのでしょうけど、ファイルのコピー一発の簡単さにはかないません。レジストリエディタを使うというだけで怖いし。<br>まあ、レジストリのファイルが壊れたら被害が大きいというのは変わりませんしね。<br>// ただ、某社の PC にプリインストールされた Windows 95 を4年間使っていましたが、レジストリが壊れたことは一度もない……気付いていないだけ？<br><br>&gt; というのも確かにそうなのです。特にWindows XPのユーザをスイッチする環境では設定が選択できないだけではなく、iniファイルの上書き問題が起こります。<br>&gt; ただ、これらは上に書いた2とは矛盾します。(単なるフォルダコピーでは設定が保存されない)<br>Windows XP は使っていませんし、詳しく調べてもいないのですが、 XP 上だと設定ファイルをコピーしただけでは設定を他のマシンに持っていけないということですか？（単に興味が湧いただけです……面倒なら無視してください）<br><br>&gt; ですからこれは選択可能として、たとえばコマンドラインオプションをつけたら個人の設定ファイルで起動するようにするのがよいのでしょうね。<br>&gt; -Mつけたらマルチユーザ環境としてDocument and settingの個人設定を使うとか。<br>&gt; ショートカットは共有できるようにするためにもiniのフルパス指定よりはマルチユーザの時だけ<br>&gt; 指定フォルダを見に行く方が好ましいかな。<br>そうですね。ただし、ショートカットの「リンク先」には環境変数が使えるので、次のように指定すればフルパスを指定する場合でもショートカットの共有はできるようです。<br>・Windows 2000 では "%APPDATA%\sakura.ini" （引用符を含む）と書きます。 XP でもこれでいいと信じたいところです。<br>・Windows NT 4 では "%USERPROFILE%\Application Data\sakura.ini" （引用符を含む）でいいらしいです。環境がないのでよくわかりません。<br>・Windows 9x/Me ではどうなんでしょう。<br>ただし、マイドキュメントフォルダと同様、 Application Data フォルダも %USERPROFILE%\Application Data にあるとは限らないので、上の NT 4の場合の方法は問題があるかもしれません。<br>べつにフルパスを指定することにこだわるつもりはありませんが、せっかく ini ファイルなのだから、マルチユーザとは無関係に複数の ini ファイルを使い分けられたら新たな利用法があるかな、とか、有用かどうかは別として考えてしまっただけです。 :-)<br>（ところで、マイドキュメントフォルダのパスを示す環境変数ってないですよね……なんか中途半端な気がしますが。）<br><br>&gt; なかなか(先週WinXPを初めて使った私にとって)タイムリーな要望ありがとうございました。<br>ぼくはまだ Windows XP を使う機会がありません。買うにしても現在使用中のハードウェア環境が XP に対応しているかどうか調べないといけなくて、まだやっていません。<br>「○○のソフトが XP でうまく動かない」という話を聞くたびに、面白そうな OS なので使ってみたいと思ってしまいます。 (^_^;)<br></div></section>
    <ul><li><section><h1 id=930>
    <span class="no">[930]</span>
    <a class="thread-title" href="#930">Re3:設定ファイルの場所を指定する方法</a>
    <span class="author">げんた</span>
    <time datetime="2001-12-02T13:29:45">2001年12月02日 13:29</time></h1>
    <div class="body">▼ tsuyo-ponさん<br>&gt; レジストリが壊れたことは一度もない<br>私もレジストリが壊れたことはありません。が、HDDの買い換えなどでOSを再インストールしたことは何回かあります。<br><br>&gt; XP 上だと設定ファイルをコピーしただけでは設定を他のマシンに持っていけないということですか？<br>設定の移動は従来と変わりません。<br><br>WinXPにはアプリケーションを動かしたままで複数ユーザを切り替える機能があります。サクラエディタでは最終プロセスの終了時に設定をiniに書き出すのですが、複数ユーザが同時にエディタを起動すると先に終了した人の設定が後から終了した設定で上書きされてしまうという問題が起こります。<br>エディタをネットワークドライブに置いて複数ユーザが起動する場合に起こる問題が１台のマシンでも起こるということです。<br><br>&gt; ショートカットの「リンク先」には環境変数が使える<br>おお！初めて知りました。<br><br>&gt; ・Windows 2000 では "%APPDATA%\sakura.ini" （引用符を含む）と書きます。 XP でもこれでいいと信じたいところです。<br>XPでも同じでしたよ。<br><br>ショートカットの設定をインストーラで自動化するのは難しそうですね。<br></div></section>
    <ul><li><section><h1 id=931>
    <span class="no">[931]</span>
    <a class="thread-title" href="#931">Re4:設定ファイルの場所を指定する方法</a>
    <span class="author">tsuyo-pon</span>
    <time datetime="2001-12-02T14:32:13">2001年12月02日 14:32</time></h1>
    <div class="body">▼ げんたさん<br>&gt; WinXPにはアプリケーションを動かしたままで複数ユーザを切り替える機能があります。サクラエディタでは最終プロセスの終了時に設定をiniに書き出すのですが、複数ユーザが同時にエディタを起動すると先に終了した人の設定が後から終了した設定で上書きされてしまうという問題が起こります。<br>&gt; エディタをネットワークドライブに置いて複数ユーザが起動する場合に起こる問題が１台のマシンでも起こるということです。<br>おや？ これは現状なら起きない問題では。<br>その代わり、全員が同じ設定で使うという制限がつきますが。でもそれはアプリケーションを動かしたまま切り替えることと直接の関係はありませんよね。 Windows 2000 で1台のマシンを複数の人が使っていれば起きることです。<br>それを解決するために、ユーザごとに設定ファイルを分けるというのをご提案したつもりなのですが。<br>// ぼくが何か大きく勘違いしているような……。<br><br>ただ、エディタの設定が共有メモリに置かれているなら、その共有メモリをユーザごとに分けておく必要があります。<br>ソースを読んでもっと具体的なことを書けるといいのですが、その時間がなくて言いたいことだけ言っています。すみません。<br><br>&gt; ショートカットの設定をインストーラで自動化するのは難しそうですね。<br>インストーラに必要な機能は、<br>・設定ファイルをユーザごとに作るかどうかを選べるようにする<br>・（設定ファイル名のフルパスを指定する方式の場合は）作成するショートカットのリンク先を OS の種類ごとに変える<br>という2点のように思います。<br>でも、インストーラはとくに変更しなくても、設定ファイルをユーザごとに分ける方法が FAQ か何かに書かれていればいいかもしれません。<br>// でも、やっぱりげんたさんの書かれたような「設定ファイルをユーザごとに作る」というコマンドラインオプションがあるほうが楽か……。<br></div></section>
    <ul><li><section><h1 id=932>
    <span class="no">[932]</span>
    <a class="thread-title" href="#932">Re5:設定ファイルの場所を指定する方法</a>
    <span class="author">げんた</span>
    <time datetime="2001-12-02T16:23:20">2001年12月02日 16:23</time></h1>
    <div class="body">▼ tsuyo-ponさん<br>&gt; おや？ これは現状なら起きない問題では。<br>たとえば、<br>AさんがEditor起動<br>Bさんが同じEditor起動<br>Bさんが設定変更<br>BさんがEditor終了(ini保存)<br>AさんがEditor終了(ini保存)<br><br>とすると、Bさんの設定変更がAさんの設定で上書きされてしまうということです。<br><br>&gt; ただ、エディタの設定が共有メモリに置かれているなら、その共有メモリをユーザごとに分けておく必要があります。<br>これは大丈夫なはず。<br>Globalとlocal(ユーザごと)の名前空間が用意されていて、GLOBAL\で始まらないものはすべてLocalと解釈されるらしいので。</div></section>
    <ul><li><section><h1 id=936>
    <span class="no">[936]</span>
    <a class="thread-title" href="#936">Re6:設定ファイルの場所を指定する方法</a>
    <span class="author">tsuyo-pon</span>
    <time datetime="2001-12-03T11:23:40">2001年12月03日 11:23</time></h1>
    <div class="body">▼ げんたさん [932]<br>&gt; AさんがEditor起動<br>&gt; Bさんが同じEditor起動<br>&gt; Bさんが設定変更<br>&gt; BさんがEditor終了(ini保存)<br>&gt; AさんがEditor終了(ini保存)<br>なるほど、例えばAさんがファイルタイプ .aaa についての設定を追加し、Bさんがファイルタイプ .bbb についての設定を追加するようなことを考えると、AさんとBさんのサクラエディタを起動している時間に重なりがなければ安全なのに、ユーザ切り替えを使っていると最後に保存されたほうのみが残ることになりますね。<br><br>気になるのは、<br>▼ げんたさん [927]<br>&gt; ただし、このエディタは初回起動時に設定をメモリに読み込んで２つ目以降のプロセスはそれを利用しますので、異なるオプションで起動しても初回時しか有効にならないことをあらかじめお断りしておきます。<br>という点で、ユーザごとに違う設定ファイルを使うようにしても、初回起動時しか読み込まないのであれば全員が一人目の設定で使うことになってしまうのでは？ ということです。<br><br>ただ、<br>▼ げんたさん [932]<br>&gt; &gt; ただ、エディタの設定が共有メモリに置かれているなら、その共有メモリをユーザごとに分けておく必要があります。<br>&gt; これは大丈夫なはず。<br>&gt; Globalとlocal(ユーザごと)の名前空間が用意されていて、GLOBAL\で始まらないものはすべてLocalと解釈されるらしいので。<br>とおっしゃった話がぼくにはまだよくわかっていないので、ぼくが思い違いをしているだけなのでしょう。<br>「ユーザごと」という単位が存在するということは、現在もマルチユーザ環境に特有の処理が一部行われているということでしょうか。<br>設定ファイルが .exe と同じディレクトリの sakura.ini という実装は、シングルユーザ環境のみを考えているからだと思っていたのですが。<br><br>時間ができたら、ソースも見てみますね。<br></div></section>
    <ul><li><section><h1 id=937>
    <span class="no">[937]</span>
    <a class="thread-title" href="#937">Re7:設定ファイルの場所を指定する方法</a>
    <span class="author">げんた</span>
    <time datetime="2001-12-03T11:41:06">2001年12月03日 11:41</time></h1>
    <div class="body">▼ tsuyo-ponさん<br>&gt; ユーザごとに違う設定ファイルを使うようにしても、初回起動時しか読み込まないのであれば全員が一人目の設定で使うことになってしまうのでは？<br><br>&gt; ただ、<br>&gt; ▼ げんたさん [932]<br>&gt; &gt; &gt; ただ、エディタの設定が共有メモリに置かれているなら、その共有メモリをユーザごとに分けておく必要があります。<br>&gt; &gt; これは大丈夫なはず。<br>&gt; &gt; Globalとlocal(ユーザごと)の名前空間が用意されていて、GLOBAL\で始まらないものはすべてLocalと解釈されるらしいので。<br>&gt; とおっしゃった話がぼくにはまだよくわかっていないので、ぼくが思い違いをしているだけなのでしょう。<br>&gt; 「ユーザごと」という単位が存在するということは、現在もマルチユーザ環境に特有の処理が一部行われているということでしょうか。<br>行われていません。マルチユーザ対応になったのはWindows XPの方です。WinXPでいう「マルチユーザ」というのはUNIXのようにOwnerの異なるプロセスを複数同時に走らせられるという意味です。(もっとも、NTの頃から可能でしたがXPではGUIアプリでもそれができるようになりました)<br><br>起動時の動作は<br>1. 共有メモリをチェック<br>2. 無ければ作る<br>となっています。ここで1のチェックはメモリにつけられた名前によって行われます。<br><br>WinXPのマルチユーザ環境ではAさんが作ったオブジェクトsakuraとBさんが作ったオブジェクトsakuraは別のものと認識されます。BさんはAさんのsakuraオブジェクトにたどり着くことはできません。ただし名前としてGLOBAL\のついたものを使う場合は両方から認識されます。Aさんが作ったGLOBAL\XはBさんもGLOBAL\Xという名前で参照できます。<br><br>共有メモリの名前が(実質的に)異なれば２つを同時に動かすことは可能です。現在のソースでもDEBUG用に構築したものはRelease用とは異なる名前の共有メモリを使うので、両者を独立の設定で併用できます。</div></section>
    <ul><li><section><h1 id=940>
    <span class="no">[940]</span>
    <a class="thread-title" href="#940">Re8:設定ファイルの場所を指定する方法</a>
    <span class="author">tsuyo-pon</span>
    <time datetime="2001-12-03T22:54:47">2001年12月03日 22:54</time></h1>
    <div class="body">▼ げんたさん<br>&gt; WinXPのマルチユーザ環境ではAさんが作ったオブジェクトsakuraとBさんが作ったオブジェクトsakuraは別のものと認識されます。BさんはAさんのsakuraオブジェクトにたどり着くことはできません。ただし名前としてGLOBAL\のついたものを使う場合は両方から認識されます。Aさんが作ったGLOBAL\XはBさんもGLOBAL\Xという名前で参照できます。<br>知りませんでした。 MSDN の <a href=http://msdn.microsoft.com/library/en-us/termserv/tsovr_0cz7.asp target=_top><nobr>http://<wbr>msdn.<wbr>microsof<wbr>t.<wbr>com/<wbr>library/<wbr>en-<wbr>us/<wbr>termserv<wbr>/<wbr>tsovr_0c<wbr>z7.<wbr>asp</nobr></a> に書かれていたので勉強してきました（「名前を "Local\" で始めるとオブジェクトを明示的にセッション名前空間に作ることができる」（少し意訳）という辺りは、「Local\」と書いても書かなくても同じ動作なのかという点をはっきりと書いてもらいたいですね）。<br>こういう仕様だから、 XP のユーザ切り替えを使っているとユーザごとに別々に設定ファイルを読んだり書いたりしているわけですね。それなのに、同じファイルを使っていることで、問題が生じると。……これは確かに問題だ :-) すべて納得したつもりです。<br>もとは機能の提案のつもりだったのですが、一方的に勉強させていただいてしまってすみません。<br><br>さて、じつは設定ファイルをユーザごとに分けると、 Windows 2000 で「別のユーザーとして実行」（Run As; GUI アプリケーションでも使えます）を使ったときの動作に懸念が残っているのですが、また勘違いしているかもしれないので、少し実験してから書き込みたいと思います。<br>本業の大学のほうがこれからしばらく忙しいので、しばらく引っ込みます。次に書けるのがいつになるかわかりませんが、そのときはまたよろしくお願いします。<br></div></section>
    <ul><li><section><h1 id=943>
    <span class="no">[943]</span>
    <a class="thread-title" href="#943">Re9:設定ファイルの場所を指定する方法</a>
    <span class="author">げんた</span>
    <time datetime="2001-12-04T09:36:56">2001年12月04日 09:36</time></h1>
    <div class="body">&gt;&gt; ただし名前としてGLOBAL\のついたものを使う場合<br>Global\でしたね．私も実際に確認したわけではなくて文書のうろ覚えなので...(^^;)<br>やっぱり，いちどちゃんと実験してみた方がいいな．<br><br>&gt;MSDN の http://msdn.microsoft.com/library/en-us/termserv/tsovr_0cz7.asp に書かれていたので<br>私が見たのもたぶんこれです．<br><br>&gt;「Local\」と書いても書かなくても同じ動作なのかという点をはっきりと書いてもらいたいですね）。<br>何も付けない場合の動作は<br>▼第1段落に<br>each client session has a separate name space<br>▼第3段落に<br>Service applications on a Terminal Services server use the global name space by default<br>▼第4段落に<br>more common case of running the application once per session is supported by default since the named object is created in a per session name space. <br>と書かれているからそこには書いてないのでしょう．<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>