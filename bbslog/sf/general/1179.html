<!DOCTYPE html><html><head><meta charset='utf-8'><title>[要望]選択範囲をコメントアウト</title><link rel='stylesheet' href='../bbs.css' /><script src='../bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←一般トップへ</a><li><div class="list-title">
    <span class="no">1179</span>
    <a class="title" href="1179.html#1179">[要望]選択範囲をコメントアウト</a></div>
    <ul><li><div class="list-title">
    <span class="no">1180</span>
    <a class="title" href="1179.html#1180">Re:[要望]選択範囲をコメントアウト</a></div>
    <ul><li><div class="list-title">
    <span class="no">1184</span>
    <a class="title" href="1179.html#1184">Re2:[要望]選択範囲をコメントアウト</a></div>
    <ul><li><div class="list-title">
    <span class="no">3600</span>
    <a class="title" href="1179.html#3600">Re3:[要望]選択範囲をコメントアウト</a></div>
    <ul><li><div class="list-title">
    <span class="no">3601</span>
    <a class="title" href="1179.html#3601">Re4:[要望]選択範囲をコメントアウト</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=1179>
    <span class="no">[1179]</span>
    <a class="title" href="#1179">[要望]選択範囲をコメントアウト</a>
    <span class="author">tetti</span>
    <time datetime="2002-01-30T10:36:15">2002年01月30日 10:36</time></h1>
    <div class="body">プログラムコードを書く際、一時的にコードをコメントアウトして動作確認等、みなさんもよくやられると思いますが、それを楽にできないものかと思い下記機能を提案します。<br><br>選択範囲に対して、現在のタイプ別設定のコメントスタイル定義に従い、コメント挿入と削除する機能です。<br><br>[編集]-[整形]-[コメント挿入 (行)]<br>[編集]-[整形]-[コメント挿入 (プロック)]<br>[編集]-[整形]-[コメント削除 (行)]<br>[編集]-[整形]-[コメント削除 (プロック)]<br><br>のようなメニューがあり、複数行にわたり一気にコメントアウトしたり外せたりできる機能があれば便利だと思うのですが、いかかでしょうか。<br></div></section>
    <ul><li><section><h1 id=1180>
    <span class="no">[1180]</span>
    <a class="title" href="#1180">Re:[要望]選択範囲をコメントアウト</a>
    <span class="author">やざき</span>
    <time datetime="2002-01-30T10:54:19">2002年01月30日 10:54</time></h1>
    <div class="body">▼ tettiさん<br>&gt; プログラムコードを書く際、一時的にコードをコメントアウトして動作確認等、みなさんもよくやられると思いますが、それを楽にできないものかと思い下記機能を提案します。<br>&gt; <br>&gt; 選択範囲に対して、現在のタイプ別設定のコメントスタイル定義に従い、コメント挿入と削除する機能です。<br>&gt; <br>&gt; [編集]-[整形]-[コメント挿入 (行)]<br>&gt; [編集]-[整形]-[コメント挿入 (プロック)]<br>&gt; [編集]-[整形]-[コメント削除 (行)]<br>&gt; [編集]-[整形]-[コメント削除 (プロック)]<br>&gt; <br>&gt; のようなメニューがあり、複数行にわたり一気にコメントアウトしたり外せたりできる機能があれば便利だと思うのですが、いかかでしょうか。<br><br>コメントって/**/とか//とか#とかremとか'とかあると思いますけど、<br>矩形選択してから、//と入力すれば矩形選択した直前に//がつきます。<br>それで対応していただけませぬか。//を矩形選択して削除すれば、コメント削除もできますし。</div></section>
    <ul><li><section><h1 id=1184>
    <span class="no">[1184]</span>
    <a class="title" href="#1184">Re2:[要望]選択範囲をコメントアウト</a>
    <span class="author">tetti</span>
    <time datetime="2002-01-30T12:18:37">2002年01月30日 12:18</time></h1>
    <div class="body">▼ やざきさん<br>&gt; 矩形選択してから、//と入力すれば矩形選択した直前に//がつきます。<br>&gt; それで対応していただけませぬか。//を矩形選択して削除すれば、コメント削除もできますし。<br><br>知りませんでした。<br>行単位のコメントについては矩形選択で代替したいと思います。<br>ありがとうございました。</div></section>
    <ul><li><section><h1 id=3600>
    <span class="no">[3600]</span>
    <a class="title" href="#3600">Re3:[要望]選択範囲をコメントアウト</a>
    <span class="author">しみづ</span>
    <time datetime="2004-01-21T16:21:29">2004年01月21日 16:21</time></h1>
    <div class="body">　はじめまして。先日、Ｎｅｔｓｃａｐｅ7の不具合のページで、ＵＴＦのコードが扱えるエディタの紹介を見てサクラエディタを使い始めて、便利な機能にたいへんありがたがっております。<br><br>　さて、このツリーが目に止まり、先日必要があって作ったマクロを流用して、選択範囲をブロックコメント/**/でコメントアウトするマクロを作ってみたので、掲載してみます。そしてもうひとつは、選択範囲の先頭と最後を2文字削除するマクロです。<br>　変更の後、すぐ移動などできるように変更部分を選択するように作ってありますが、改行をはさむ場合には計算がうまくいかず（改行を数える処理が見つからないので）、選択範囲がずれますので、必要なければその部分は削除してください。<br><br>　なお、ＷＳＨがうまく動かない環境もありえるそうですが、その場合は、あまり覚える言語を増やしたくないのでご勘弁ください。<br><br>【addcomm.js】<br>var inp = Editor.GetSelectedString(0);<br>var len = inp.length+4;<br>Editor.InsText("/*");<br>Editor.InsText(inp);<br>Editor.InsText("*/");<br>for (var i = 0; i &lt; len; i++) {<br>  Editor.Left();<br>}<br>Editor.BeginSelect();<br>for (var i = 0; i &lt; len; i++) {<br>  Editor.Right_Sel();<br>}<br><br>【delcomm.js】<br>var inp = Editor.GetSelectedString(0);<br>var len = inp.length-4;<br>var outp = inp.substr(2, len);<br>Editor.InsText(outp);<br>for (var i = 0; i &lt; len; i++) {<br>  Editor.Left();<br>}<br>Editor.BeginSelect();<br>for (var i = 0; i &lt; len; i++) {<br>  Editor.Right_Sel();<br>}<br></div></section>
    <ul><li><section><h1 id=3601>
    <span class="no">[3601]</span>
    <a class="title" href="#3601">Re4:[要望]選択範囲をコメントアウト</a>
    <span class="author">しみづ</span>
    <time datetime="2004-01-22T17:28:54">2004年01月22日 17:28</time></h1>
    <div class="body">　改行コードを数える処理ができました。失礼しました。<br><br>【addcomm.js】<br>var inp = Editor.GetSelectedString(0);<br>var len = inp.length+4;<br>var crlf = 0;<br>var rc;<br>var i;<br>for ( i = 0; ; i++ ) {  // 改行カウント<br>  rc = inp.indexOf("\n", i);<br>  if ( rc == -1 )<br>    break;<br>  crlf++;<br>  i = rc;<br>}<br>len -= crlf;<br>Editor.InsText("/*");<br>Editor.InsText(inp);<br>Editor.InsText("*/");<br>for ( i = 0; i &lt; len; i++ ) {<br>  Editor.Left();<br>}<br>Editor.BeginSelect();<br>for ( i = 0; i &lt; len; i++ ) {<br>  Editor.Right_Sel();<br>}<br><br>【delcomm.js】<br>var inp = Editor.GetSelectedString(0);<br>var len = inp.length-4;<br>var outp = inp.substr(2, len);<br>var crlf = 0;<br>var rc;<br>var i;<br>for ( i = 0; ; i++ ) {  // 改行カウント<br>  rc = inp.indexOf("\n", i);<br>  if ( rc == -1 )<br>    break;<br>  crlf++;<br>  i = rc;<br>}<br>len -= crlf;<br>Editor.InsText(outp);<br>for ( i = 0; i &lt; len; i++ ) {<br>  Editor.Left();<br>}<br>Editor.BeginSelect();<br>for ( i = 0; i &lt; len; i++ ) {<br>  Editor.Right_Sel();<br>}<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></body></html>