<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="/favicon.ico">
  <title>検索がうまくいかない | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">4290</span>
    <a class="thread-title" href="4290.html#4290">検索がうまくいかない</a></div>
    <ul><li><div class="list-title">
    <span class="no">4291</span>
    <a class="thread-title" href="4290.html#4291">UNICODEにしてますか</a></div>
    <ul><li><div class="list-title">
    <span class="no">4297</span>
    <a class="thread-title" href="4290.html#4297">Re:UNICODEにしてますか</a></div>
    <ul><li><div class="list-title">
    <span class="no">4298</span>
    <a class="thread-title" href="4290.html#4298">Re2:UNICODEにしてますか</a></div>
    <ul><li><div class="list-title">
    <span class="no">4299</span>
    <a class="thread-title" href="4290.html#4299">Re3:UNICODEにしてますか</a></div>
    </li><li><div class="list-title">
    <span class="no">4300</span>
    <a class="thread-title" href="4290.html#4300">文字コードセットの指定方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">4301</span>
    <a class="thread-title" href="4290.html#4301">Re:文字コードセットの指定方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">4302</span>
    <a class="thread-title" href="4290.html#4302">Re2:文字コードセットの指定方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">4303</span>
    <a class="thread-title" href="4290.html#4303">Re3:文字コードセットの指定方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">4304</span>
    <a class="thread-title" href="4290.html#4304">Re4:文字コードセットの指定方法</a></div>
    <ul><li><div class="list-title">
    <span class="no">4305</span>
    <a class="thread-title" href="4290.html#4305">Re5:文字コードセットの指定方法</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=4290>
    <span class="no">[4290]</span>
    <a class="thread-title" href="#4290">検索がうまくいかない</a>
    <span class="author">koh</span>
    <time datetime="2005-02-10T10:41:52">2005年02月10日 10:41</time></h1>
    <div class="body">docファイルのGrep検索がうまくいきません。<br>検索文字数、階層数、文字コードが影響してくるのでしょうか？<br>考えられる原因を教えていただきたく思います。<br>よろしくお願い致します。</div></section>
    <ul><li><section><h1 id=4291>
    <span class="no">[4291]</span>
    <a class="thread-title" href="#4291">UNICODEにしてますか</a>
    <span class="author">渡辺真</span>
    <time datetime="2005-02-11T08:08:09">2005年02月11日 08:08</time></h1>
    <div class="body"><br>&gt; docファイルのGrep検索がうまくいきません。<br>&gt; 文字コードが影響してくるのでしょうか？<br><br>下の「文字コードセット」で「Unicode」を選択してみて下さい。<br></div></section>
    <ul><li><section><h1 id=4297>
    <span class="no">[4297]</span>
    <a class="thread-title" href="#4297">Re:UNICODEにしてますか</a>
    <span class="author">koh</span>
    <time datetime="2005-02-14T09:33:12">2005年02月14日 09:33</time></h1>
    <div class="body">▼ 渡辺真さん<br>&gt; <br>&gt; &gt; docファイルのGrep検索がうまくいきません。<br>&gt; &gt; 文字コードが影響してくるのでしょうか？<br>&gt; <br>&gt; 下の「文字コードセット」で「Unicode」を選択してみて下さい。<br><br>ありがとうございます。<br>うまくいきました。<br><br>再度、ご質問で恐縮なのですが、文字コードセットについてどのように<br>考えて検索を行なえばよいのでしょうか？<br><br>基本的に「Unicode」にすればよろしいのでしょうか？<br><br>主に検索したいファイルはtxtファイルとdocファイルです。<br><br>初歩的な質問だと思いますが、お答えくださいますと助かります。<br>よろしくお願い致します。</div></section>
    <ul><li><section><h1 id=4298>
    <span class="no">[4298]</span>
    <a class="thread-title" href="#4298">Re2:UNICODEにしてますか</a>
    <span class="author">(全略)</span>
    <time datetime="2005-02-14T13:06:15">2005年02月14日 13:06</time></h1>
    <div class="body">▼ kohさん<br>&gt; 基本的に「Unicode」にすればよろしいのでしょうか？<br>&gt;<br>&gt; 主に検索したいファイルはtxtファイルとdocファイルです。<br>たいがいの場合、ダメです<br>検索したいファイルが全てUNICODEだとか、docファイルしか対象にしないと言うのなら別にいいんですが<br><br>「Unicode」にすれば文字コードを自動判別することなくUnicodeとして開き検索します<br>他の文字コード(SJISとかEUCとか)のファイルが検索できなくなります<br>Word,Excelのファイルはバイナリファイルですが文字はUnicodeで保存されているので<br>「たまたま」うまく検索できているだけかと思います<br>なのでdocのファイルをGrepするときだけ「Unicode」にしたほうが無難かも<br><br># 文字コード判別に失敗したら指定された文字コードを使う、とかの方がいいんですかねぇ、、、<br># でも1つのファイルに複数の文字コードがあるファイルもあるしなぁ T-T<br><br>たとえばWordは知りませんが、Excelはセルの文字列はUnicodeのクセに<br>マクロの文字コードはSJISだったり、、、</div></section>
    <ul><li><section><h1 id=4299>
    <span class="no">[4299]</span>
    <a class="thread-title" href="#4299">Re3:UNICODEにしてますか</a>
    <span class="author">maru</span>
    <time datetime="2005-02-14T22:46:17">2005年02月14日 22:46</time></h1>
    <div class="body">&gt; たとえばWordは知りませんが、Excelはセルの文字列はUnicodeのクセに<br>&gt; マクロの文字コードはSJISだったり、、、<br><br>手前味噌ながら<br><a href=http://www.geocities.jp/maru3128/sakura.html#omake target=_top><nobr>http://<wbr>www.<wbr>geocitie<wbr>s.<wbr>jp/<wbr>maru3128<wbr>/<wbr>sakura.<wbr>html#<wbr>omake</nobr></a><br>文字コード自動判定時に、officeのヘッダーが付いてたら<br>Unicodeで開くように改造したものです。<br>いわゆる自分専用仕様としてコンパイルしたものですが<br>必要であればご自由にお使いください。<br><br>当然、修飾部分はすべてバイナリになってしまうため<br>検索目的以上には使えません。<br>さらにExcelは(前略)さんのおっしゃるように<br>文字コードの混在が発生しますのでイマイチ信頼できません。<br>基本的に97以降ではセルの値の検索はUnicodeだけで<br>できるように設計されていますがS-JISが使用できない<br>わけでもないらしく・・・。詳しくは分かりません。<br>もし興味があれば↓など。<br><a href=http://www.pleasuresky.co.jp/insidexl.php3 target=_top><nobr>http://<wbr>www.<wbr>pleasure<wbr>sky.<wbr>co.<wbr>jp/<wbr>insidexl<wbr>.<wbr>php3</nobr></a><br></div></section>
    </li><li><section><h1 id=4300>
    <span class="no">[4300]</span>
    <a class="thread-title" href="#4300">文字コードセットの指定方法</a>
    <span class="author">渡辺真</span>
    <time datetime="2005-02-14T22:48:49">2005年02月14日 22:48</time></h1>
    <div class="body">既に回答済みですが、補足します。<br><br>サクラエディタでまず開いてみて、読めるファイル(.txtや.html)は、「自動選択」で OK です。<br><br>一方、.docや.xlsのように、サクラエディタで開くと、分けの分からない文字で始まっているもの(バイナリファイル)は、プログラムでも「自動選択」の判定ができないので、明示的に人が指定しなければなりません。<br><br>(下の既出の書きこみのように、「正規表現キーワードを使うにして、バイナリファイルを開くと、まれにアプリケーションで落ちることが有ります」ので、もし、「正規表現キーワード」を使っているなら、事前にサクラで、「正規表現キーワード」を使わない、doc,xlsのタイプ別設定を作っておくと良いでしょう。)<br><br><br>最近のバージョンの MS-Office の文書は「UNICODE」だとか、マクロの文字コードは「SJIS」だとかいう、知識が有って、それを指定します。<br><br><br>ちなみに、docファイルを、サクラエディタで開いて、「ファイル」→「開き直す」→「Unicodeで開き直す」とすると、真中あたりで、本文が読めることから、「UNICODE」だと分かります。<br></div></section>
    <ul><li><section><h1 id=4301>
    <span class="no">[4301]</span>
    <a class="thread-title" href="#4301">Re:文字コードセットの指定方法</a>
    <span class="author">maru</span>
    <time datetime="2005-02-15T01:03:01">2005年02月15日 01:03</time></h1>
    <div class="body">▼ 渡辺真さん<br>&gt; 「正規表現キーワードを使うにして<br>&gt; バイナリファイルを開くと、まれにアプリケーションで<br>&gt; 落ちることが有ります」ので<br><br>これは・・・困りましたね。<br>私はバイナリファイルでもお構いなしに開きまくり。<br>しかも正規表現キーワード使っています。<br>いままでよく無事でした。<br><br>&gt; doc,xlsのタイプ別設定を<br>なるほど。早速用意するとしましょう。<br></div></section>
    <ul><li><section><h1 id=4302>
    <span class="no">[4302]</span>
    <a class="thread-title" href="#4302">Re2:文字コードセットの指定方法</a>
    <span class="author">koh</span>
    <time datetime="2005-02-15T14:56:18">2005年02月15日 14:56</time></h1>
    <div class="body">皆様、ご指導ありがとうございました。<br>大変、参考になりました。<br><br>txtとdocを同時に検索をかけないで、txtなら自動選択、docなら、<br>Unicodeで２回行なうことで対処しようと思います。<br><br>本当にありがとうございます。</div></section>
    <ul><li><section><h1 id=4303>
    <span class="no">[4303]</span>
    <a class="thread-title" href="#4303">Re3:文字コードセットの指定方法</a>
    <span class="author">koh</span>
    <time datetime="2005-02-15T18:54:41">2005年02月15日 18:54</time></h1>
    <div class="body">たびたびのご質問で、大変恐縮なのですが、docファイル（wordで作成）<br>したファイル内の文字列で、太字などで装飾された文字列を検索する<br>方法はあるのでしょうか？<br><br>Unicodeを含むすべての文字コードで試しましたが、検索されません。<br><br>何かよい案がありましたら、お教えください。<br>よろしくお願い致します。</div></section>
    <ul><li><section><h1 id=4304>
    <span class="no">[4304]</span>
    <a class="thread-title" href="#4304">Re4:文字コードセットの指定方法</a>
    <span class="author">maru</span>
    <time datetime="2005-02-16T00:12:35">2005年02月16日 00:12</time></h1>
    <div class="body">太字になっている文字列に限定して検索する、の意味ですか？<br><br>それともマッチするはずの文字列がたまたま太字に<br>なっていると、検索に失敗する、という文章にも見えますが<br>私のところではそういった現象は経験がないです。<br><br>もし後者の意味であれば問題となったファイルを<br>送付いただけませんか？</div></section>
    <ul><li><section><h1 id=4305>
    <span class="no">[4305]</span>
    <a class="thread-title" href="#4305">Re5:文字コードセットの指定方法</a>
    <span class="author">koh</span>
    <time datetime="2005-02-16T10:02:27">2005年02月16日 10:02</time></h1>
    <div class="body">再度、検索を試したところ、うまくいきました。<br>私の勘違いでした。<br>申し訳ございません。</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>