<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="favicon.ico">
  <title>文字列の貼り付けで異常終了 | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">2092</span>
    <a class="thread-title" href="2092.html#2092">文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2094</span>
    <a class="thread-title" href="2092.html#2094">Re: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2097</span>
    <a class="thread-title" href="2092.html#2097">Re2: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2106</span>
    <a class="thread-title" href="2092.html#2106">Re3: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2107</span>
    <a class="thread-title" href="2092.html#2107">Re4: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2108</span>
    <a class="thread-title" href="2092.html#2108">Re5: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2109</span>
    <a class="thread-title" href="2092.html#2109">Re6: 文字列の貼り付けで異常終了</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">2113</span>
    <a class="thread-title" href="2092.html#2113">Re5: 文字列の貼り付けで異常終了</a></div>
    <ul><li><div class="list-title">
    <span class="no">2114</span>
    <a class="thread-title" href="2092.html#2114">Re6: 文字列の貼り付けで異常終了</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li>
    </ul><ul class="main"><li><section><h1 id=2092>
    <span class="no">[2092]</span>
    <a class="thread-title" href="#2092">文字列の貼り付けで異常終了</a>
    <span class="author">あろか</span>
    <time datetime="2002-07-07T16:59:31">2002年07月07日 16:59</time></h1>
    <div class="body">ファイルを二つ開き、片方でコピーした文字列を、別のウィンドウに貼り付けようとすると、貼り付け先のエディタが異常終了してしまいます。<br><br>1.3.1.5 までは OK でしたが、1.3.2.2 では NG になりました。OS は XP Home です。<br><br></div></section>
    <ul><li><section><h1 id=2094>
    <span class="no">[2094]</span>
    <a class="thread-title" href="#2094">Re: 文字列の貼り付けで異常終了</a>
    <span class="author">げんた</span>
    <time datetime="2002-07-08T21:07:06">2002年07月08日 21:07</time></h1>
    <div class="body">&gt;ファイルを二つ開き、片方でコピーした文字列を、別のウィンドウに貼り付けようとすると、貼り付け先のエディタが異常終了してしまいます。<br>Win2Kでは全然そんな気配はないんですが...<br><br>具体的な再現方法を書いてもらえませんか．<br></div></section>
    <ul><li><section><h1 id=2097>
    <span class="no">[2097]</span>
    <a class="thread-title" href="#2097">Re2: 文字列の貼り付けで異常終了</a>
    <span class="author">あろか</span>
    <time datetime="2002-07-10T01:44:49">2002年07月10日 01:44</time></h1>
    <div class="body">▼ げんたさん<br>&gt; &gt;ファイルを二つ開き、片方でコピーした文字列を、別のウィンドウに貼り付けようとすると、貼り付け先のエディタが異常終了してしまいます。<br>&gt; Win2Kでは全然そんな気配はないんですが...<br>&gt; <br>&gt; 具体的な再現方法を書いてもらえませんか．<br><br>コピーだけでも起きました。<br>タスクトレイアイコンをダブルクリックしてエディタを開く。<br>→"xxx"と入力。→Shiftを押しながら"←←←"で選択。→Ctrl+Cを押してコピー。→ワンテンポ遅れて「問題が発生したため、sakura.exeを終了します。。。」というダイアログがでる。<br><br></div></section>
    <ul><li><section><h1 id=2106>
    <span class="no">[2106]</span>
    <a class="thread-title" href="#2106">Re3: 文字列の貼り付けで異常終了</a>
    <span class="author">あろか</span>
    <time datetime="2002-07-12T02:10:50">2002年07月12日 02:10</time></h1>
    <div class="body">あまりに簡単に終了するので、別のフォルダにsakura.exeを展開し、iniファイルを作り直したところ、ちゃんと動作しました。<br><br>が、exe と ini をセットでインストール先のフォルダに上書きすると、やっぱり死んでしまいます。<br>フォルダ名に依存する動作ってあるのでしょうか。</div></section>
    <ul><li><section><h1 id=2107>
    <span class="no">[2107]</span>
    <a class="thread-title" href="#2107">Re4: 文字列の貼り付けで異常終了</a>
    <span class="author">KENCH</span>
    <time datetime="2002-07-12T10:12:37">2002年07月12日 10:12</time></h1>
    <div class="body">&gt; フォルダ名に依存する動作ってあるのでしょうか。<br>別なフォルダ（たとえばC:\Sakura）に丸ごとコピーしてうごかしてみては？<br>exeとini以外のファイルが原因って事も。</div></section>
    <ul><li><section><h1 id=2108>
    <span class="no">[2108]</span>
    <a class="thread-title" href="#2108">Re5: 文字列の貼り付けで異常終了</a>
    <span class="author">ai</span>
    <time datetime="2002-07-12T11:11:11">2002年07月12日 11:11</time></h1>
    <div class="body"><br>&gt;&gt; フォルダ名に依存する動作ってあるのでしょうか。<br>私もちょっと気になりましたので便乗させてください。<br>ある特定のフォルダから起動した場合、タスクトレイのアイコンをクリックすると、出てきたメニューのアイコンが全て真っ黒でした。<br>本体のアイコンは正常に表示されています。<br>新規作成などのメニューも正常に動作しているみたいです。<br><br>同名のフォルダを別な場所に作りexeをコピーして起動したら、今度は普通にアイコンが表示されました。<br>なのでフォルダ名に依存しているわけではないのかなぁと。<br>起動する場所で動作(私の場合は表示だけですが)が変わるものなのでしょうか？<br><br>&gt; exeとini以外のファイルが原因って事も。<br>試したフォルダにはsakura.exe以外は入っていませんでした。<br></div></section>
    <ul><li><section><h1 id=2109>
    <span class="no">[2109]</span>
    <a class="thread-title" href="#2109">Re6: 文字列の貼り付けで異常終了</a>
    <span class="author">ai</span>
    <time datetime="2002-07-12T11:27:41">2002年07月12日 11:27</time></h1>
    <div class="body"><br>私の現象が起きるのは ver.1.2.106.1 (2002-02-23) 以降のようです。<br>ver.1.2.106.1 (2002-02-13) 以前では再現しませんでした。<br>同じversionのようですが日付が違います。<br></div></section>
    </li></ul></li><li><section><h1 id=2113>
    <span class="no">[2113]</span>
    <a class="thread-title" href="#2113">Re5: 文字列の貼り付けで異常終了</a>
    <span class="author">あろか</span>
    <time datetime="2002-07-14T03:38:14">2002年07月14日 03:38</time></h1>
    <div class="body">解決しました。<br>レジストリに変な値がセットされていたのが原因のようです。お騒がせしました＆ありがとうございます。<br>---<br>HKEY_CURRENT_USER\Software\Microsoft\Win<br>dows NT\CurrentVersion\AppCompatFlags に、'C:\ProgramFiles2\sakura(初期のパス)'でWIN95 という値がセットされていました。<br>この結果、該当パスのsakura.exe だけが SetClipboardData の呼び出しでアクセス違反を起こしていました。このキーを削除したところ、ちゃんとこぴ＆ぺ ができました。<br>＃古いバージョンが動いた理由はよくわかりません。_WIN32_IE=0x300でコンパイルできなくなったのと関係があるのでしょうか。<br><br><br>----<br>▼ KENCHさん<br>&gt; &gt; フォルダ名に依存する動作ってあるのでしょうか。<br>&gt; 別なフォルダ（たとえばC:\Sakura）に丸ごとコピーしてうごかしてみては？<br>&gt; exeとini以外のファイルが原因って事も。<br><br>結果報告<br>exeとiniだけ、exeと色々(bgrepやキーワード) いずれの組み合わせでもインストール先フォルダでだけエラーになりました。→sakura自体の問題<br>exeは、配布版、Bcc版、Bccデバッグ版、VCデバッグ版いずれもエラーでした。→コンパイルの失敗ではなさそう。<br>ソースを'ProgramFiles'や'sakura'で検索してもフォルダ依存するような箇所が見つからない→コードの問題ではない？<br>なんとなくレジストリを検索→見慣れない怪しいキーがあったので変更→大当たり。<br><br></div></section>
    <ul><li><section><h1 id=2114>
    <span class="no">[2114]</span>
    <a class="thread-title" href="#2114">Re6: 文字列の貼り付けで異常終了</a>
    <span class="author">KENCH</span>
    <time datetime="2002-07-15T10:55:40">2002年07月15日 10:55</time></h1>
    <div class="body">▼ あろかさん<br>&gt; ▼ KENCHさん<br>&gt; &gt; &gt; フォルダ名に依存する動作ってあるのでしょうか。<br>&gt; なんとなくレジストリを検索→見慣れない怪しいキーがあったので変更→大当たり。<br>　なるなる。<br>　FAQ追加ですかね。</div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>