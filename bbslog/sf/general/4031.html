<!DOCTYPE html><html><head><meta charset='utf-8'><title>機能追加要望</title><link rel='stylesheet' href='bbs.css' /><script src='bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←generalトップへ</a><li><div class="list-title">
    <span class="no">4031</span>
    <a class="title" href="4031.html#4031">機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4033</span>
    <a class="title" href="4031.html#4033">Re:機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4038</span>
    <a class="title" href="4031.html#4038">Re2:機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4053</span>
    <a class="title" href="4031.html#4053">Re3:機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4054</span>
    <a class="title" href="4031.html#4054">Re4:機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4055</span>
    <a class="title" href="4031.html#4055">Re5:機能追加要望</a></div>
    <ul><li><div class="list-title">
    <span class="no">4056</span>
    <a class="title" href="4031.html#4056">Re6:機能追加要望</a></div>
    </li><li><div class="list-title">
    <span class="no">4057</span>
    <a class="title" href="4031.html#4057">Re6:機能追加要望</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=4031>
    <span class="no">[4031]</span>
    <a class="title" href="#4031">機能追加要望</a>
    <span class="author">sakura大ファン</span>
    <time datetime="2004-09-07T15:09:49">2004年09月07日 15:09</time></h1>
    <div class="body">おはつです。<br>私が世界で１番使いやすいと思っているsakuraエディタに<br>「追加して頂けたらなぁ～」と思う機能が１つあります。<br><br>それは<br>　複数ファイル同時置換機能です。<br>私がhelpを参照した所、このような機能が見当たらなかったのです。<br>もしあったらいいな～と思っているだけですので軽くご検討お願いします。</div></section>
    <ul><li><section><h1 id=4033>
    <span class="no">[4033]</span>
    <a class="title" href="#4033">Re:機能追加要望</a>
    <span class="author">ひでと</span>
    <time datetime="2004-09-09T13:45:22">2004年09月09日 13:45</time></h1>
    <div class="body">私も欲し～～っす！ぜひ！</div></section>
    <ul><li><section><h1 id=4038>
    <span class="no">[4038]</span>
    <a class="title" href="#4038">Re2:機能追加要望</a>
    <span class="author">tacopon</span>
    <time datetime="2004-09-11T17:31:54">2004年09月11日 17:31</time></h1>
    <div class="body"><a href=http://groups.yahoo.co.jp/group/sakura-editor/files/User/MACRO/ target=_top><nobr>http://<wbr>groups.<wbr>yahoo.<wbr>co.<wbr>jp/<wbr>group/<wbr>sakura-<wbr>editor/<wbr>files/<wbr>User/<wbr>MACRO/<wbr></nobr></a><br>に<br>grepr_20030201_20.cab<br>というのがありますが、どうでしょうか？</div></section>
    <ul><li><section><h1 id=4053>
    <span class="no">[4053]</span>
    <a class="title" href="#4053">Re3:機能追加要望</a>
    <span class="author">くぇｒｔ</span>
    <time datetime="2004-09-25T14:50:22">2004年09月25日 14:50</time></h1>
    <div class="body">▼ tacoponさん<br>&gt; <a href=http://groups.yahoo.co.jp/group/sakura-editor/files/User/MACRO/ target=_top><nobr>http://<wbr>groups.<wbr>yahoo.<wbr>co.<wbr>jp/<wbr>group/<wbr>sakura-<wbr>editor/<wbr>files/<wbr>User/<wbr>MACRO/<wbr></nobr></a><br>&gt; に<br>&gt; grepr_20030201_20.cab<br>&gt; というのがありますが、どうでしょうか？<br><br>試してみました。あまり使えないっぽいです。<br>正規表現が加わると処理要求ダイアログはたくさん出るのに、<br>全く中身が変わっていませんでした。タイムスタンプは変わってました。<br>いろいろ試しましたが、動きませんでした。<br>ひょっとして検索結果の書式とか仕様が変わったからでしょうか？</div></section>
    <ul><li><section><h1 id=4054>
    <span class="no">[4054]</span>
    <a class="title" href="#4054">Re4:機能追加要望</a>
    <span class="author">すい</span>
    <time datetime="2004-09-26T07:11:13">2004年09月26日 07:11</time></h1>
    <div class="body">&gt;試してみました。あまり使えないっぽいです。<br>&gt;正規表現が加わると処理要求ダイアログはたくさん出るのに、<br>&gt;全く中身が変わっていませんでした。タイムスタンプは変わってました。<br>&gt;いろいろ試しましたが、動きませんでした。<br>&gt;ひょっとして検索結果の書式とか仕様が変わったからでしょうか？<br><br>はい。<br>Grep の検索結果の書式が様変わりしているので、もう使い物にならないかと。<br>昔は検索条件が全て出力されていたのですが、今はどういう条件で Grep したのか<br>さっぱりわからなくなってしまってますからマクロなどでの対処は不可能です。<br><br>昔と同じ書式になるように Grep 結果に手作業で手を加えればそれなりに動くかも。<br>(正規表現)<br>とか<br>(単語単位で探す)<br>とか<br>(英大文字小文字を区別する)<br>とかの行を必要に応じて手で追記してみる。<br><br>ただ、それ以前にマクロ側にも１個所、既知の問題があるんですけど。<br>検索文字列中に \ が含まれている場合、Grep 結果には \ → \\ に変換して<br>出力されているので、マクロ側では \\ → \ 変換をやらなくてはならないのですが<br>それをやっていない、という。。。<br><br>最大の問題点はそのマクロ作成者 σ(^^;) がそのマクロ使っていないから、<br>動こうが動くまいがどうでも良いや～～って姿勢でほったらかしにされている点かな。(をぃ<br></div></section>
    <ul><li><section><h1 id=4055>
    <span class="no">[4055]</span>
    <a class="title" href="#4055">Re5:機能追加要望</a>
    <span class="author">もか</span>
    <time datetime="2004-09-26T13:25:58">2004年09月26日 13:25</time></h1>
    <div class="body">&gt;昔と同じ書式になるように Grep 結果に手作業で手を加えればそれなりに動くかも。<br>&gt;(正規表現)<br>&gt;とか<br>(以下略)<br><br>▼CEditView.cpp rev 1.95 / 6375,6401行目<br>&gt;&#9;if( nWork &lt; 0 ){ // 2003.06.10 Moca ファイル検索の場合は表示しない<br>上記仕様変更は私が混入させたバグです。不等号の向きが逆 m(__)m<br>1.3.10.1からバグが有効です。<br><br>&gt;ただ、それ以前にマクロ側にも１個所、既知の問題があるんですけど。<br>&gt;検索文字列中に \ が含まれている場合、Grep 結果には \ → \\ に変換して<br>&gt;出力されているので、マクロ側では \\ → \ 変換をやらなくてはならないのですが<br>&gt;それをやっていない、という。。。<br>表示設定によっては、 ' → \' か  ' → '' のどちらかに変わるものの、それを調べる術が無かったりするというおまけ付で。<br></div></section>
    <ul><li><section><h1 id=4056>
    <span class="no">[4056]</span>
    <a class="title" href="#4056">Re6:機能追加要望</a>
    <span class="author">くぇｒｔ</span>
    <time datetime="2004-09-27T01:56:34">2004年09月27日 01:56</time></h1>
    <div class="body">なるほど、やっぱりそうでしたか。<br>このマクロがサクラエディタとして完全対応してくれら便利だと思うのですが・・・。</div></section>
    </li><li><section><h1 id=4057>
    <span class="no">[4057]</span>
    <a class="title" href="#4057">Re6:機能追加要望</a>
    <span class="author">すい</span>
    <time datetime="2004-09-27T05:03:59">2004年09月27日 05:03</time></h1>
    <div class="body">&gt;表示設定によっては、 ' → \' か  ' → '' のどちらかに変わるものの、それを調べる術が無かったりするというおまけ付で。<br>あらま。これは知りませんでした。<br>タイプ別設定一覧 → 「基本」の設定次第で変わってしまうんですね。<br>う～～む。<br><br>ひとまず \\ → \ なら簡単に追加できるんですが<br>134行目以降<br>-----<br>&#9;if ( bef = '' )&#9;then&#9;// 検索文字列が見つからなかった場合 - エラー終了<br>&#9;&#9;begin&#9;// {<br>&#9;&#9;&#9;S_MoveHistPrev(0);&#9;// 移動履歴: 前へ - S_GoFileTop<br>&#9;&#9;&#9;mess := '';<br>&#9;&#9;&#9;mess := mess + '開かれているファイルが Grep結果ではないようです。' +CRLF;<br>&#9;&#9;&#9;mess := mess + '本マクロは Grep結果から実行してください。' +CRLF;<br>&#9;&#9;&#9;MessageBox(mess,'エラー終了',0);<br>&#9;&#9;&#9;Exit;<br>&#9;&#9;end &#9;// }<br>&#9;;<br><br>&#9;// 検索文字列 bef 中の \\ → \ 変換処理<br>&#9;str := '';<br>&#9;repeat<br>&#9;&#9;tp := Pos('\\',bef);<br>&#9;&#9;if(tp &lt;&gt; 0) then<br>&#9;&#9;&#9;begin<br>&#9;&#9;&#9;&#9;str := str + Copy(bef,1,tp-1) + '\';&#9;// \\ の前の部分 + \ 一文字を str 末尾に連結する<br>&#9;&#9;&#9;&#9;bef := Delete(bef,1,tp+1);&#9;&#9;&#9;&#9;// \\ の後ろ部分のみ残す<br>//&#9;&#9;&#9;&#9;MessageBox( '[' + bef + '][' + str + ']' , '' , 0 );<br>&#9;&#9;&#9;end<br>&#9;&#9;;<br>&#9;until (tp = 0);<br>&#9;bef := str + bef;<br><br>&#9;// ****************************************<br>********** //<br>&#9;//        処理対象のファイル名リストを取得する        //<br>&#9;// ****************************************<br>********** //<br>-----<br><br>このマクロを作った後で S_GetSelectedString の動作仕様も変わったから<br>そこも修正が必要だし。<br>88行目以降<br>-----<br>&#9;// ****************************************<br>********** //<br>&#9;//                   置換条件を取得                   //<br>&#9;// ****************************************<br>********** //<br>&#9;// 置換後文字列（先頭行の内容）を取得する<br>&#9;S_GoFileTop(0);&#9;&#9;&#9;&#9;&#9;// ファイルの先頭に移動<br>//&#9;S_Down_Sel(0);&#9;&#9;&#9;&#9;&#9;// (選択)カーソル下移動&#9;&#9;&#9;&#9;&#9;S_GetSelectedString(0) の仕様変更に伴う変更<br>&#9;S_GoLineEnd_Sel(0);&#9;&#9;&#9;&#9;// (選択)行末に移動(折り返し単位)&#9;&#9;S_GetSelectedString(0) の仕様変更に伴う変更<br>&#9;aft := S_GetSelectedString(0);&#9;// 選択部分の文字列を取得<br>&#9;S_CancelMode(0);&#9;&#9;&#9;&#9;// 各種モードの取り消し - 文字列選択を解除<br>&#9;S_Right(0);&#9;&#9;&#9;&#9;&#9;&#9;// カーソル右移動 - 次行の先頭へ移動&#9;S_GetSelectedString(0) の仕様変更に伴う変更<br>-----<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></body></html>