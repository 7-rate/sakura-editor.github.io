<!DOCTYPE html><html><head><meta charset='utf-8'><title>削除</title><link rel='stylesheet' href='bbs.css' /><script src='bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←一般トップへ</a><li><div class="list-title">
    <span class="no">4975</span>
    <a class="title" href="4975.html#4975">削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">4977</span>
    <a class="title" href="4975.html#4977">Re:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">4986</span>
    <a class="title" href="4975.html#4986">Re2:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">4987</span>
    <a class="title" href="4975.html#4987">Re3:削除</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5162</span>
    <a class="title" href="4975.html#5162">Re2:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5163</span>
    <a class="title" href="4975.html#5163">Re3:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5164</span>
    <a class="title" href="4975.html#5164">Re4:削除</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">5455</span>
    <a class="title" href="4975.html#5455">Re3:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5470</span>
    <a class="title" href="4975.html#5470">Re4:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5472</span>
    <a class="title" href="4975.html#5472">Re5:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5473</span>
    <a class="title" href="4975.html#5473">Re6:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5475</span>
    <a class="title" href="4975.html#5475">Re7:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5476</span>
    <a class="title" href="4975.html#5476">Re8:削除</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5168</span>
    <a class="title" href="4975.html#5168">Re2:削除</a></div>
    <ul><li><div class="list-title">
    <span class="no">5169</span>
    <a class="title" href="4975.html#5169">Re3:削除</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5522</span>
    <a class="title" href="4975.html#5522">Re: 削除</a></div>
    </li></ul></li></ul><ul class="main"><li><section><h1 id=4975>
    <span class="no">[4975]</span>
    <a class="title" href="#4975">削除</a>
    <span class="author">管理人</span>
    <time datetime="2006-01-15T11:44:36">2006年01月15日 11:44</time></h1>
    <div class="body">近々URL変えますね<br>もう</div></section>
    <ul><li><section><h1 id=4977>
    <span class="no">[4977]</span>
    <a class="title" href="#4977">Re:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-01-15T14:47:30">2006年01月15日 14:47</time></h1>
    <div class="body">&gt;近々URL変えますね<br><br>　変える前に、一度お試しを。<br><br>　最近cyclamen.cgiへのスパムが多いですけど、えぐぞせさんの提案 http://akebi.jp/support/cyclamen.cgi?tree=c2890 を元に'form'を'sform'に改造して様子を見てみたら、１０日ほどで４回スパムを防御できました。（その何倍か、検索エンジンのロボットがひっかかりましたが、投稿フォームを取り込めなくても問題ないでしょう）<br>　これでしばらくは防げるかもしれません。<br><br>　修正箇所は２箇所。念のため、ログをファイルacclog.cgiに出力しています。<br><br><br>【cyclamen.cgi】<br><br>elsif ($CMD{'mode'} eq 'form') { &amp;lbc; &amp;submit_form; exit;}<br>---↓-------------<br>elsif ($CMD{'mode'} eq 'form'){open(ACC,"&gt;&gt; acclog.cgi");print ACC "\n$date_num $CMD{'log'} 【spam】\t$ENV{'REMOTE_ADDR'}\n\t$ENV{'HTTP_USE<br>R_AGENT'}";close(ACC);chmod($f_pmt,"acclog.cgi");&amp;error('禁止語句が含まれています.');}<br>elsif ($CMD{'mode'} eq 'sform') { &amp;lbc; &amp;submit_form; exit;}<br><br>&#9;if (!$CMD{'ol'} &amp;&amp; (!$readonly || $admin)) { printf "[&lt;a href=\"$script_name?%s\" target=\"_self\"&gt;%s&lt;/a&gt;]\n",&amp;opt("mode=form",$CMD{'log'}),$ls00;}<br>---↓-------------<br>&#9;if (!$CMD{'ol'} &amp;&amp; (!$readonly || $admin)) { printf "[&lt;a href=\"$script_name?%s\" target=\"_self\"&gt;%s&lt;/a&gt;]\n",&amp;opt("mode=sform",$CMD{'log'}),$ls00;}<br></div></section>
    <ul><li><section><h1 id=4986>
    <span class="no">[4986]</span>
    <a class="title" href="#4986">Re2:削除</a>
    <span class="author">管理人</span>
    <time datetime="2006-01-17T01:49:58">2006年01月17日 01:49</time></h1>
    <div class="body">▼ しみづさん<br>> >近々URL変えますね<br>> 　変える前に、一度お試しを。<br>> <br>> 　最近cyclamen.cgiへのスパムが多いですけど、えぐぞせさんの提案 http://akebi.jp/support/cyclamen.cgi?tree=c2890 を元に'form'を'sform'に改造して様子を見てみたら、１０日ほどで４回スパムを防御できました。（その何倍か、検索エンジンのロボットがひっかかりましたが、投稿フォームを取り込めなくても問題ないでしょう）<br>> 　これでしばらくは防げるかもしれません。<br>基本的には一般掲示板に投稿されるので，<br>log=dataを省略不可にする予定ですが効果ないかな？<br>省略されたらホームページにRedirectする感じで．</div></section>
    <ul><li><section><h1 id=4987>
    <span class="no">[4987]</span>
    <a class="title" href="#4987">Re3:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-01-17T02:46:27">2006年01月17日 02:46</time></h1>
    <div class="body">&gt;log=dataを省略不可にする予定ですが効果ないかな？<br><br>　なるほど。私の方ではlog=XXXXXの掲示板も一時期スパムを書かれていたので、無敵の方法ではないかもしれませんが、相手がアドレスを収集し直すまでは有効かもしれません。<br></div></section>
    </li></ul></li><li><section><h1 id=5162>
    <span class="no">[5162]</span>
    <a class="title" href="#5162">Re2:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-04-10T17:40:08">2006年04月10日 17:40</time></h1>
    <div class="body"><br>　前回のは、mode=formで直接書いてくる場合の対策ですが、ちなみに別のタイプ、mode=writeで直接書いてくる場合の対策は、以下のようなものになります。<br><br>【cyclamen.cgi】<br><br>317c317,320<br>&lt; elsif ($FORM{'mode'} eq 'write') { &amp;lbc; &amp;regist;}<br>---<br>&gt; elsif ($FORM{'mode'} eq 'write'){if ( $ENV{'HTTP_USER_AGENT'} =~ /INCM/i ) { &amp;lbc; &amp;regist;}<br>&gt; else {open(ACC,"&gt;&gt; acclog.cgi");print ACC "\n$date_num $CMD{'log'} 【write】\t$ENV{'REMOTE_ADDR'}\n\t$ENV{'HTTP_USE<br>R_AGENT'}\n\t$FORM{'value'}";close(ACC);<br>chmod($f_pmt,"acclog.cgi");&amp;error('禁止語句が含まれています.');<br>&gt; }}<br>&gt; elsif ($FORM{'mode'} eq 'twrite') { &amp;lbc; &amp;regist;}<br><br>【cylib.cgi】<br><br>237c237<br>&lt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"write\"&gt;\n";<br>---<br>&gt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"twrite\"&gt;\n";<br>2585c2585<br>&lt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"write\"&gt;";<br>---<br>&gt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"twrite\"&gt;";<br>3018c3018<br>&lt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"write\"&gt;\n";<br>---<br>&gt; &#9;print "&lt;input type=hidden name=\"mode\" value=\"twrite\"&gt;\n";<br></div></section>
    <ul><li><section><h1 id=5163>
    <span class="no">[5163]</span>
    <a class="title" href="#5163">Re3:削除</a>
    <span class="author">maru</span>
    <time datetime="2006-04-11T00:39:39">2006年04月11日 00:39</time></h1>
    <div class="body">思いつきですが・・・。<br>'form'をランダムな文字列にしておいて<br>crondで定期的(深夜？)に書き換えるとか。<br><br>何らかのプレフィックス＋ランダム文字列という風に<br>ルール化しておけば一括置換できそう。<br>運悪く切り替えのタイミングに書き込んだ人は<br>ごめんなさいということで。</div></section>
    <ul><li><section><h1 id=5164>
    <span class="no">[5164]</span>
    <a class="title" href="#5164">Re4:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-04-11T02:57:34">2006年04月11日 02:57</time></h1>
    <div class="body">&gt;'form'をランダムな文字列にしておいて<br>&gt;crondで定期的(深夜？)に書き換えるとか。<br><br>　そうですね。でもあれから数ヶ月経ちますが、相手は全然気づいてないようで、全部ブロックできてます。結果も確認していないようですね。<br></div></section>
    </li></ul></li><li><section><h1 id=5455>
    <span class="no">[5455]</span>
    <a class="title" href="#5455">Re3:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-09-27T06:26:20">2006年09月27日 06:26</time></h1>
    <div class="body"><br>　この対策を試していただけるのはうれしいのですが、INCMもwriteを使っているので、このとおりの修正でないとINCMからの送信ができなくなります。<br>　ちなみに最近私のところでは、このタイプのスパムがほとんどです。<br></div></section>
    <ul><li><section><h1 id=5470>
    <span class="no">[5470]</span>
    <a class="title" href="#5470">Re4:削除</a>
    <span class="author">げんた</span>
    <time datetime="2006-09-29T00:12:11">2006年09月29日 00:12</time></h1>
    <div class="body">▼ しみづさん<br>&gt;INCMからの送信ができなくなります。<br>あー，やはり自分で変えたせいでしたか．<br><br>INCMで送信できないのでおかしいなぁと思っていました．<br><br>近々直そうと思います．</div></section>
    <ul><li><section><h1 id=5472>
    <span class="no">[5472]</span>
    <a class="title" href="#5472">Re5:削除</a>
    <span class="author">maru</span>
    <time datetime="2006-09-29T02:26:24">2006年09月29日 02:26</time></h1>
    <div class="body">▼ げんたさん<br>&gt; ▼ しみづさん<br>&gt; &gt;INCMからの送信ができなくなります。<br>&gt; INCMで送信できないのでおかしいなぁと思っていました．<br>う！もしかしてまずいことしちゃいましたか？<br>INCM使ってないので気が付きませんでした。<br>twriteなら大丈夫ということですか？</div></section>
    <ul><li><section><h1 id=5473>
    <span class="no">[5473]</span>
    <a class="title" href="#5473">Re6:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-09-29T02:30:44">2006年09月29日 02:30</time></h1>
    <div class="body"><br>&gt; twriteなら大丈夫ということですか？<br><br>　その部分ではないです。そこは自由です。<br></div></section>
    <ul><li><section><h1 id=5475>
    <span class="no">[5475]</span>
    <a class="title" href="#5475">Re7:削除</a>
    <span class="author">maru</span>
    <time datetime="2006-09-30T14:08:05">2006年09月30日 14:08</time></h1>
    <div class="body">INCMのwriteの処理を追加しました。<br>勝手に変更してすいませんでした。<br></div></section>
    <ul><li><section><h1 id=5476>
    <span class="no">[5476]</span>
    <a class="title" href="#5476">Re8:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-09-30T14:37:58">2006年09月30日 14:37</time></h1>
    <div class="body"><br>　これが書き込めればＯＫということです。<br>　うん、ＯＫですね。<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=5168>
    <span class="no">[5168]</span>
    <a class="title" href="#5168">Re2:削除</a>
    <span class="author">管理人</span>
    <time datetime="2006-04-15T11:47:32">2006年04月15日 11:47</time></h1>
    <div class="body">▼ しみづさん<br>のform変更対策してみました．</div></section>
    <ul><li><section><h1 id=5169>
    <span class="no">[5169]</span>
    <a class="title" href="#5169">Re3:削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-04-15T12:00:34">2006年04月15日 12:00</time></h1>
    <div class="body"><br>&gt;form変更対策してみました．<br><br>　しばらくはMSNやGoogleやYahooが盛んにひっかかりますが、だんだん学習するのか、今もひっかかっているのはYahooくらいです。<br></div></section>
    </li></ul></li></ul></li><li><section><h1 id=5522>
    <span class="no">[5522]</span>
    <a class="title" href="#5522">Re: 削除</a>
    <span class="author">しみづ</span>
    <time datetime="2006-10-26T09:16:43">2006年10月26日 09:16</time></h1>
    <div class="body"><br>　もう一つのタイプがあると思っています。上のような、レスにつくタイプです。<br>　これは「返信」をクリックするのと同じことをプログラミングしていると思われ、私のところには数回しかきていないので十分検証はしていないのですが。<br><br>　修正は以下の掲示板に書きましたが、多いので、ここではその元として組んだPerlによる修正スクリプトを書いておきます。<br><a href=http://www.dtmtown.com/cyclamen/cyclamen.cgi?tree=s529#535 target=_top><nobr>http://<wbr>www.<wbr>dtmtown.<wbr>com/<wbr>cyclamen<wbr>/<wbr>cyclamen<wbr>.<wbr>cgi?<wbr>tree=<wbr>s529#<wbr>535</nobr></a><br><br>　使い方は、実行するフォルダの親フォルダに元となるcgi(cyclamen.cgi,cylib.cgi)を置いておき、スクリプトを実行すると修正されたcgiがそこにできます。<br><br><br>open (OUT,"&gt;cyclamen.cgi");<br>open (IN,"../cyclamen.cgi");<br>binmode (IN);<br>$/ = '\n';<br><br>while (&lt;IN&gt;) {<br><br># スパム<br> s/\$CMD\{'res'\}/\$CMD{'tes'}/g;<br> s/"res=/"tes=/g;<br> s/elsif \(\(\$CMD\{'tes'\}/elsif (\$CMD{'res'}){open(ACC,"&gt;&gt; acclog.cgi");print ACC "\\n\$date_num \$CMD{'log'} 【res\$CMD{'res'}】\\t\$ENV{'REMOTE_ADDR'}\\n\\t\$ENV{'HTT<br>P_USER_AGENT'}";close(ACC);chmod(\$f_pmt,"acclog.cgi");&amp;error('禁止語句が含まれています.');\n}\nelsif ((\$CMD{'tes'}/;<br><br><br>s/\x0d//g;<br><br>&#9;printf OUT "%s", $_;<br>}<br>close(IN);<br>close(OUT);<br><br><br>open (OUT,"&gt;cylib.cgi");<br>open (IN,"../cylib.cgi");<br>binmode (IN);<br>$/ = '\n';<br><br>while (&lt;IN&gt;) {<br><br># スパム<br> s/\$CMD\{'res'\}/\$CMD{'tes'}/g;<br><br><br>s/\x0d//g;<br><br>&#9;printf OUT "%s", $_;<br>}<br>close(IN);<br>close(OUT);<br></div></section>
    </li></ul></li></ul></body></html>