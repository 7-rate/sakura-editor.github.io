<!DOCTYPE html><html><head><meta charset='utf-8'><title>改行記号の表示が欠ける</title><link rel='stylesheet' href='../bbs.css' /><script src='../bbs.js'></script><body><ul class="side"><a href="./" class="toindex">←一般トップへ</a><li><div class="list-title">
    <span class="no">2896</span>
    <a class="title" href="2896.html#2896">改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">2909</span>
    <a class="title" href="2896.html#2909">RE: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3087</span>
    <a class="title" href="2896.html#3087">Re2: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3168</span>
    <a class="title" href="2896.html#3168">Re3: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3169</span>
    <a class="title" href="2896.html#3169">Re4: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3175</span>
    <a class="title" href="2896.html#3175">Re5: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3188</span>
    <a class="title" href="2896.html#3188">Re6: 改行記号の表示が欠ける</a></div>
    <ul><li><div class="list-title">
    <span class="no">3197</span>
    <a class="title" href="2896.html#3197">Re7: 改行記号の表示が欠ける</a></div>
    </li></ul></li><li><div class="list-title">
    <span class="no">3191</span>
    <a class="title" href="2896.html#3191">Re6: 改行記号の表示が欠ける</a></div>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li><li><div class="list-title">
    <span class="no">3200</span>
    <a class="title" href="2896.html#3200">スレンダーなウィンドウ</a></div>
    <ul><li><div class="list-title">
    <span class="no">3202</span>
    <a class="title" href="2896.html#3202">Re:スレンダーなウィンドウ</a></div>
    <ul><li><div class="list-title">
    <span class="no">3203</span>
    <a class="title" href="2896.html#3203">Re2:スレンダーなウィンドウ</a></div>
    </li></ul></li></ul></li></ul></li></ul><ul class="main"><li><section><h1 id=2896>
    <span class="no">[2896]</span>
    <a class="title" href="#2896">改行記号の表示が欠ける</a>
    <span class="author">ryoji</span>
    <time datetime="2003-05-08T01:39:16">2003年05月08日 01:39</time></h1>
    <div class="body">sakura 1.3.90<br>左方向スクロール時に左側から現れる改行記号の表示が一部欠けてしまうようです。<br><br>再現方法：<br>・折り返し桁数を少なめに設定する(例：120桁)<br>・ウィンドウの幅を折り返し桁数よりも少し小さめにする(例：100桁くらいが表示されるように)<br>・先頭桁のほうに改行を入れておく<br>・右スクロールして改行表示が隠れるようにする<br>・左にゆっくりスクロールして改行表示が見えるようにする<br><br>改行マークの中央付近（少し右寄り）の部分の表示が欠ける。<br>CRLF は CR のような表示になってしまいます。<br>LF は矢印の先端が欠けます。<br><br>F5 キーで再描画させると正常な表示に戻ります。</div></section>
    <ul><li><section><h1 id=2909>
    <span class="no">[2909]</span>
    <a class="title" href="#2909">RE: 改行記号の表示が欠ける</a>
    <span class="author">みく</span>
    <time datetime="2003-05-13T19:06:04">2003年05月13日 19:06</time></h1>
    <div class="body"><br>原因は改行を1文字分で描画制御しているのに、<br>実際の表示イメージは2文字幅(1.5?)あるので、<br>後半が欠けます。<br><br>修正しようとはしたんですが、単純に2文字幅で制御したら行番号区切りに重なったもので。。。<br></div></section>
    <ul><li><section><h1 id=3087>
    <span class="no">[3087]</span>
    <a class="title" href="#3087">Re2: 改行記号の表示が欠ける</a>
    <span class="author">ryoji</span>
    <time datetime="2003-07-20T21:50:37">2003年07月20日 21:50</time></h1>
    <div class="body">▼ みくさん<br>&gt; <br>&gt; 原因は改行を1文字分で描画制御しているのに、<br>&gt; 実際の表示イメージは2文字幅(1.5?)あるので、<br>&gt; 後半が欠けます。<br>&gt; <br>&gt; 修正しようとはしたんですが、単純に2文字幅で制御したら行番号区切りに重なったもので。。。<br><br>sakura 1.4.0.0<br>遅レスになりますが．．．<br><br>CEditView_New.cpp(583)を、<br>（変更前）rcClip2.right = rcClip2.left + ( nCharWidth ) * ( 1 );<br>（変更後）rcClip2.right = rcClip2.left + ( nCharWidth ) * ( 2 );<br>とするだけではだめなんでしょうか？</div></section>
    <ul><li><section><h1 id=3168>
    <span class="no">[3168]</span>
    <a class="title" href="#3168">Re3: 改行記号の表示が欠ける</a>
    <span class="author">みく</span>
    <time datetime="2003-08-12T18:16:38">2003年08月12日 18:16</time></h1>
    <div class="body"><br>あのー、直ってないんですが。<br></div></section>
    <ul><li><section><h1 id=3169>
    <span class="no">[3169]</span>
    <a class="title" href="#3169">Re4: 改行記号の表示が欠ける</a>
    <span class="author">げんた</span>
    <time datetime="2003-08-13T10:44:02">2003年08月13日 10:44</time></h1>
    <div class="body">&gt;あのー、直ってないんですが。<br>あれっ？一応確認したらちゃんとCRLFの右のかぎ部分が表示されたからOKかと思ったのだが．<br></div></section>
    <ul><li><section><h1 id=3175>
    <span class="no">[3175]</span>
    <a class="title" href="#3175">Re5: 改行記号の表示が欠ける</a>
    <span class="author">じゅうじ</span>
    <time datetime="2003-08-14T14:57:44">2003年08月14日 14:57</time></h1>
    <div class="body">▼ げんたさん<br>&gt; あれっ？一応確認したらちゃんとCRLFの右のかぎ部分が表示されたからOKかと思ったのだが．<br>だめだったということですね？ちゃんと元に戻してください。（笑）<br><br>&gt; &gt;あのー、直ってないんですが。<br>それなら、<br>CEditView_New.cpp(582)を、<br>（変更前）rcClip2.left = x + nX * ( nCharWidth );<br>（変更後）rcClip2.left = x + nX * ( nCharWidth ) + 1;<br>で、早くても遅くても、又長い行も短い行も良いようです。</div></section>
    <ul><li><section><h1 id=3188>
    <span class="no">[3188]</span>
    <a class="title" href="#3188">Re6: 改行記号の表示が欠ける</a>
    <span class="author">もか</span>
    <time datetime="2003-08-16T22:23:32">2003年08月16日 22:23</time></h1>
    <div class="body">ssrc_2003-08-11.tar.bz2で欠けなくなったのですが、<br>再作画したり、上下スクロールで新たに行が作画されたりしたときに、<br>矢印が、行番号の上に作画されるようになったみたい。<br>左右スクロールしたときは、ある程度は問題なく表示されるようです。<br>　原因はクリップしてないからですが、どう対処しよう。<br></div></section>
    <ul><li><section><h1 id=3197>
    <span class="no">[3197]</span>
    <a class="title" href="#3197">Re7: 改行記号の表示が欠ける</a>
    <span class="author">ryoji</span>
    <time datetime="2003-08-17T18:30:58">2003年08月17日 18:30</time></h1>
    <div class="body">▼ もかさん<br>&gt; 　原因はクリップしてないからですが、どう対処しよう。<br><br>こんな感じでしょうか？<br><br>ssrc_2003-08-11.tar.bz2との差分<br>--- sakura_core_org/CEditView_New.cpp&#9;Tue Aug 12 00:09:18 2003<br>+++ sakura_core_fix/CEditView_New.cpp&#9;Sun Aug 17 17:50:32 2003<br>@@ -591,15 +591,20 @@<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;rcClip2.bottom = y + nLineHeight;<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;colBkColorOld = ::SetBkColor( hdc, TypeDataPtr-&gt;m_ColorInfoArr[nColorIdx].m<br>_colBACK );&#9;/* CRLF背景の色 */<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;::ExtTextOut( hdc, x + nX * ( nCharWidth ), y, fuOptions,<br>-&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;&amp;rcClip2, (const char *)" ", 1, m_pnDx );<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;&amp;rcClip2, (const char *)"  ", 2, m_pnDx );<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;::SetBkColor( hdc, colBkColorOld );<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;/* 改行記号の表示 */<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;if( TypeDataPtr-&gt;m_ColorInfoArr[COLORIDX_CRL<br>F].m_bDisp ){<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;nPosX = x + nX * ( nCharWidth );<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;nPosY = y;<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;//@@@ 2001.12.21 YAZAKI<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;HRGN hRgn;<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;hRgn = ::CreateRectRgnIndirect(&amp;rcClip2);<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;::SelectClipRgn(hdc, hRgn);<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;DrawEOL(hdc, nPosX + 1, nPosY, m_nCharWidth, m_nCharHeight,<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;pcLayout2-&gt;m_cEol, TypeDataPtr-&gt;m_ColorInfoArr[nColorIdx].m<br>_bFatFont, TypeDataPtr-&gt;m_ColorInfoArr[nColorIdx].m<br>_colTEXT );<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;::SelectClipRgn(hdc, NULL);<br>+&#9;&#9;&#9;&#9;&#9;&#9;&#9;&#9;::DeleteObject(hRgn);<br> &#9;&#9;&#9;&#9;&#9;&#9;&#9;}<br> &#9;&#9;&#9;&#9;&#9;&#9;}<br> &#9;&#9;&#9;&#9;&#9;&#9;::SelectObject( hdc, hFontOld );<br></div></section>
    </li></ul></li><li><section><h1 id=3191>
    <span class="no">[3191]</span>
    <a class="title" href="#3191">Re6: 改行記号の表示が欠ける</a>
    <span class="author">じゅうじ</span>
    <time datetime="2003-08-17T02:43:51">2003年08月17日 02:43</time></h1>
    <div class="body">▼ もかさん<br>すみません、確認していませんでした。<br>□□□□□□□□□□□■□□□□<br>□□■■■■□□□□□■□□□□<br>□□■□□□□□□□□■□□■□<br>□□■□□□□□□□■■□□■□<br>□□■■■□□□□■□■□□■□<br>□□■□□■□□■■■■■■■□<br>□□□□□■□□□■□■□□□□<br>□□■□□■□□□□■■□□□□<br>□□■□□■□□□□□■□□□□<br>□□□■■□□□□□□■□□□□<br>□□□□□□□□□□□■□□□□<br>良いですか？<br></div></section>
    </li></ul></li></ul></li></ul></li></ul></li></ul></li><li><section><h1 id=3200>
    <span class="no">[3200]</span>
    <a class="title" href="#3200">スレンダーなウィンドウ</a>
    <span class="author">じゅうじ</span>
    <time datetime="2003-08-17T20:09:10">2003年08月17日 20:09</time></h1>
    <div class="body">▼ ryojiさん<br>お疲れ様です。＼(．．)／<br><br>タイプ別設定-&gt;スクリーン-&gt;レイアウト-&gt;折り返し桁数<br>を約２０以下にして、ウィンドウの幅を１０くらいに狭くした場合、<br>sakura.iniファイルの[MRU]セクションで、<br>nViewLeftColに負の値がセットされます。<br><br>エラーの起こる折り返し桁数は、目的のファイルの大きさによって異なります。<br>最大308桁で154行、５KBのファイルで２４以下です。<br><br>sakura_2003-08-10<br>Ver. 1.4.2.0<br></div></section>
    <ul><li><section><h1 id=3202>
    <span class="no">[3202]</span>
    <a class="title" href="#3202">Re:スレンダーなウィンドウ</a>
    <span class="author">ryoji</span>
    <time datetime="2003-08-18T21:10:53">2003年08月18日 21:10</time></h1>
    <div class="body">▼ じゅうじさん<br>&gt; タイプ別設定-&gt;スクリーン-&gt;レイアウト-&gt;折り返し桁数<br>&gt; を約２０以下にして、ウィンドウの幅を１０くらいに狭くした場合、<br>&gt; sakura.iniファイルの[MRU]セクションで、<br>&gt; nViewLeftColに負の値がセットされます。<br><br>改行表示とは別の問題ですね。(^^;<br><br>確かにその設定で水平スクロールバー操作をすると負の桁位置が<br>表示されるような？状態になりますねぇ。<br>そうでなくても、注意して見ると最右端付近にスクロールしたときに<br>微妙に制御が変なのがわかります。<br><br>で、CEditView::ScrollAtH()にタイプミスっぽいのを見つけました。<br><br>--- ssrc_2003-08-11\sakura_core_org/CEditView.cpp&#9;Sat Jul 05 02:28:21 2003<br>+++ ssrc_2003-08-11\sakura_core_fix/CEditView.cpp&#9;Mon Aug 18 20:27:27 2003<br>@@ -4621,8 +4621,8 @@<br> &#9;if( nPos &lt; 0 ){<br> &#9;&#9;nPos = 0;<br> &#9;}else<br>-&#9;if( m_pcEditDoc-&gt;GetDocumentAttribute().m_nM<br>axLineSize - m_nViewRowNum &lt; nPos ){<br>-&#9;&#9;nPos = m_pcEditDoc-&gt;GetDocumentAttribute().m_nM<br>axLineSize - m_nViewRowNum;<br>+&#9;if( m_pcEditDoc-&gt;GetDocumentAttribute().m_nM<br>axLineSize - m_nViewColNum &lt; nPos ){<br>+&#9;&#9;nPos = m_pcEditDoc-&gt;GetDocumentAttribute().m_nM<br>axLineSize - m_nViewColNum;<br> &#9;}<br> &#9;if( m_nViewLeftCol == nPos ){<br> &#9;&#9;return;<br><br>これでいいのかな？</div></section>
    <ul><li><section><h1 id=3203>
    <span class="no">[3203]</span>
    <a class="title" href="#3203">Re2:スレンダーなウィンドウ</a>
    <span class="author">じゅうじ</span>
    <time datetime="2003-08-19T01:13:20">2003年08月19日 01:13</time></h1>
    <div class="body">▼ ryojiさん<br>有難うございます。<br>問題なく動いています。<br>では、(..)|~</div></section>
    </li></ul></li></ul></li></ul></li></ul></body></html>