<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Style-Type" content="text/css">
  <script src='../bbs.js'></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120820034-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-120820034-1');
  </script>

  <link href="../bbs.css" type="text/css" rel="stylesheet">
  <link rel="shortcut icon" href="favicon.ico">
  <title>テキストファイルの編集について | サクラエディタ過去ログ</title>
</head>
<body>
<ul class="side">
        <a href="./" class="toindex">◀一般トップへ</a>
        <li><div class="list-title">
    <span class="no">5283</span>
    <a class="thread-title" href="5283.html#5283">テキストファイルの編集について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5287</span>
    <a class="thread-title" href="5283.html#5287">Re: テキストファイルの編集について</a></div>
    </li><li><div class="list-title">
    <span class="no">5288</span>
    <a class="thread-title" href="5283.html#5288">RE: テキストファイルの編集について</a></div>
    </li><li><div class="list-title">
    <span class="no">5291</span>
    <a class="thread-title" href="5283.html#5291">Re:テキストファイルの編集について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5295</span>
    <a class="thread-title" href="5283.html#5295">Re2:テキストファイルの編集について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5308</span>
    <a class="thread-title" href="5283.html#5308">マクロ改修</a></div>
    <ul><li><div class="list-title">
    <span class="no">5313</span>
    <a class="thread-title" href="5283.html#5313">Re:マクロ改修</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5296</span>
    <a class="thread-title" href="5283.html#5296">Re2:テキストファイルの編集について</a></div>
    <ul><li><div class="list-title">
    <span class="no">5298</span>
    <a class="thread-title" href="5283.html#5298">Re3:テキストファイルの編集について</a></div>
    </li></ul></li></ul></li><li><div class="list-title">
    <span class="no">5439</span>
    <a class="thread-title" href="5283.html#5439">Re:テキストファイルの編集について</a></div>
    </li></ul></li>
    </ul><ul class="main"><li><section><h1 id=5283>
    <span class="no">[5283]</span>
    <a class="thread-title" href="#5283">テキストファイルの編集について</a>
    <span class="author">YU1</span>
    <time datetime="2006-06-23T13:30:34">2006年06月23日 13:30</time></h1>
    <div class="body">YU1と申します。<br><br>テキストの編集について、教えて頂けませんでしょうか？<br><br>例えばあるテキストの行番号55000から72000を削除したい場合、<br>MIFESですと”行単位選択開始”を選択し、”指定位置へジャンプ”<br>にて範囲を選択し削除していました。<br><br>サクラエディタで同様のことを行なうと、”指定行へジャンプ”を<br>実行した段階で”選択が解除”されてしまい編集が出来ません。<br>またこれと同様に、ある行範囲内で文字の入れ替えを行う編集機能も<br>も使うことが出来ず困っています。<br><br>ご助力頂けませんでしょうか？<br>宜しくお願い致します。</div></section>
    <ul><li><section><h1 id=5287>
    <span class="no">[5287]</span>
    <a class="thread-title" href="#5287">Re: テキストファイルの編集について</a>
    <span class="author">しみづ</span>
    <time datetime="2006-06-24T13:55:22">2006年06月24日 13:55</time></h1>
    <div class="body"><br>&gt;実行した段階で”選択が解除”されてしまい編集が出来ません。<br><br>　私も似たような、履歴を移動しての選択ができなかった覚えがあります。<br>　行番号がわかっているのでしたら、開始点に左クリックでカーソルを置いて、スクロールバーで終了点まで動かして、終了点にShift+左クリックで終点指定すればできると思います。<br></div></section>
    </li><li><section><h1 id=5288>
    <span class="no">[5288]</span>
    <a class="thread-title" href="#5288">RE: テキストファイルの編集について</a>
    <span class="author">すい</span>
    <time datetime="2006-06-24T22:01:46">2006年06月24日 22:01</time></h1>
    <div class="body">&gt;サクラエディタで同様のことを行なうと、”指定行へジャンプ”を<br>&gt;実行した段階で”選択が解除”されてしまい編集が出来ません。<br><br>なんかすごく気持ち分かったりします。<br>このエディタは意外と そういうエディタとして基本的な編集作業が出来ません。(^^;)<br>範囲選択時は一生懸命、手作業でその選択終了行まで手作業で<br>移動しなくてはならず大変です。<br><br>他にも「現在のカーソル位置から、とある文字列がある場所までを矩形範囲選択」<br>が出来ないんですよね。<br><br>普通の範囲選択なら<br><br>1.[F6] (範囲選択開始)<br>2.[Ctrl]+[F] で検索を実行。以降 [F3] (次を検索) で次の文字位置まで<br><br>で、特定の文字列の場所までを簡単に範囲選択できますが、なぜか<br>矩形範囲選択だと、同様の事が出来ない。<br>検索すると矩形範囲選択だけはなぜか選択解除されてしまってかなり不便。<br><br><br>ブックマークを使っても良いなら、選択終了行にあらかじめブックマークを<br>設定しておいて<br><br>1.[F6] (範囲選択開始) または [Shift]+[F6] (矩形範囲選択開始)<br>2.[F2] (次のブックマークへ)<br><br>で何とかなりますが、、、<br>いちいち先に選択終了行にブックマークを設定してから～～<br>なんて面倒ですしねぇ。<br>そもそもブックマークを大量に設定して編集しているファイルでは使えない手ですし。<br><br><br>&gt;またこれと同様に、ある行範囲内で文字の入れ替えを行う編集機能も<br>&gt;も使うことが出来ず困っています。<br><br>こちら、何を言いたい（どういう作業をやりたい）のかサッパリ分からないんですが、、、<br>誰もアドバイスも何も出来ないんじゃ．．．？<br></div></section>
    </li><li><section><h1 id=5291>
    <span class="no">[5291]</span>
    <a class="thread-title" href="#5291">Re:テキストファイルの編集について</a>
    <span class="author">YU1</span>
    <time datetime="2006-06-26T08:54:51">2006年06月26日 08:54</time></h1>
    <div class="body">しみず様、すい様、丁寧な御回答ありがとうございました。<br><br>背景から申しますと、当方工作機械を動かすＮＣプログラム<br>製作を生業しています。今まではＭＩＦＥＳを使用していた<br>のですが、とある理由からフリーで使えるテキストエディタ<br>を探してました。<br><br>そこで紹介されていました”サクラエディタ”をインスト<br>ールし、使用してみたのですが、前記の通り困った点があり<br>まして、こちらで質問させて頂きました。<br><br>任意の行範囲の指定方法は御二人の御回答で乗り越えられ<br>そうです。比較的短いテキストなら問題無いのですが、<br>１００万行を超えるような大きいテキストの編集は少し<br>（ブックマークを使用する分）不便かも知れませんネ。<br><br>&gt;またこれと同様に、ある行範囲内で文字の入れ替えを行う編集機能も<br>&gt;も使うことが出来ず困っています。<br><br>文字の入れ替えについてですが、例えば<br><br>テキストの<br>行番号50000から85000の間で<br><br>F2000をF1200に<br>F300をF100に<br>D05をD12に<br><br>変換する時にはどうしたら良いのか判らなかった為、<br>追加質問させて頂きました。<br>（任意の範囲の選択が出来なかった為）<br><br>判り難い質問文で大変申し訳無かったです。<br>どうか宜しくお願い致します。<br></div></section>
    <ul><li><section><h1 id=5295>
    <span class="no">[5295]</span>
    <a class="thread-title" href="#5295">Re2:テキストファイルの編集について</a>
    <span class="author">すい</span>
    <time datetime="2006-06-26T23:45:04">2006年06月26日 23:45</time></h1>
    <div class="body">マクロでやってみました。指定行までを選択。<br>マクロを実行すると何行までを選択するか聞いてきます。<br><br>ただ、ブックマークを使用しているので、このマクロを使用すると<br>編集中ファイルの他のブックマークが全て解除されてしまいます。<br><br>マクロファイル名「SELLINE.PPA」<br>-----↓ここから↓-----<br>// 実行には PPA.DLL が必須です。<br>// マクロファイルの拡張子は .PPA でなくてはなりません。<br><br>// 現在のカーソル位置から指定行までを選択する。<br>// このマクロを使用すると、編集中ファイルの全ブックマークが解除されるので注意！！<br><br>var<br>&#9;cx,cy:Integer;<br>&#9;ty:Integer;<br>begin<br>&#9;// 現在位置を cx,cy に記憶しておく。<br>&#9;cx := StrToInt( S_ExpandParameter( '$x' ) );&#9;// 実行開始時の列<br>&#9;cy := StrToInt( S_ExpandParameter( '$y' ) );&#9;// 実行開始時の行<br><br>&#9;// 行番号を入力させる<br>&#9;ty := StrToInt( InputBox( '行番号を入力' , '何行目までを選択しますか？' , '' ) );<br>&#9;if( ty = 0 ) then&#9;Exit;&#9;// 何も入力されなかったら、ここでマクロ中断。<br><br>&#9;S_BookmarkReset(0);&#9;// ブックマークの全解除<br>&#9;S_Jump(ty,0);&#9;&#9;// 目的行まで飛ぶ<br>&#9;S_BookmarkSet(0);&#9;// ブックマーク設定・解除<br><br>&#9;// カーソル位置を cx,cy へ戻す。<br>&#9;S_Jump(cy,0);<br>&#9;while ( StrToInt( S_ExpandParameter( '$x' ) ) &lt; cx ) do&#9;S_Right(0);&#9;// カーソル右移動<br><br>&#9;S_BeginSelect(0);&#9;// 範囲選択開始<br><br>&#9;if( cy &lt; ty ) then<br>&#9;&#9;begin&#9;// ↓方向に選択する場合<br>&#9;&#9;&#9;S_BookmarkNext(0);&#9;// 次のブックマークへ<br>&#9;&#9;&#9;S_BookmarkReset(0);&#9;// ブックマークの全解除<br>&#9;&#9;&#9;S_Left(0);&#9;&#9;&#9;// カーソル左移動<br>&#9;&#9;&#9;S_Right(0);&#9;&#9;&#9;// カーソル右移動<br>&#9;&#9;&#9;S_Down(0);&#9;&#9;&#9;// カーソル下移動<br>&#9;&#9;end<br>&#9;else<br>&#9;&#9;begin&#9;// ↑方向に選択する場合<br>&#9;&#9;&#9;S_BookmarkPrev(0);&#9;// 前のブックマークへ<br>&#9;&#9;&#9;S_BookmarkReset(0);&#9;// ブックマークの全解除<br>&#9;&#9;end<br>&#9;;<br>end;<br>-----↑ここまで↑-----<br></div></section>
    <ul><li><section><h1 id=5308>
    <span class="no">[5308]</span>
    <a class="thread-title" href="#5308">マクロ改修</a>
    <span class="author">すい</span>
    <time datetime="2006-06-29T00:40:31">2006年06月29日 00:40</time></h1>
    <div class="body">&gt;マクロでやってみました。指定行までを選択。<br>&gt;マクロを実行すると何行までを選択するか聞いてきます。<br><br>これ、移動履歴を使えばブックマーク使わなくても出来ました。(汗)<br><br># 移動履歴の事をド忘れしていました。 (;^^ゞ<br><br>「指定行へジャンプ」を実行すると、その指定行へジャンプする前の<br>カーソル位置が自動的に移動履歴に登録されますので、以後、<br><br>・[Alt]+[P]　編集(E) → 移動(O) → 移動履歴 前へ(P)<br>・[Alt]+[N]　編集(E) → 移動(O) → 移動履歴 次へ(N)<br><br>で「指定行へジャンプ」の 実行前の位置←→実行後の位置 を交互にカーソル移動出来ます。<br><br>で、移動履歴でのカーソル移動では選択状態は解除されませんので。。。<br><br>ただし、移動履歴で移動後、何らかのカーソル操作を行わないと選択範囲が反映されませんが。<br>「無駄に → 行って ← に戻る」とか。<br><br>このやり方でマクロをブックマークを全く使用しない、もちろん解除も何もされない<br>ように改修してみました。(全体的に簡潔スッキリになりました)<br><br>マクロファイル名「SELLINE.PPA」<br>-----↓ここから↓-----<br>// 実行には PPA.DLL が必須です。<br>// マクロファイルの拡張子は .PPA でなくてはなりません。<br><br>// 現在のカーソル位置から指定行までを選択する。<br><br>var<br>&#9;cy:Integer;&#9;// マクロ開始時の行（選択開始行）を記憶しておくための整数数値変数を用意する<br>&#9;ty:Integer;&#9;// 選択終了行を記憶しておくための整数数値変数を用意する<br>begin<br>&#9;cy := StrToInt( S_ExpandParameter( '$y' ) );&#9;// 現在行を cy に記憶しておく。<br><br>&#9;// 行番号を入力させる<br>&#9;ty := StrToInt( InputBox( '行番号を入力' , '何行目までを選択しますか？' , '' ) );<br>&#9;if( ty = 0 ) then&#9;Exit;&#9;// 何も入力されなかったら、ここでマクロ中断。<br><br>&#9;S_Jump(ty,0);&#9;&#9;// 目的行まで飛ぶ - ジャンプ前の位置が自動的に移動履歴に登録されている<br>&#9;S_MoveHistPrev(0);&#9;// 移動履歴: 前へ - カーソルを S_Jump 実行前位置へ戻す<br>&#9;S_BeginSelect(0);&#9;// 範囲選択開始<br>&#9;S_MoveHistNext(0);&#9;// 移動履歴: 次へ - カーソルを S_Jump 実行後位置へ移動<br><br>&#9;if( cy &lt; ty ) then<br>&#9;&#9;begin&#9;// ( 選択開始行cy &lt; 指定行ty ) つまり ↓方向に選択する場合<br>&#9;&#9;&#9;S_Down(0);&#9;// カーソル下移動<br>&#9;&#9;end<br>&#9;else<br>&#9;&#9;begin&#9;// ↑方向に選択する場合<br>&#9;&#9;&#9;S_Right(0);&#9;// カーソル右移動 - 移動履歴で移動後、カーソル移動しないと選択状態にならないらしい。<br>&#9;&#9;&#9;S_Left(0);&#9;// カーソル左移動   なので無駄に → 行って ← に戻る。<br>&#9;&#9;end<br>&#9;;<br>end;<br>-----↑ここまで↑-----<br></div></section>
    <ul><li><section><h1 id=5313>
    <span class="no">[5313]</span>
    <a class="thread-title" href="#5313">Re:マクロ改修</a>
    <span class="author">YU1</span>
    <time datetime="2006-06-29T08:27:37">2006年06月29日 08:27</time></h1>
    <div class="body">&gt; これ、移動履歴を使えばブックマーク使わなくても出来ました。(汗）<br><br>すい様、大変お手数をお掛けしています。<br>当方のように見ず知らずの者に、ここまで対応して頂き、とても感謝しております。<br>任意の行範囲指定だけでも、手段はいろいろあるのですね。<br>勉強になりました。<br><br>使いこなせるように、少しずつですが頑張って行きたいと思います。<br>どうもありがとうございました。<br></div></section>
    </li></ul></li></ul></li><li><section><h1 id=5296>
    <span class="no">[5296]</span>
    <a class="thread-title" href="#5296">Re2:テキストファイルの編集について</a>
    <span class="author">すい</span>
    <time datetime="2006-06-26T23:55:35">2006年06月26日 23:55</time></h1>
    <div class="body">&gt;テキストの<br>&gt;行番号50000から85000の間で<br>&gt;<br>&gt;F2000をF1200に<br>&gt;F300をF100に<br>&gt;D05をD12に<br>&gt;<br>&gt;変換する時にはどうしたら良いのか判らなかった為、<br><br>50000行から85000行を範囲選択しておいてから<br>[Ctrl]+[R] で置換ダイアログ出して<br><br>・左下の「置換ダイアログを自動的に閉じる(L)」チェックを off<br>・右下の範囲で「選択範囲(S)」を選択する<br><br>という状態にしておいて<br><br>・置換前(N)：F2000<br>・置換後(P)：F1200<br>と入力してから [すべて置換(A)] ボタン<br><br>・置換前(N)：F300<br>・置換後(P)：F100<br>と入力してから [すべて置換(A)] ボタン<br><br>　　・<br>　　・<br>＜＜以下略＞＞<br><br>とか？<br></div></section>
    <ul><li><section><h1 id=5298>
    <span class="no">[5298]</span>
    <a class="thread-title" href="#5298">Re3:テキストファイルの編集について</a>
    <span class="author">YU1</span>
    <time datetime="2006-06-27T16:48:28">2006年06月27日 16:48</time></h1>
    <div class="body">すい様、当方の為にマクロまで製作して頂き、<br>大変感謝しております。ありがとうございました。<br><br>PPA.DLLも手に入り、無事指定行範囲で変換する<br>ことが出来ました。<br><br>これからサクラエディタを有効に使わせて頂きたい<br>と思います。これからもどうか宜しくお願い致します。<br><br>M(_/_)M<br><br><br></div></section>
    </li></ul></li></ul></li><li><section><h1 id=5439>
    <span class="no">[5439]</span>
    <a class="thread-title" href="#5439">Re:テキストファイルの編集について</a>
    <span class="author">げんた</span>
    <time datetime="2006-09-23T12:46:52">2006年09月23日 12:46</time></h1>
    <div class="body">▼ YU1さん<br>&gt; MIFESですと”行単位選択開始”を選択し、”指定位置へジャンプ”<br>&gt; にて範囲を選択し削除していました。<br>&gt; サクラエディタで同様のことを行なうと、”指定行へジャンプ”を<br>&gt; 実行した段階で”選択が解除”されてしまい編集が出来ません。<br>次のバージョンでは，選択解除しないように動作変更します．<br></div></section>
    </li></ul></li></ul></body></html>